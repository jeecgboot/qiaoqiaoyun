var c=(i,d,o)=>new Promise((u,r)=>{var p=e=>{try{n(o.next(e))}catch(a){r(a)}},l=e=>{try{n(o.throw(e))}catch(a){r(a)}},n=e=>e.done?u(e.value):Promise.resolve(e.value).then(p,l);n((o=o.apply(i,d)).next())});import{d as y,f as m,a2 as I,V as g,a6 as L,af as S,ai as A,a5 as R,a8 as F,k as h}from"./vue-vendor-24c7dc61.js";import{B as $}from"./index-1c3affea.js";import"./index-621e597c.js";import{u as H}from"./useListPage-62a041ef.js";import{a7 as P,j as N,a as V,k as b,l as j}from"./index-831af9dd.js";import{u as O}from"./lowAppAuth-3d637b7d.js";import U from"./BasicTable-d435f501.js";import{T as z}from"./componentMap-c857637c.js";import"./BasicModal-58413bab.js";import"./antd-vue-vendor-0d72f01e.js";import"./useWindowSizeFn-8f085f6f.js";import"./useMethods-f689b480.js";import"./vxe-table-vendor-8813019a.js";import"./lowAppUtils-56892d30.js";import"./index-52c8c841.js";import"./useForm-14b2bc77.js";import"./helper-22dafba0.js";import"./JAreaLinkage-173780c9.js";import"./areaDataUtil-cdeee717.js";import"./china-area-data-vendor-556d14ee.js";import"./useFormItem-86503382.js";import"./JSelectUser-a44af43a.js";import"./useSelectBiz-2f560b0b.js";import"./props-8a7ac45b.js";import"./JSelectBiz-55a9591f.js";import"./JSelectDept-a90caee3.js";import"./index-f2fd5a28.js";import"./useContextMenu-810f9346.js";import"./JCodeEditor-66bd225e.js";import"./codemirror-17b6f671.js";import"./codemirror-26b29690.js";import"./active-line-512fef49.js";import"./JPopup-2a779923.js";import"./EasyCronInput-b2123242.js";import"./JCheckbox-0b89d32a.js";import"./JDictSelectTag-54dc3bdb.js";import"./JSelectUserByDept-bd619076.js";import"./UserSelectByDepModal-db060ece.js";import"./depart.api-339f4da6.js";import"./JEditor-249b2194.js";import"./index-b845562c.js";import"./JImageUpload-d644253a.js";import"./download-1ac6acce.js";import"./index-f99b266a.js";import"./JUpload-76e119c7.js";import"./index-d508f1f4.js";import"./index-6507b9cd.js";import"./index-4d0525a5.js";import"./UserSelectModal-d78c1490.js";const D=y({name:"AppBackupListModal",components:{BasicModal:$,BasicTable:U,TableAction:z},emits:["success","register"],setup(i,{emit:d}){const o=m(0);o.value=window.innerHeight-300;const u=I(),r=m(""),p=O(),l=P(),{createWarningModal:n}=V(),e=m(!1),a=[{title:"备份说明",align:"center",dataIndex:"backupNote",width:200},{title:"备份时间",align:"center",dataIndex:"backupTime",width:120,customRender:({text:t})=>t},{title:"备份人",align:"center",width:120,dataIndex:"backupBy"}],W=m(!1),w=H({designScope:"recycle-data-list-modal",tableProps:{immediate:!1,columns:a,api:t=>b.get({url:"/online/lowApp/backupList",params:t}),useSearchForm:!1,showActionColumn:!0,showIndexColumn:!0,indexColumnProps:{title:"#",fixed:"left",width:50},showTableSetting:!1,tableSetting:{setting:!1},beforeFetch(t){t.originAppId=r.value,t.column="backupTime",t.order="desc"}}}),{prefixCls:B,tableContext:T,createMessage:G}=w,[k,_]=T,[C,{closeModal:f}]=N(t=>c(this,null,function*(){let s=p.getLowAppAdminAuth();e.value=s,r.value=t.appId,yield _.reload()}));function M(t){return[{label:"还原",icon:"ant-design:redo-outlined",popConfirm:{title:"是否根据此版本还原应用",confirm:v.bind(null,t)}},{label:"删除",icon:"ant-design:delete-outlined",popConfirm:{title:"是否删除此备份",confirm:x.bind(null,t)}}]}function x(t){return c(this,null,function*(){const s="/online/lowApp/deleteBackup";yield b.delete({url:s,params:{id:t.id}},{joinParamsToUrl:!0}),yield _.reload(),f()})}function v(t){return c(this,null,function*(){const s="/online/lowApp/coverByBackup";yield b.put({url:s,params:{id:t.id}}),f(),setTimeout(()=>{location.reload()},1200)})}return{getTableAction:M,prefixCls:B,bodyHeight:o,registerModal:C,closeModal:f,registerTable:k,hasAdminAuth:e}}});function E(i,d,o,u,r,p){const l=g("TableAction"),n=g("BasicTable"),e=g("BasicModal");return L(),S(e,{title:"备份记录",minHeight:300,onRegister:i.registerModal,width:900,destroyOnClose:"",canFullscreen:"",footer:null},{default:A(()=>[R("div",{class:F([i.prefixCls,"p-2"])},[h(n,{onRegister:i.registerTable},{action:A(({record:a})=>[h(l,{actions:i.getTableAction(a)},null,8,["actions"])]),_:1},8,["onRegister"])],2)]),_:1},8,["onRegister"])}const Et=j(D,[["render",E],["__scopeId","data-v-f168ad55"]]);export{Et as default};
