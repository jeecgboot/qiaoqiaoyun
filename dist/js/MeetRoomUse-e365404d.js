var b=Object.defineProperty,z=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var D=(n,i,o)=>i in n?b(n,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[i]=o,S=(n,i)=>{for(var o in i||(i={}))L.call(i,o)&&D(n,o,i[o]);if(w)for(var o of w(i))U.call(i,o)&&D(n,o,i[o]);return n},T=(n,i)=>z(n,N(i));var g=(n,i,o)=>new Promise((_,e)=>{var x=s=>{try{m(o.next(s))}catch(c){e(c)}},d=s=>{try{m(o.throw(s))}catch(c){e(c)}},m=s=>s.done?_(s.value):Promise.resolve(s.value).then(x,d);m((o=o.apply(n,i)).next())});import{d as v,f as M,r as q,V as u,a6 as h,a7 as B,k as p,ai as y,af as V,W as $,a8 as E}from"./vue-vendor-24c7dc61.js";import{M as F}from"./ManageModal-2fdfa5b2.js";import{h as H,l as J}from"./manage.api-62536fbe.js";import{aF as O,a as P}from"./index-831af9dd.js";import"./index-1c3affea.js";import"./BasicModal-58413bab.js";import"./antd-vue-vendor-0d72f01e.js";import"./useWindowSizeFn-8f085f6f.js";import"./index-52c8c841.js";import"./useForm-14b2bc77.js";import"./componentMap-c857637c.js";import"./useFormItem-86503382.js";import"./download-1ac6acce.js";import"./index-f99b266a.js";import"./JSelectUser-a44af43a.js";import"./useSelectBiz-2f560b0b.js";import"./props-8a7ac45b.js";import"./JSelectBiz-55a9591f.js";import"./JImageUpload-d644253a.js";import"./JDictSelectTag-54dc3bdb.js";import"./JSelectDept-a90caee3.js";import"./index-f2fd5a28.js";import"./useContextMenu-810f9346.js";import"./areaDataUtil-cdeee717.js";import"./china-area-data-vendor-556d14ee.js";import"./JPopup-2a779923.js";import"./useMethods-f689b480.js";import"./JCheckbox-0b89d32a.js";import"./vxe-table-vendor-8813019a.js";import"./JSelectUserByDept-bd619076.js";import"./UserSelectByDepModal-db060ece.js";import"./depart.api-339f4da6.js";import"./JUpload-76e119c7.js";import"./index-d508f1f4.js";import"./index-6507b9cd.js";import"./index-4d0525a5.js";import"./UserSelectModal-d78c1490.js";import"./helper-22dafba0.js";import"./JAreaLinkage-173780c9.js";import"./JCodeEditor-66bd225e.js";import"./codemirror-17b6f671.js";import"./codemirror-26b29690.js";import"./active-line-512fef49.js";import"./EasyCronInput-b2123242.js";import"./JEditor-249b2194.js";import"./index-b845562c.js";import"./MeetRoomSelect-1395272c.js";import"./MeetRoomSelectModal-973583c2.js";import"./index-621e597c.js";import"./BasicTable-d435f501.js";import"./room.data-cba2a619.js";import"./useListPage-62a041ef.js";import"./fullcalendar-vendor-e153c929.js";import"./manage.data-9b48f59f.js";const Q={class:E(["p-4"])},W=v({name:"meet-room-use"}),Ge=v(T(S({},W),{setup(n){const i=P(),o=M(null),_=[{title:"会议名称",align:"center",dataIndex:"name"},{title:"召集人",align:"center",dataIndex:"originator_dictText"},{title:"位置",align:"center",dataIndex:"location_dictText"},{title:"开始时间",align:"center",dataIndex:"beginTime"},{title:"结束时间",align:"center",dataIndex:"endTime"},{title:"状态",align:"center",dataIndex:"status_dictText"}],e=q({loading:!1,dataSource:[],ipagination:{current:1,pageSize:10,pageSizeOptions:["10","20","30"],showTotal:(a,t)=>t[0]+"-"+t[1]+" 共"+a+"条",showQuickJumper:!0,showSizeChanger:!0,total:0},selectedRowKeys:[],selectionRows:[],selectedDepIds:[],departTree:[],expandedKeys:[],visible:!0,resourceIsNull:!0,selectedDepKey:"",tranLeft:0,tranTop:0});m();function x(a){a!=null&&a.length>0?e.resourceIsNull=!1:e.resourceIsNull=!0}function d(a){return g(this,null,function*(){let t={};t.pageNo=e.ipagination.current,t.pageSize=e.ipagination.pageSize,t.departId=a,e.loading=!0;let r=yield H(t);r.success&&(e.dataSource=r.result.records,e.ipagination.total=r.result.total),r.code===510&&i.warning(r.message),e.loading=!1})}function m(){return g(this,null,function*(){let a=yield O();if(a){e.departTree=a,e.expandedKeys=e.departTree.map(r=>r.id);let t="";e.expandedKeys!=null&&e.expandedKeys.length>0&&(t=e.expandedKeys[0]),o.value.loadRoom(t),e.selectedDepKey=t,e.selectedDepIds=[t],d(t)}})}function s(a){a[0]!=null&&(e.selectedDepKey==a[0]?(e.selectedDepKey="",e.selectedDepIds=[],o.value.loadRoom(null,"1"),e.dataSource=[],e.ipagination.total=0):(e.selectedDepKey=a[0],o.value.loadRoom(a[0]),d(a[0]),e.selectedDepIds[0]!==a[0]&&(e.selectedDepIds=[a[0]])))}function c(a,t){e.selectedRowKeys=a,e.selectionRows=t}function I(a){return g(this,null,function*(){let t=a.dataRef.key,r=yield J({pid:t});if(r.success){for(let l of r.result)l.value=l.key,l.isLeaf=!!l.leaf;K(t,r.result,e.treeData.value),e.treeData.value=[...e.treeData.value]}return Promise.resolve()})}function K(a,t,r){if(r&&r.length>0)for(let l of r)if(l.key==a){!t||t.length==0?l.isLeaf=!0:l.children=t;break}else K(a,t,l.children)}return(a,t)=>{const r=u("a-directory-tree"),l=u("a-col"),C=u("a-table"),k=u("a-row"),R=u("a-card");return h(),B("div",Q,[p(R,{bordered:!1},{default:y(()=>[p(k,{style:{width:"100%"},gutter:24},{default:y(()=>[p(l,{span:4,style:{"max-height":"500px",overflow:"auto"}},{default:y(()=>[p(r,{dropdownStyle:{maxHeight:"200px",overflow:"auto"},loadData:I,treeData:e.departTree,expandedKeys:e.expandedKeys,"onUpdate:expandedKeys":t[0]||(t[0]=f=>e.expandedKeys=f),selectedKeys:e.selectedDepIds,"onUpdate:selectedKeys":t[1]||(t[1]=f=>e.selectedDepIds=f),onSelect:s},null,8,["treeData","expandedKeys","selectedKeys"])]),_:1}),p(l,{span:20},{default:y(()=>[p(F,{ref_key:"calendarUser",ref:o,onChange:x,onReloadTable:t[2]||(t[2]=f=>d(e.selectedDepKey))},null,512),e.resourceIsNull?$("",!0):(h(),V(C,{key:0,ref:"table",size:"middle",rowKey:"id",columns:_,dataSource:e.dataSource,pagination:e.ipagination,loading:e.loading,rowSelection:{selectedRowKeys:e.selectedRowKeys,onChange:c}},null,8,["dataSource","pagination","loading","rowSelection"]))]),_:1})]),_:1})]),_:1})])}}}));export{Ge as default};
