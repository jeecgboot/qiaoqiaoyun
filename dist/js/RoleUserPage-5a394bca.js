var U=(e,a,p)=>new Promise((h,R)=>{var y=l=>{try{s(p.next(l))}catch(u){R(u)}},d=l=>{try{s(p.throw(l))}catch(u){R(u)}},s=l=>l.done?h(l.value):Promise.resolve(l.value).then(y,d);s((p=p.apply(e,a)).next())});import{d as $,l as F,a3 as P,a4 as x,a5 as t,V as m,a6 as c,a7 as v,a8 as I,ak as b,W as k,k as f,ai as _,F as K,am as E,af as A}from"./vue-vendor-24c7dc61.js";import{R as M,u as z}from"./RoleUserTable-82d6513e.js";import{a as O,l as W}from"./index-831af9dd.js";import{d as j}from"./application.api-4e2bde90.js";import"./index-621e597c.js";import"./BasicTable-d435f501.js";import"./antd-vue-vendor-0d72f01e.js";import"./index-52c8c841.js";import"./useForm-14b2bc77.js";import"./componentMap-c857637c.js";import"./useFormItem-86503382.js";import"./index-1c3affea.js";import"./BasicModal-58413bab.js";import"./useWindowSizeFn-8f085f6f.js";import"./download-1ac6acce.js";import"./index-f99b266a.js";import"./JSelectUser-a44af43a.js";import"./useSelectBiz-2f560b0b.js";import"./props-8a7ac45b.js";import"./JSelectBiz-55a9591f.js";import"./JImageUpload-d644253a.js";import"./JDictSelectTag-54dc3bdb.js";import"./JSelectDept-a90caee3.js";import"./index-f2fd5a28.js";import"./useContextMenu-810f9346.js";import"./areaDataUtil-cdeee717.js";import"./china-area-data-vendor-556d14ee.js";import"./JPopup-2a779923.js";import"./useMethods-f689b480.js";import"./JCheckbox-0b89d32a.js";import"./vxe-table-vendor-8813019a.js";import"./JSelectUserByDept-bd619076.js";import"./UserSelectByDepModal-db060ece.js";import"./depart.api-339f4da6.js";import"./JUpload-76e119c7.js";import"./index-d508f1f4.js";import"./index-6507b9cd.js";import"./index-4d0525a5.js";import"./UserSelectModal-d78c1490.js";import"./helper-22dafba0.js";import"./JAreaLinkage-173780c9.js";import"./JCodeEditor-66bd225e.js";import"./codemirror-17b6f671.js";import"./codemirror-26b29690.js";import"./active-line-512fef49.js";import"./EasyCronInput-b2123242.js";import"./JEditor-249b2194.js";import"./index-b845562c.js";import"./UserNameCell-fcd4cd60.js";import"./useListPage-62a041ef.js";import"./lowAppAuth-3d637b7d.js";import"./lowAppUtils-56892d30.js";import"./RoleUserUpdateModal-7b72dabf.js";const q=$({name:"RoleUserPage",components:{RoleUserTable:M},props:{appId:{type:String,default:""}},emits:["tab-change"],setup(e,{emit:a}){const{createInfoModal:p}=O(),{roleList:h,totalCount:R,searchRoleValue:y,showRoleList:d,activeLiKey:s,initRoleList:l,waitActiveRoleId:u,selectedRole:r,hasAdminAuth:w}=z(e);function g(n){s.value=n.id,r.authRoleId=n.id,r.authRoleName=n.name,r.code=n.code}function o(){s.value="all",r.authRoleId="",r.authRoleName="全部"}function C(n,i){n.key=="edit"?a("tab-change",i.id):p({title:T,width:480,okText:"确认",cancelText:"取消",okCancel:!0,icon:" ",okButtonProps:{danger:!0},onOk:function(){V(i.id)},onCancel:function(){}})}function T(){return F("span",{style:{color:"#f44336"}},"你确认删除此角色吗?")}function V(n){return U(this,null,function*(){yield j(n),yield l();let i=h.value;i&&i.length>0&&g(i[0])})}function B(){a("tab-change",r.authRoleId)}function D(n){u.value=n;let i=h.value;if(i&&i.length>0){let S=i.filter(N=>N.id==n);S.length>0&&g(S[0])}}return{activeLiKey:s,roleList:h,totalCount:R,searchRoleValue:y,showRoleList:d,onSelectAllUser:o,onSelectRole:g,onRoleAction:C,selectedRole:r,goRoleAuthTab:B,initRoleList:l,onSelectRoleById:D,hasAdminAuth:w}}});const L=e=>(P("data-v-d3f7ef16"),e=e(),x(),e),G={class:"flex-flow",style:{height:"100%"}},H={class:"content-list"},J={style:{"margin-bottom":"10px"}},Q={class:"content-top-block"},X=L(()=>t("span",{class:"flex font-14"},"全部",-1)),Y={key:0,class:"num"},Z={class:"search-role"},ee={class:"role-list flex-flow flex",style:{"padding-top":"0"}},oe=["onClick"],te={class:"flex-flow flex ellipsis break-all vertical-middle display-block"},le=L(()=>t("span",{class:"edit-role"},"编辑角色",-1)),ne=L(()=>t("span",{class:"delete-role"},"删除",-1)),ie={class:"user-content-right"},ae={class:"content-right-padding flex"};function se(e,a,p,h,R,y){const d=m("Icon"),s=m("a-input"),l=m("a-menu-item"),u=m("a-menu"),r=m("a-dropdown"),w=m("a-tooltip"),g=m("RoleUserTable");return c(),v("div",G,[t("div",H,[t("div",J,[t("div",Q,[t("ul",null,[t("li",{class:I(["content-li flex-flow",e.activeLiKey==="all"?"li-active":""]),onClick:a[0]||(a[0]=(...o)=>e.onSelectAllUser&&e.onSelectAllUser(...o))},[X,e.totalCount?(c(),v("span",Y,b(e.totalCount),1)):k("",!0)],2)])]),t("div",Z,[f(s,{value:e.searchRoleValue,"onUpdate:value":a[1]||(a[1]=o=>e.searchRoleValue=o),placeholder:"搜索角色",allowClear:""},{prefix:_(()=>[f(d,{style:{color:"#9d9d9d"},icon:"ant-design:search-outlined"})]),_:1},8,["value"])])]),t("div",ee,[t("ul",null,[(c(!0),v(K,null,E(e.showRoleList,o=>(c(),v("li",{class:I(["flex-flow content-li auth-role-item",e.activeLiKey===o.id?"li-active":""]),style:{position:"relative"},onClick:C=>e.onSelectRole(o)},[t("span",te,b(o.name),1),o.count?(c(),v("span",{key:0,class:I(o.code=="admin"?"num fixed-num":"num")},b(o.count),3)):k("",!0),e.hasAdminAuth?(c(),A(r,{key:1,trigger:["click"]},{overlay:_(()=>[f(u,{onClick:C=>e.onRoleAction(C,o)},{default:_(()=>[f(l,{key:"edit",class:"menu-item-content"},{default:_(()=>[le]),_:1}),f(l,{key:"delete",class:"menu-item-content"},{default:_(()=>[ne]),_:1})]),_:2},1032,["onClick"])]),default:_(()=>[o.code!="admin"?(c(),A(d,{key:0,class:"content-icon auth-role-action-icon",icon:"ant-design:ellipsis-outlined"})):k("",!0)]),_:2},1024)):k("",!0),o.description?(c(),A(w,{key:2,title:o.description,placement:"top"},{default:_(()=>[f(d,{icon:"ant-design:info-circle-outlined",color:"#9e9e9e",style:{"margin-left":"5px"}})]),_:2},1032,["title"])):k("",!0)],10,oe))),256))])])]),t("div",ie,[t("div",ae,[f(g,{appId:e.appId,roleList:e.roleList,selectedRole:e.selectedRole,onTabChange:e.goRoleAuthTab,onCountReload:e.initRoleList},null,8,["appId","roleList","selectedRole","onTabChange","onCountReload"])])])])}const ro=W(q,[["render",se],["__scopeId","data-v-d3f7ef16"]]);export{ro as default};
