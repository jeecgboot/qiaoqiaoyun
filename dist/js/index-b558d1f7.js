var le=Object.defineProperty,me=Object.defineProperties;var ue=Object.getOwnPropertyDescriptors;var U=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var I=(a,o,i)=>o in a?le(a,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[o]=i,F=(a,o)=>{for(var i in o||(o={}))ce.call(o,i)&&I(a,i,o[i]);if(U)for(var i of U(o))pe.call(o,i)&&I(a,i,o[i]);return a},$=(a,o)=>me(a,ue(o));var p=(a,o,i)=>new Promise((S,h)=>{var f=m=>{try{g(i.next(m))}catch(_){h(_)}},M=m=>{try{g(i.throw(m))}catch(_){h(_)}},g=m=>m.done?S(m.value):Promise.resolve(m.value).then(f,M);g((i=i.apply(a,o)).next())});import{d as B,V as d,v as de,a6 as k,a7 as fe,k as n,ai as r,q as P,af as v,E as u,u as t,W as ge}from"./vue-vendor-24c7dc61.js";import"./index-621e597c.js";import _e from"./UserDrawer-7d4aa4cb.js";import we from"./UserRecycleBinModal-4901f759.js";import be from"./PasswordModal-993eb075.js";import he from"./UserAgentModal-8da2b6b4.js";import ye from"./UserQuitAgentModal-ed48508d.js";import Ce from"./UserQuitModal-c9264b7b.js";import{u as ke}from"./index-44229d9b.js";import{u as Se}from"./useListPage-62a041ef.js";import"./index-1c3affea.js";import{V as Me,e as b,a as Re}from"./index-831af9dd.js";import{d as ve,s as De}from"./user.data-965c1456.js";import{o as Ae,q as xe,r as Te,t as Ue,v as Ie,w as Q,x as Fe}from"./user.api-ffaaa05b.js";import{T as $e}from"./componentMap-c857637c.js";import Pe from"./BasicTable-d435f501.js";import"./antd-vue-vendor-0d72f01e.js";import"./index-52c8c841.js";import"./useForm-14b2bc77.js";import"./helper-22dafba0.js";import"./BasicModal-58413bab.js";import"./useWindowSizeFn-8f085f6f.js";import"./JAreaLinkage-173780c9.js";import"./areaDataUtil-cdeee717.js";import"./china-area-data-vendor-556d14ee.js";import"./useFormItem-86503382.js";import"./vxe-table-vendor-8813019a.js";import"./JSelectUser-a44af43a.js";import"./useSelectBiz-2f560b0b.js";import"./props-8a7ac45b.js";import"./JSelectBiz-55a9591f.js";import"./JSelectDept-a90caee3.js";import"./index-f2fd5a28.js";import"./useContextMenu-810f9346.js";import"./JCodeEditor-66bd225e.js";import"./codemirror-17b6f671.js";import"./codemirror-26b29690.js";import"./active-line-512fef49.js";import"./JPopup-2a779923.js";import"./useMethods-f689b480.js";import"./EasyCronInput-b2123242.js";import"./JCheckbox-0b89d32a.js";import"./JDictSelectTag-54dc3bdb.js";import"./JSelectUserByDept-bd619076.js";import"./UserSelectByDepModal-db060ece.js";import"./depart.api-339f4da6.js";import"./JEditor-249b2194.js";import"./index-b845562c.js";import"./JImageUpload-d644253a.js";import"./download-1ac6acce.js";import"./index-f99b266a.js";import"./JUpload-76e119c7.js";import"./index-d508f1f4.js";import"./index-6507b9cd.js";import"./index-4d0525a5.js";import"./UserSelectModal-d78c1490.js";import"./validator-bc7dc032.js";import"./renderUtils-7ad8f436.js";const Qe=B({name:"system-user"}),Kt=B($(F({},Qe),{setup(a){const{createMessage:o,createConfirm:i}=Re(),{isDisabledAuth:S}=Me(),[h,{openDrawer:f}]=ke(),[M,{openModal:g}]=b(),[m,{openModal:_}]=b(),[E,{openModal:V}]=b(),[j,{openModal:z}]=b(),[N,{openModal:Be}]=b(),{prefixCls:Ee,tableContext:q,onExportXls:O,onImportXls:X}=Se({designScope:"user-list",tableProps:{title:"用户列表",api:Ae,columns:ve,size:"small",formConfig:{schemas:De},actionColumn:{width:120},beforeFetch:e=>Object.assign({column:"createTime",order:"desc"},e)},exportConfig:{name:"用户列表",url:xe},importConfig:{url:Te}}),[H,{reload:l,updateTableDataRecord:Ve},{rowSelection:K,selectedRows:D,selectedRowKeys:y}]=q;function L(){f(!0,{isUpdate:!1,showFooter:!0,tenantSaas:!1})}function W(e){return p(this,null,function*(){f(!0,{record:e,isUpdate:!0,showFooter:!0,tenantSaas:!1})})}function G(e){return p(this,null,function*(){f(!0,{record:e,isUpdate:!0,showFooter:!1,tenantSaas:!1})})}function J(e){return p(this,null,function*(){if(e.username=="admin"){o.warning("管理员账号不允许此操作！");return}yield Ue({id:e.id},l)})}function Y(){return p(this,null,function*(){let e=t(D).filter(s=>s.username=="admin");if(t(e).length>0){o.warning("管理员账号不允许此操作！");return}yield Ie({ids:y.value},()=>{y.value=[],l()})})}function Z(){l()}function ee(e){_(!0,{username:e})}function te(e){V(!0,{userName:e})}function A(e,s){return p(this,null,function*(){if(e.username=="admin"){o.warning("管理员账号不允许此操作！");return}yield Q({ids:e.id,status:s},l)})}function x(e){let s=D.value.filter(c=>c.username=="admin");if(t(s).length>0){o.warning("管理员账号不允许此操作！");return}i({iconType:"warning",title:"确认操作",content:"是否"+(e==1?"解冻":"冻结")+"选中账号?",onOk:()=>p(this,null,function*(){yield Q({ids:t(y).join(","),status:e},l)})})}function ne(){Fe()}function je({isToLocal:e}){e&&l()}function oe(e){return[{label:"编辑",onClick:W.bind(null,e)}]}function ie(e){return[{label:"详情",onClick:G.bind(null,e)},{label:"密码",onClick:ee.bind(null,e.username)},{label:"删除",popConfirm:{title:"是否确认删除",confirm:J.bind(null,e)}},{label:"冻结",ifShow:e.status==1,popConfirm:{title:"确定冻结吗?",confirm:A.bind(null,e,2)}},{label:"解冻",ifShow:e.status==2,popConfirm:{title:"确定解冻吗?",confirm:A.bind(null,e,1)}},{label:"代理人",onClick:te.bind(null,e.username)}]}function ze(e){z(!0,{userName:e})}return(e,s)=>{const c=d("a-button"),re=d("j-upload-button"),C=d("Icon"),R=d("a-menu-item"),ae=d("a-menu"),se=d("a-dropdown"),T=de("auth");return k(),fe("div",null,[n(t(Pe),{onRegister:t(H),rowSelection:t(K)},{tableTitle:r(()=>[P((k(),v(c,{type:"primary",preIcon:"ant-design:plus-outlined",onClick:L},{default:r(()=>[u(" 新增")]),_:1})),[[T,"system:user:add"]]),n(c,{type:"primary",preIcon:"ant-design:export-outlined",onClick:t(O),disabled:t(S)("system:user:export")},{default:r(()=>[u(" 导出")]),_:1},8,["onClick","disabled"]),P((k(),v(re,{type:"primary",preIcon:"ant-design:import-outlined",onClick:t(X)},{default:r(()=>[u("导入")]),_:1},8,["onClick"])),[[T,"system:user:import"]]),n(c,{type:"primary",onClick:ne,preIcon:"ant-design:sync-outlined"},{default:r(()=>[u(" 同步流程")]),_:1}),n(c,{type:"primary",onClick:s[0]||(s[0]=w=>t(g)(!0,{})),preIcon:"ant-design:hdd-outlined"},{default:r(()=>[u(" 回收站")]),_:1}),t(y).length>0?(k(),v(se,{key:0},{overlay:r(()=>[n(ae,null,{default:r(()=>[n(R,{key:"1",onClick:Y},{default:r(()=>[n(C,{icon:"ant-design:delete-outlined"}),u(" 删除 ")]),_:1}),n(R,{key:"2",onClick:s[1]||(s[1]=w=>x(2))},{default:r(()=>[n(C,{icon:"ant-design:lock-outlined"}),u(" 冻结 ")]),_:1}),n(R,{key:"3",onClick:s[2]||(s[2]=w=>x(1))},{default:r(()=>[n(C,{icon:"ant-design:unlock-outlined"}),u(" 解冻 ")]),_:1})]),_:1})]),default:r(()=>[n(c,null,{default:r(()=>[u("批量操作 "),n(C,{icon:"mdi:chevron-down"})]),_:1})]),_:1})):ge("",!0)]),action:r(({record:w})=>[n(t($e),{actions:oe(w),dropDownActions:ie(w)},null,8,["actions","dropDownActions"])]),_:1},8,["onRegister","rowSelection"]),n(_e,{onRegister:t(h),onSuccess:Z},null,8,["onRegister"]),n(be,{onRegister:t(m),onSuccess:t(l)},null,8,["onRegister","onSuccess"]),n(he,{onRegister:t(E),onSuccess:t(l)},null,8,["onRegister","onSuccess"]),n(we,{onRegister:t(M),onSuccess:t(l)},null,8,["onRegister","onSuccess"]),n(ye,{onRegister:t(j),onSuccess:t(l)},null,8,["onRegister","onSuccess"]),n(Ce,{onRegister:t(N),onSuccess:t(l)},null,8,["onRegister","onSuccess"])])}}}));export{Kt as default};
