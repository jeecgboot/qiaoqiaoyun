var C=(o,p,i)=>new Promise((s,t)=>{var u=n=>{try{f(i.next(n))}catch(e){t(e)}},c=n=>{try{f(i.throw(n))}catch(e){t(e)}},f=n=>n.done?s(n.value):Promise.resolve(n.value).then(u,c);f((i=i.apply(o,p)).next())});import{d as B,f as b,c as S,w as T,n as O,V as k,a6 as w,af as _}from"./vue-vendor-24c7dc61.js";import{b0 as $,l as j}from"./index-831af9dd.js";import"./antd-vue-vendor-0d72f01e.js";import"./vxe-table-vendor-8813019a.js";const E=B({name:"DBFormTable",props:{actionButton:{type:Boolean,default:!0},relationFormList:{type:Array,default:()=>[]}},emits:["valueChange"],setup(o,{emit:p}){const i=b();let s=S("formOptions");const t=b([]),u=b([]);T(()=>o.relationFormList,e=>{setTimeout(()=>{c(e)},100)},{immediate:!0});function c(e){e.forEach(a=>{let l=s.value.filter(r=>r.value==a);if(l.length>0){let r=t.value.filter(h=>h.key==a);r.length==0?t.value.push({title:l[0].label,key:a,type:$.select,options:[...l[0].fieldOptions],defaultValue:"",placeholder:"请选择${title}",validateRules:[{required:!0,message:"请选择${title}"}],width:150}):r[0].options=[...l[0].fieldOptions]}});const d=t.value.filter(a=>!e.find(l=>l===a.key));d&&d.length>0&&d.forEach(a=>{t.value.splice(t.value.findIndex(l=>a.key===l.key),1)})}function f(e){const d=i.value.getTableData();let a=[];d.forEach(l=>{let r="",h="";o.relationFormList.forEach((g,V)=>{let y=s.value.filter(m=>m.value==g);if(y.length>0){let m=y[0].fieldOptions.filter(v=>v.value==l[g]);if(m.length>0){let v=V==0?"":"-";r+=v+m[0].title,h+=v+m[0].value}}}),a.push({label:r,value:h})}),p("valueChange",a)}function n(e){return C(this,null,function*(){yield O(),u.value=e,yield O()})}return{tableRef:i,columns:t,dataSource:u,handleValueChange:f,setDataSource:n}}});function F(o,p,i,s,t,u){const c=k("JVxeTable");return w(),_(c,{ref:"tableRef",rowSelection:"",keyboardEdit:"",keepSource:"",sortKey:"orderNum",addButtonSettings:"",columns:o.columns,dataSource:o.dataSource,toolbar:o.actionButton,onValueChange:o.handleValueChange},null,8,["columns","dataSource","toolbar","onValueChange"])}const q=j(E,[["render",F]]);export{q as default};
