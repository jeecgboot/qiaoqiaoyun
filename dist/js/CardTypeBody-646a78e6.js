var _=(l,t,a)=>new Promise((u,o)=>{var d=s=>{try{r(a.next(s))}catch(c){o(c)}},i=s=>{try{r(a.throw(s))}catch(c){o(c)}},r=s=>s.done?u(s.value):Promise.resolve(s.value).then(d,i);r((a=a.apply(l,t)).next())});import{d as k,f as v,e as y,w as B,o as E,j as w,n as C,V as N,a6 as f,a7 as m,O as b,af as g,ai as h,k as S,u as H,E as I,W as T,a3 as L,a4 as V,a5 as O}from"./vue-vendor-24c7dc61.js";import{aI as j,ak as D}from"./antd-vue-vendor-0d72f01e.js";import{l as R}from"./index-831af9dd.js";import"./vxe-table-vendor-8813019a.js";const q=l=>(L("data-v-692ded4e"),l=l(),V(),l),F={key:0,class:"bottom"},M=q(()=>O("span",{style:{"margin-left":"8px"}},"加载中",-1)),U=k({__name:"CardTypeBody",props:{cardType:{required:!0,type:Object},loadNext:Function},setup(l){const t=l,a=v(),u=j(x,150),o=y(()=>t.cardType.paging),d=v(!1),i=v(!0),r=y(()=>{var e;return(e=t.cardType.data)!=null?e:[]}),s=y(()=>{var e;return(e=t.cardType.count)!=null?e:r.value.length});B(()=>t.cardType.paging.isChange,e=>{var n;e===!0&&((n=a.value)==null||n.scrollTo(0,0),t.cardType.paging.isChange=!1)},{immediate:!0}),E(()=>{r.value.length>=s.value&&(o.value.isEnd=!0,i.value=!1),a.value.addEventListener("scroll",u);const{clientHeight:e,scrollHeight:n}=a.value;n>e?i.value=!0:o.value.isEnd||c()}),w(()=>{var e;(e=a.value)==null||e.removeEventListener("scroll",u)});function c(){return _(this,null,function*(){var e;if(typeof t.loadNext=="function"&&!o.value.isEnd){d.value=!0;try{yield t.loadNext((e=t.cardType)==null?void 0:e.value,o.value.current+1),yield C(),r.value.length>=s.value&&(o.value.isEnd=!0)}catch(n){}finally{d.value=!1}}})}function x(){if(o.value.isEnd||d.value)return;const{scrollTop:e,clientHeight:n,scrollHeight:p}=a.value;e+n>=p-50&&c()}return(e,n)=>{const p=N("a-divider");return f(),m("div",{ref_key:"bodyRef",ref:a,class:"card-type-body"},[b(e.$slots,"default",{},void 0,!0),i.value?(f(),m("div",F,[d.value?(f(),g(p,{key:0},{default:h(()=>[S(H(D)),M]),_:1})):o.value.isEnd?(f(),g(p,{key:1},{default:h(()=>[I("已经到底了")]),_:1})):T("",!0)])):T("",!0)],512)}}});const K=R(U,[["__scopeId","data-v-692ded4e"]]);export{K as default};
