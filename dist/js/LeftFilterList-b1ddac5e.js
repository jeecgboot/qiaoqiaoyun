var U=Object.defineProperty;var T=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var O=(i,t,n)=>t in i?U(i,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[t]=n,V=(i,t)=>{for(var n in t||(t={}))J.call(t,n)&&O(i,n,t[n]);if(T)for(var n of T(t))X.call(t,n)&&O(i,n,t[n]);return i};var b=(i,t,n)=>new Promise((a,f)=>{var u=r=>{try{v(n.next(r))}catch(p){f(p)}},c=r=>{try{v(n.throw(r))}catch(p){f(p)}},v=r=>r.done?a(r.value):Promise.resolve(r.value).then(u,c);v((n=n.apply(i,t)).next())});import{f as m,r as Y,w as M,V as y,a6 as _,a7 as g,a8 as R,a5 as L,k as D,z as B,W as I,ae as q,af as S,ai as E,ak as H}from"./vue-vendor-24c7dc61.js";import{n as G,bX as Q,bY as Z}from"./antd-vue-vendor-0d72f01e.js";import{k as N,l as A}from"./index-831af9dd.js";import"./vxe-table-vendor-8813019a.js";const P="/sys/dict/loadTreeData",$={name:"LeftFilterList",components:{SearchOutlined:G,DoubleLeftOutlined:Q,DoubleRightOutlined:Z},props:{status:{type:Boolean,default:!0},options:{type:Object,default:()=>{}},dynamicConfig:{type:Object,default:()=>{}}},emits:["expand","load"],setup(i,{emit:t}){const n=m(!0),a=m(""),f=m(!1),u=Y({table:"",label:"",store:"",idField:"",pidField:"",conditionField:"",pidValue:""}),c=m([]);M(()=>i.status,e=>{n.value=e},{immediate:!0});function v(e){t("expand",e)}const r=m([]);M(()=>i.dynamicConfig,e=>b(this,null,function*(){e&&(e.treeModel&&e.treeModel.table?(Object.keys(e.treeModel).map(l=>{u[l]=e.treeModel[l]}),yield h(),f.value=!0):(p(e),f.value=!1))}),{immediate:!0,deep:!0});function p(e){if(e.dictCountList&&e.dictCountList.length>0){let l=[{value:"",text:"全部",count:i.dynamicConfig.total}];for(let o of e.dictCountList)o.value&&l.push(V({},o));r.value=l}}function k(){return{pidField:u.pidField,tableName:u.table,text:u.label,code:u.store,hasChildField:"1"}}function h(e){return b(this,null,function*(){let l=k();l.pid=u.pidValue,e===!0?l.condition=JSON.stringify({[u.label]:a.value}):l.condition="{}";let o=yield N.get({url:P,params:l},{isTransformResponse:!1});if(o.success&&o.result){for(let s of o.result)s.value=s.key,s.isLeaf=!!s.leaf;c.value=[...o.result]}})}function d(e){return b(this,null,function*(){if(e.dataRef.children)return Promise.resolve();let l=e.dataRef.key,o=k();o.pid=l,o.condition="{}";let s=yield N.get({url:P,params:o},{isTransformResponse:!1});if(s.success){for(let x of s.result)x.value=x.key,x.isLeaf=!!x.leaf;C(l,s.result,c.value),c.value=[...c.value]}return Promise.resolve()})}function C(e,l,o){if(o&&o.length>0)for(let s of o)if(s.key==e){!l||l.length==0?s.isLeaf=!0:s.children=l;break}else C(e,l,s.children)}const F=m();F.value=window.innerHeight-220;const w=m("");function W(e,l){e&&(e.preventDefault(),e.stopPropagation()),w.value=l.value,t("load",l.value)}function j(e){if(e.value==="")return!0;let l=a.value;return e.text.indexOf(l)>=0}function z(e){t("load",e[0])}function K(e){c.value=[],h(!!e)}return{expandLeft:n,treeKeyWord:a,onChange:v,listHeight:F,handleSelectItem:W,dataList:r,activeValue:w,showListItem:j,isTree:f,treeData:c,getTreeRootData:h,asyncLoadTreeData:d,onSelectTree:z,onSearch:K}}};const ee={key:0,class:"left-top-search"},te={class:"icon-div"},ae={key:2,class:"left-top-search"},le={class:"icon-div"};function ne(i,t,n,a,f,u){const c=y("a-input-search"),v=y("double-left-outlined"),r=y("a-tree"),p=y("a-list-item"),k=y("a-list"),h=y("double-right-outlined");return _(),g("div",{style:{"padding-top":"10px"},class:R(a.expandLeft?"tree-div-expand":"tree-div-unexpand")},[a.expandLeft?(_(),g("div",ee,[L("div",null,[D(c,{value:a.treeKeyWord,"onUpdate:value":t[0]||(t[0]=d=>a.treeKeyWord=d),placeholder:"输入后回车搜索",class:"myinput",onSearch:a.onSearch},null,8,["value","onSearch"])]),L("div",te,[D(v,{onClick:t[1]||(t[1]=B(d=>a.onChange(!1),["prevent"])),title:"折叠"})])])):I("",!0),a.expandLeft?(_(),g("div",{key:1,class:"left-tree-content",style:q({height:a.listHeight+"px"})},[a.isTree?(_(),S(r,{key:0,"tree-data":a.treeData,"load-data":a.asyncLoadTreeData,onSelect:a.onSelectTree},null,8,["tree-data","load-data","onSelect"])):(_(),S(k,{key:1,"data-source":a.dataList},{renderItem:E(({item:d})=>[a.showListItem(d)?(_(),S(p,{key:0,onClick:C=>a.handleSelectItem(C,d),class:R(d.value==a.activeValue?"active":"")},{default:E(()=>[L("div",null,H(d.text),1),L("div",null,H(d.count||""),1)]),_:2},1032,["onClick","class"])):I("",!0)]),_:1},8,["data-source"]))],4)):(_(),g("div",ae,[L("div",le,[D(h,{onClick:t[2]||(t[2]=B(d=>a.onChange(!0),["prevent"])),title:"展开"})])]))],2)}const ue=A($,[["render",ne]]);export{ue as default};
