var R=Object.defineProperty,q=Object.defineProperties;var E=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var F=(e,t,s)=>t in e?R(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,S=(e,t)=>{for(var s in t||(t={}))H.call(t,s)&&F(e,s,t[s]);if(k)for(var s of k(t))P.call(t,s)&&F(e,s,t[s]);return e},U=(e,t)=>q(e,E(t));import{d as V,f as l,V as m,a6 as z,af as T,ai as C,a5 as n,a7 as W,k as v,W as $,q as j,A as G,a3 as J,a4 as K,u as i}from"./vue-vendor-24c7dc61.js";import{F as L,n as Q}from"./FileList.api-9749c044.js";import{a as X,ap as Y,l as Z}from"./index-831af9dd.js";import ee from"./FileIcon-6b648a4f.js";import"./antd-vue-vendor-0d72f01e.js";import"./vxe-table-vendor-8813019a.js";import"./link-d33a2dbc.js";const h=e=>(J("data-v-389a6bff"),e=e(),K(),e),te={class:"new-version"},se=h(()=>n("span",{style:{"font-size":"17px","font-weight":"normal"}},"上传新版本",-1)),ae={key:0},oe={class:"file-form",style:{"margin-top":"20px"}},le={class:"file-item"},ne=h(()=>n("div",{class:"file-item-label"},"名称",-1)),ie={class:"file-item-content"},ce={class:"file-item"},de=h(()=>n("div",{class:"file-item-label"},"添加说明",-1)),fe={class:"file-item-content"},re=V({name:"upload-new-version"}),ue=V(U(S({},re),{emits:["ok"],setup(e,{expose:t,emit:s}){const f=l(!1),r=l(!0),u=l(""),g=l(""),p=l(""),w=l(0),x=l(""),I=l(""),y=l(""),_=l(""),{createMessage:B}=X(),N=l();function D(o){f.value=!0,u.value=o.fileName.substring(0,o.fileName.lastIndexOf(".")),g.value=o.fileName,w.value=1,r.value=!0,x.value=o.fileId;let a=new FormData;a.append("bizPath","biz/user_imgs"),a.append("file",o.file),L(a).then(c=>{c.success&&c.message&&(w.value=100,_.value=c.message,I.value=c.message.substring(c.message.lastIndexOf(".")+1),y.value=o.file.size,r.value=!1,setTimeout(()=>{N.value.setIconData({url:i(_),ext:i(I),izFolder:""})},100))})}function O(){if(!i(u)){B.warn("请输入新版本文件名");return}let o={fileId:i(x),fileSize:i(y),fileName:i(g),fileUrl:i(_),description:i(p),type:"newFile"};Q(o).then(a=>{a.success&&(s("ok"),b())})}function b(){f.value=!1}function pe(o){return Y(o)}return t({upload:D}),(o,a)=>{const c=m("a-input"),A=m("a-textarea"),M=m("a-modal");return z(),T(M,{open:f.value,"onUpdate:open":a[2]||(a[2]=d=>f.value=d),onOk:O,onCancel:b,wrapClassName:"modal"},{title:C(()=>[n("div",te,[se,r.value?$("",!0):(z(),W("div",ae,[v(ee,{ref_key:"fileIconRef",ref:N},null,512)]))]),j(n("div",null,null,512),[[G,r.value]])]),default:C(()=>[n("div",oe,[n("div",le,[ne,n("div",ie,[v(c,{value:u.value,"onUpdate:value":a[0]||(a[0]=d=>u.value=d),style:{width:"90%"}},null,8,["value"])])]),n("div",ce,[de,n("div",fe,[v(A,{value:p.value,"onUpdate:value":a[1]||(a[1]=d=>p.value=d),placeholder:"对此版本添加说明,可在属性-日志中查看",style:{width:"90%"}},null,8,["value"])])])])]),_:1},8,["open"])}}}));const ye=Z(ue,[["__scopeId","data-v-389a6bff"]]);export{ye as default};
