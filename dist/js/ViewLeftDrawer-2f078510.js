var L=(t,s,r)=>new Promise((w,g)=>{var C=a=>{try{c(r.next(a))}catch(p){g(p)}},v=a=>{try{c(r.throw(a))}catch(p){g(p)}},c=a=>a.done?w(a.value):Promise.resolve(a.value).then(C,v);c((r=r.apply(t,s)).next())});import{d as O,f as y,w as $,a5 as m,V as f,a6 as V,af as A,ai as u,k as i,a7 as z,a8 as H,ak as W,z as F,W as M}from"./vue-vendor-24c7dc61.js";import{n as P}from"./antd-vue-vendor-0d72f01e.js";import{d as T}from"./vuedraggable-vendor-6ef4bc68.js";import{k as E,l as j}from"./index-831af9dd.js";import{u as G}from"./useWatchDesigner-b7c458e6.js";import"./vxe-table-vendor-8813019a.js";const J=O({name:"ViewLeftDrawer",props:{routeCode:{type:String,default:""},viewConfigList:{type:Array,default:()=>[]}},components:{SearchOutlined:P,draggable:T},emits:["ok","copy","delete","active","close"],setup(t,{emit:s}){const r=y(!1),w=y(""),g=y("200px");g.value=window.innerHeight-140+"px";const C={height:g.value},v=y({height:g.value,zIndex:1e3});G({closeDrawer:c,getVisible:r});function c(){r.value=!1,setTimeout(()=>{v.value.zIndex=-1,s("close")},100)}function a(e){r.value=!0,w.value=e,v.value.zIndex=1e3}function p(){return document.querySelector("#"+t.routeCode)}const _=y(""),h=y([]);$(()=>t.viewConfigList,e=>{b(e)},{deep:!0,immediate:!0});function b(e){let o=[];if(e&&e.length>0)for(let l of e)o.push({id:l.id,name:l.name,seq:l.seq,type:l.type,updateStatus:!1,action:!1});o.sort(function(l,I){return l.seq-I.seq}),h.value=o}function S(){return L(this,null,function*(){let e=h.value;if(e&&e.length>0){let o=[];for(let k=0;k<e.length;k++)o.push({id:e[k].id,seq:k+1});let l={list:o};const I="/desform/view/resetOrder";yield E.post({url:I,params:l}),s("ok")}})}function D(){S()}function n(e){return _.value?e.name&&e.name.indexOf(_.value)>=0:!0}function d(e){return e.type==="base"?"ant-design:table-outlined":e.type==="card"?"ant-design:sliders-outlined":e.type==="calendar"?"ant-design:calendar-outlined":""}function N(e){return e.type==="base"?"#ffa515":e.type==="card"?"#4caf50":e.type==="calendar"?"#f54081":""}function q(e){let o="view-item";return w.value==e.id&&(o+=" active"),o}function x(e,o){e.preventDefault(),e.stopPropagation(),w.value=o.id,s("active",o.id)}function B(e,o){let l=e.key;l=="update"?o.updateStatus=!0:l=="copy"?(s("copy",{id:o.id}),close()):l=="delete"&&(s("delete",{id:o.id}),close()),o.action=!1}function U(e){return L(this,null,function*(){const o="/desform/view/updateViewConfig";let l={name:e.name,id:e.id};yield E.put({url:o,params:l}),e.updateStatus=!1,s("ok")})}return{visible:r,onClose:c,bodyStyle:C,getContainer:p,open:a,bodyHeight:g,filterValue:_,drawerStyle:v,viewList:h,onDragEnd:D,isShowItem:n,getViewIconColor:N,getViewIcon:d,getViewClass:q,onSelect:x,handleActionClick:B,onChangeViewName:U}}});const K={style:{height:"100%","overflow-y":"hidden"}},Q={class:"search-div"},R={class:"views-div"},X=["onClick"],Y={key:0,style:{"margin-right":"5px"}},Z={key:1,style:{flex:"1"},class:"ellipsis"},ee=m("span",{class:"label"},"重命名",-1),te=m("span",{class:"label"},"复制",-1),ne=m("span",{class:"label"},"删除",-1);function oe(t,s,r,w,g,C){const v=f("search-outlined"),c=f("a-input"),a=f("Icon"),p=f("a-menu-item"),_=f("a-menu-divider"),h=f("a-menu"),b=f("a-dropdown"),S=f("draggable"),D=f("a-drawer");return V(),A(D,{placement:"left",closable:!1,maskClosable:"",width:280,getContainer:t.getContainer,rootClassName:"low-app-view-left-drawer",open:t.visible,onClose:t.onClose,destroyOnClose:!0,rootStyle:t.drawerStyle},{title:u(()=>[]),default:u(()=>[m("div",K,[m("div",Q,[i(c,{placeholder:t.viewList.length+"个视图",class:"my-input",value:t.filterValue,"onUpdate:value":s[0]||(s[0]=n=>t.filterValue=n)},{prefix:u(()=>[i(v,{style:{color:"#c0c0c0","font-size":"18px","margin-right":"5px"}})]),_:1},8,["placeholder","value"])]),m("div",R,[i(S,{"item-key":"id",animation:"300",group:"tabView",tag:"ul",modelValue:t.viewList,"onUpdate:modelValue":s[2]||(s[2]=n=>t.viewList=n),dragClass:"dragClass",onEnd:t.onDragEnd},{item:u(({element:n})=>[t.isShowItem(n)?(V(),z("li",{key:0,class:H(t.getViewClass(n)),onClick:d=>t.onSelect(d,n)},[i(a,{icon:"ant-design:holder-outlined",class:"hold-icon"}),i(a,{icon:t.getViewIcon(n),color:t.getViewIconColor(n),style:{"font-size":"20px",margin:"0 7px 0 3px"}},null,8,["icon","color"]),n.updateStatus?(V(),z("span",Y,[i(c,{value:n.name,"onUpdate:value":d=>n.name=d,onBlur:d=>t.onChangeViewName(n)},null,8,["value","onUpdate:value","onBlur"])])):(V(),z("span",Z,W(n.name),1)),i(b,{open:n.action,"onUpdate:open":d=>n.action=d,trigger:["click"],overlayClassName:"drawer-view-actions-dropdown"},{overlay:u(()=>[i(h,{onClick:d=>t.handleActionClick(d,n)},{default:u(()=>[i(p,{key:"update"},{default:u(()=>[i(a,{icon:"ant-design:edit-outlined",style:{"margin-right":"10px"}}),ee]),_:1}),i(p,{key:"copy"},{default:u(()=>[i(a,{icon:"ant-design:copy-outlined",style:{"margin-right":"10px"}}),te]),_:1}),i(_),i(p,{key:"delete",class:"delete-item"},{default:u(()=>[i(a,{icon:"ant-design:delete-filled",style:{"margin-right":"10px"}}),ne]),_:1})]),_:2},1032,["onClick"])]),default:u(()=>[i(a,{icon:"ant-design:ellipsis-outlined",style:{"font-size":"20px"},class:"hold-icon",onClick:s[1]||(s[1]=F(()=>{},["prevent"]))})]),_:2},1032,["open","onUpdate:open"])],10,X)):M("",!0)]),_:1},8,["modelValue","onEnd"])])])]),_:1},8,["getContainer","open","onClose","rootStyle"])}const ce=j(J,[["render",oe]]);export{ce as default};
