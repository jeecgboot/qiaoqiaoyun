var c=(e,t,s)=>new Promise((a,o)=>{var i=p=>{try{r(s.next(p))}catch(l){o(l)}},n=p=>{try{r(s.throw(p))}catch(l){o(l)}},r=p=>p.done?a(p.value):Promise.resolve(p.value).then(i,n);r((s=s.apply(e,t)).next())});import{u as y,m as g,n as M,c as m,s as T}from"./index-831af9dd.js";import{L as f,R as u,b as h}from"./index-a964241b.js";import{a as d}from"./low.app.api-97fc250a.js";function w(e,t){let s=!1,a=()=>s=!0,o=(i,n)=>{if(Array.isArray(i)&&i.length>0){for(let r of i)if(t(r,n,a),s||(r.type===f.GROUP.type&&o(r.children,r),s))break}};o(e,null)}function v(e){if(e.type===f.CGFORM.type){let{cgformThemeTemplate:t,cgformIsTree:s}=e,a="normal";return t==="erp"?a="erp":t==="innerTable"?a="inner":t==="tab"?a="tab":s==="Y"&&(a="tree"),`/${u}/${e.appId}/${e.type}/${a}/${e.menuUrl}`}else return`/${u}/${e.appId}/${e.type}/${e.menuUrl}`}function R(e){switch(e){case"low-app-@appId":case"low-app-@appId-list-cgform":case"low-app-@appId-list-desform":case"low-app-@appId-list-cgreport":case"low-app-@appId-list-graphreport":case"low-app-@appId-menu-recycle-bin":return!0;default:return!1}}const $=y(),I=g(),A=M({id:"low-app",state:()=>({appInfo:{},appMenus:[],initialed:!1,devMode:null}),getters:{appId:e=>e.appInfo.id,getDevMode(){let e=this.devMode;return e==null&&(e=!1,this.appId&&(e=S(this.appId)),this.devMode=e),e}},actions:{setInfo({menuList:e,record:t}){w(e,s=>{s.type!==f.GROUP.type&&(s.routerLink=v(s))}),this.initialed=!0,this.appInfo=t,this.appMenus=e},setDevMode(e){if(!this.appId)return!1;I.set(h+this.appId,e),this.devMode=e},changeTitle(e){const t="敲敲云";e?document.title=e+" · "+this.appInfo.appName+" · "+t:document.title=this.appInfo.appName+" · "+t},queryAppInfo(e){return c(this,null,function*(){try{const t=yield d.queryDetail(e);return t.success&&(this.setInfo(t.result),this.changeTitle()),t}catch(t){return{success:!1,message:t.message||t,code:500}}})},queryAppInfoForShare(e){return c(this,null,function*(){try{const t=yield d.queryDetailForShare(e);return t.success&&(this.setInfo(t.result),this.changeTitle(),m()!=t.result.shareTenantId&&$.setShareTenantId(t.result.shareTenantId)),t}catch(t){return{success:!1,message:t.message||t,code:500}}})}}});function S(e){let t=I.get(h+e);return typeof t!="boolean"&&(t=!1),t}function k(){return A(T)}export{A as a,R as i,k as u};
