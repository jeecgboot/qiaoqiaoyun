var ae=Object.defineProperty,ie=Object.defineProperties;var oe=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var z=(s,i,r)=>i in s?ae(s,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[i]=r,A=(s,i)=>{for(var r in i||(i={}))se.call(i,r)&&z(s,r,i[r]);if(V)for(var r of V(i))ne.call(i,r)&&z(s,r,i[r]);return s},B=(s,i)=>ie(s,oe(i));import{d as E,f as l,a2 as ue,o as re,V as C,a6 as y,a7 as h,a5 as c,k as p,ak as P,F as O,am as ce,E as q,W,ai as I,z as de,a3 as pe,a4 as fe,u,n as ve}from"./vue-vendor-24c7dc61.js";import _e from"./UploadFile-82a89ddf.js";import me from"./FileLink-d825cf38.js";import ye from"./LeftFile-0a41680c.js";import he from"./RightFile-817e2032.js";import{a as ke,b as Fe}from"./FileList.api-9749c044.js";import{a7 as Ie,l as Le}from"./index-831af9dd.js";import"./SelectFolder-91dc24b4.js";import"./antd-vue-vendor-0d72f01e.js";import"./link-d33a2dbc.js";import"./UserSelectByDepModal-db060ece.js";import"./index-1c3affea.js";import"./BasicModal-58413bab.js";import"./useWindowSizeFn-8f085f6f.js";import"./index-f2fd5a28.js";import"./useContextMenu-810f9346.js";import"./useSelectBiz-2f560b0b.js";import"./depart.api-339f4da6.js";import"./props-8a7ac45b.js";import"./header-55b09394.js";import"./FileLog-856778d4.js";import"./FilePopover-961bdae7.js";import"./renderUtils-7ad8f436.js";import"./index-b845562c.js";import"./UploadNewVersion-627ffa3d.js";import"./FileIcon-6b648a4f.js";import"./FileAttributes-3deed050.js";import"./vxe-table-vendor-8813019a.js";const N=s=>(pe("data-v-491970e4"),s=s(),fe(),s),ge={class:"p-4"},Ce={style:{width:"260px"}},Ne={class:"header"},Te={key:0,class:"left"},Re=N(()=>c("span",null," >    ",-1)),Se=["onClick"],we={key:1},xe={key:2,class:"global-search ellipsis"},Pe={key:1,class:"left"},De=N(()=>c("span",null,"知识库  中的搜索结果",-1)),be=[De],Me={key:2,class:"dropdown-position"},Ue=N(()=>c("span",{class:"upload-font-size"},"上传本地文件",-1)),Ve=N(()=>c("span",{class:"upload-font-size"},"添加链接文件",-1)),ze=N(()=>c("span",{class:"upload-font-size"},"新建文件夹",-1)),Ae={style:{"margin-top":"10px"}},Be=E({name:"system-menu"}),Oe=E(B(A({},Be),{setup(s){const i=l(""),r=Ie(),n=l(),k=l(""),T=l(""),f=l(""),D=l(),d=l(),o=l([]),b=l(""),R=l(""),F=l(!1),_=l(""),v=l(),M=l(),L=l(!1),S=l(""),w=ue(),g=l(!1);function H(e){e.key==="createFolder"?d.value.addFolder(n.value):e.key==="createLinkFile"?M.value.addLink(u(n)):D.value.add({firstPid:k.value,pid:n.value,fileName:o.value,firstTitle:f.value})}function K(e){u(_)||u(g)?ke({parentId:e.pid}).then(t=>{if(t.success&&t.result.length>0){let a=[];f.value=t.result[0].fileName,n.value=t.result[0].fileId,k.value=t.result[0].fileId,T.value=t.result[0].fileName;for(let m=1;m<t.result.length;m++)a.push({title:t.result[m].fileName,key:t.result[m].fileId});e.titleData&&a.push(e.titleData[0]),o.value=a,u(g)||v.value.updateFileType(u(n)),g.value=!1}}):(o.value=e.titleData,n.value=e.parentId)}function U(e){v.value.updateKeyWord(),ve(()=>{if(e=="all")v.value.updatePlaceholder("在“"+u(f)+"”中搜索"),o.value=[],n.value=k.value;else{const t=l([]);n.value=e.key;for(let a=0;a<o.value.length;a++){if(e.key==o.value[a].key){t.value.push({key:o.value[a].key,title:o.value[a].title});break}t.value.push({key:o.value[a].key,title:o.value[a].title})}o.value=t.value,v.value.updatePlaceholder("在“"+e.title+"”中搜索")}_.value="",u(F)?d.value.loadRecycleFileList({fileId:u(n)}):(d.value.loadFileList({pid:n.value,firstPid:k.value,fileName:o.value,firstTitle:f.value,type:e==="all"?b.value:"",authority:u(i)}),F.value=!1)})}function $(e){k.value=e.firstId,T.value=e.fileName,f.value=e.fileName,n.value=e.parentId,o.value=[],F.value=!1,b.value=e.type,S.value=e.leftType,_.value="",L.value=!1,Fe({fileId:e.firstId,userId:r.getUserInfo.id}).then(t=>{t.success&&(i.value=t.result,d.value.loadFileList({pid:n.value,firstPid:k.value,fileName:o.value,firstTitle:f.value,type:e.type,authority:t.result,isShare:u(g)}),v.value.clearIds())})}function j(e){R.value=e.fileId,f.value=e.recycleName,F.value=!0,d.value.loadRecycleFileList({fileId:R.value})}function qe(){d.value.loadRecycleFileList({fileId:R.value})}function G(e){e&&d.value.uploadFileList()}function J(){d.value.uploadFileList()}function Q(e){_.value=e,d.value.searchList(e,u(n)),e||(L.value=!1)}function X(e){v.value.updatePlaceholder("在“"+e+"”中搜索"),v.value.updateKeyWord(),L.value=!1,_.value=""}function Y(){u(_)&&(f.value=u(T)),d.value.searchAllList(u(_)),L.value=!0}function Z(e,t,a){e&&t&&(n.value=e,k.value=t,g.value=!0),v.value.setFileType(t,a,e)}return re(()=>{const e=w.currentRoute.value.query.parentId,t=w.currentRoute.value.query.rootId,a=w.currentRoute.value.query.tenantId;Z(e,t,a)}),(e,t)=>{const a=C("a-button"),m=C("a-menu-item"),ee=C("a-menu-divider"),te=C("a-menu"),le=C("a-dropdown");return y(),h(O,null,[c("div",ge,[c("div",Ce,[p(ye,{ref_key:"leftFileRef",ref:v,onClickFileType:$,onRecycleUploadList:j,onSearchList:Q},null,512)]),c("div",Ne,[L.value?(y(),h("div",Pe,be)):(y(),h("div",Te,[c("span",{class:"pointer title-hover",onClick:t[0]||(t[0]=x=>U("all"))},P(f.value),1),F.value?(y(),h("span",we,"/回收站")):(y(!0),h(O,{key:0},ce(o.value,x=>(y(),h("span",null,[Re,c("span",{class:"pointer title-hover",onClick:We=>U(x)},P(x.title),9,Se)]))),256)),_.value?(y(),h("span",xe,[q("  中的搜索结果 "),c("a",{class:"global-search",style:{color:"#1e88e5"},onClick:Y},"  "+P(F.value?"全部已删除的文件和文件夹":"搜索整个知识中心"),1)])):W("",!0)])),!F.value&&i.value!=="readonly"&&S.value!=="used"&&S.value!=="star"?(y(),h("div",Me,[p(le,{trigger:["click"]},{overlay:I(()=>[p(te,{onClick:H},{default:I(()=>[p(m,{key:"uploadLocal"},{default:I(()=>[Ue]),_:1}),p(m,{key:"createLinkFile"},{default:I(()=>[Ve]),_:1}),p(m,{key:"createFolder"},{default:I(()=>[ze]),_:1}),p(ee)]),_:1})]),default:I(()=>[p(a,{preIcon:"ant-design:plus-outlined",onClick:t[1]||(t[1]=de(()=>{},["prevent"])),class:"add"},{default:I(()=>[q("添加")]),_:1})]),_:1})])):W("",!0)]),c("div",Ae,[p(he,{ref_key:"rightFileRef",ref:d,onSetTitleData:K,onUpdateInput:X},null,512)])]),p(_e,{ref_key:"registerModal",ref:D,onOk:G},null,512),p(me,{ref_key:"fileLinkModal",ref:M,onOk:J},null,512)],64)}}}));const ht=Le(Oe,[["__scopeId","data-v-491970e4"]]);export{ht as default};
