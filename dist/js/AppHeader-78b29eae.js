var g=(o,s,l)=>new Promise((_,A)=>{var h=n=>{try{r(l.next(n))}catch(m){A(m)}},u=n=>{try{r(l.throw(n))}catch(m){A(m)}},r=n=>n.done?_(n.value):Promise.resolve(n.value).then(h,u);r((l=l.apply(o,s)).next())});import J from"./BackIndex-47cd6641.js";import{R as j,e as w,a as P,l as q}from"./index-831af9dd.js";import K from"./AppActionSelect-b7bf99c4.js";import Q from"./AppNote-078d7e26.js";import X from"./AppInfoUpdateModal-dfe18a48.js";import{C as Y,u as Z}from"./CommonUserMenu-1452597c.js";import{bW as x,aS as oo}from"./antd-vue-vendor-0d72f01e.js";import{d as eo,f as b,r as to,h as po,a2 as no,a3 as ao,a4 as io,a5 as i,V as p,a6 as c,a7 as d,F as so,k as a,ai as ro,ak as mo,W as f,O as lo,af as uo}from"./vue-vendor-24c7dc61.js";import{u as co}from"./lowAppAuth-3d637b7d.js";import fo from"./AppMaintainSetModal-aee921bd.js";import"./index-1c3affea.js";import Ao from"./AppDictDrawer-1f691471.js";import{u as go}from"./index-44229d9b.js";import _o from"./AppDeleteConfirm-a0947474.js";import{f as ho}from"./low.app.api-97fc250a.js";import Mo from"./AppBackupConfirm-c4a19257.js";import wo from"./AppBackupListModal-42af6e7c.js";import{g as ko}from"./VipPay.api-469f07f9.js";import"./useCooperationPage-7c852af8.js";import"./index-b510c86d.js";import"./vxe-table-vendor-8813019a.js";import"./JEditor-249b2194.js";import"./index-b845562c.js";import"./AppIconSelector-c6c055a9.js";import"./HeaderUserIcon-36774302.js";import"./useAppTheme-3409245c.js";import"./useUndeveloped-598c4bd7.js";import"./lowAppUtils-56892d30.js";import"./BasicModal-58413bab.js";import"./useWindowSizeFn-8f085f6f.js";import"./AppDictAddModal-6b1fc137.js";import"./BasicTable-d435f501.js";import"./index-52c8c841.js";import"./useForm-14b2bc77.js";import"./componentMap-c857637c.js";import"./useFormItem-86503382.js";import"./download-1ac6acce.js";import"./index-f99b266a.js";import"./JSelectUser-a44af43a.js";import"./useSelectBiz-2f560b0b.js";import"./props-8a7ac45b.js";import"./JSelectBiz-55a9591f.js";import"./JImageUpload-d644253a.js";import"./JDictSelectTag-54dc3bdb.js";import"./JSelectDept-a90caee3.js";import"./index-f2fd5a28.js";import"./useContextMenu-810f9346.js";import"./areaDataUtil-cdeee717.js";import"./china-area-data-vendor-556d14ee.js";import"./JPopup-2a779923.js";import"./useMethods-f689b480.js";import"./JCheckbox-0b89d32a.js";import"./JSelectUserByDept-bd619076.js";import"./UserSelectByDepModal-db060ece.js";import"./depart.api-339f4da6.js";import"./JUpload-76e119c7.js";import"./index-d508f1f4.js";import"./index-6507b9cd.js";import"./index-4d0525a5.js";import"./UserSelectModal-d78c1490.js";import"./helper-22dafba0.js";import"./JAreaLinkage-173780c9.js";import"./JCodeEditor-66bd225e.js";import"./codemirror-17b6f671.js";import"./codemirror-26b29690.js";import"./active-line-512fef49.js";import"./EasyCronInput-b2123242.js";import"./DictColors-73058d23.js";import"./index-621e597c.js";import"./useListPage-62a041ef.js";const Io=eo({name:"AppHeader",components:{BackIndex:J,Icon:j,AppActionSelect:K,AppNote:Q,AppInfoUpdateModal:X,CommonUserMenu:Y,ThunderboltOutlined:x,TeamOutlined:oo,AppMaintainSetModal:fo,AppDictDrawer:Ao,AppDeleteConfirm:_o,AppBackupConfirm:Mo,AppBackupListModal:wo},props:{info:{type:Object,default:()=>{}},noAuth:{type:Boolean,default:!1}},setup(o){const[s,{openModal:l}]=w(),[_,{openDrawer:A}]=go(),h=co(),u=b(!1),r=b(!1),n=b(),{pageJump:m}=Z(),t=to({id:"",appName:"",iconType:"",iconBackColor:"",appNote:"",maintStatus:0,maintNote:"",openStatus:1,appCoverImg:""});po(()=>{o.info&&o.info.id&&(Object.keys(t).map(e=>{t[e]=o.info[e]}),u.value=h.getLowAppAdminAuth())});const[k,{openModal:I}]=w(),[v,{openModal:S}]=w(),[N,{openModal:C}]=w();function D(e){return g(this,null,function*(){m(e,"workflow")})}function y(e){return g(this,null,function*(){m(e,"permission")})}function M(e){if((e==="manage_copy"||e==="manage_camera"||e==="manage_back")&&!ko()){B.warning("您还不是会员，请升级会员后再次重试");return}e==="update"?r.value=!0:e==="note"?n.value.openNoteModal():e==="maintain"?l(!0,{id:t.id,status:t.maintStatus,note:t.maintNote}):e==="dict"?A(!0,{lowAppId:t.id}):e==="manage_delete"?$():e==="manage_copy"?G():e==="manage_camera"?W():e==="manage_back"&&C(!0,{appId:t.id})}function R(e){t.appName=e.appName,t.iconType=e.iconType}function O(e){t.appNote=e}function T(e){t.maintNote=e.maintNote,t.maintStatus=e.maintStatus}function L(){return t.openStatus===0?!1:u.value===!0?!0:!(t.maintStatus==1||o.noAuth===!0)}const V=no();function $(){I(!0,{appId:t.id,appName:t.appName})}function E(){const e="/myapps/index";V.replace({path:e})}const{createInfoModal:F,createMessage:B}=P();function G(){let e=`复制应用“${t.appName}”`;F({title:e,content:"将复制目标应用的应用结构、流程和角色。应用下的数据和成员不会被复制",width:480,okText:"复制",cancelText:"取消",okCancel:!0,onOk:function(){H()},onCancel:function(){}})}function H(){return g(this,null,function*(){const e=yield ho.copy({id:t.id});B.success("复制成功!")})}function W(){S(!0,{appId:t.id,appName:t.appName})}function z(){return g(this,null,function*(){B.success("备份成功!")})}return{lowAppInfo:t,appInfoUpdateVisible:r,updateAppInfo:R,onAppActionChange:M,goWorkFlowList:D,appNoteRef:n,updateAppNote:O,goUserApplication:y,hasAdminAuth:u,registerMaintainModal:s,updateAppMaintStatus:T,showGroup:L,registerDrawer:_,registerDeleteModal:k,deleteOk:E,registerBackupModal:v,backupOk:z,registerBackupListModal:N}}});const U=o=>(ao("data-v-1d32f099"),o=o(),io(),o),vo={class:"app-info"},So={class:"icon"},No={class:"name ellipsis"},Co={key:0,class:"low-app-maintaining"},Do={key:1},yo={key:0,class:"app-group"},Bo=U(()=>i("div",{class:"dont-know-what"},[i("div",{class:"left"}),i("div",{class:"right"})],-1)),bo={key:1,class:"app-workflow"},Uo={key:0},Ro=U(()=>i("span",{class:"label"}," 用户 ",-1)),Oo=U(()=>i("div",null,null,-1));function To(o,s,l,_,A,h){const u=p("back-index"),r=p("Icon"),n=p("AppActionSelect"),m=p("AppNote"),t=p("AppInfoUpdateModal"),k=p("TeamOutlined"),I=p("common-user-menu"),v=p("a-layout-header"),S=p("AppMaintainSetModal"),N=p("AppDictDrawer"),C=p("AppDeleteConfirm"),D=p("AppBackupConfirm"),y=p("AppBackupListModal");return c(),d(so,null,[a(v,{class:"app-index-header",theme:"light"},{default:ro(()=>[a(u),i("div",vo,[i("div",So,[a(r,{icon:o.lowAppInfo.iconType,style:{color:"#fff","font-size":"24px"}},null,8,["icon"])]),i("div",No,mo(o.lowAppInfo.appName),1),o.lowAppInfo.maintStatus==1?(c(),d("div",Co,"维护中")):f("",!0),o.hasAdminAuth&&o.lowAppInfo.openStatus===1?(c(),d("div",Do,[a(n,{onAction:o.onAppActionChange},null,8,["onAction"])])):f("",!0),i("div",null,[a(m,{ref:"appNoteRef",hasAdminAuth:o.hasAdminAuth,appId:o.lowAppInfo.id,note:o.lowAppInfo.appNote,onSave:o.updateAppNote},null,8,["hasAdminAuth","appId","note","onSave"])]),a(t,{visible:o.appInfoUpdateVisible,info:o.lowAppInfo,onUpdate:o.updateAppInfo,onDbUpdate:s[0]||(s[0]=M=>o.appInfoUpdateVisible=!1)},null,8,["visible","info","onUpdate"])]),o.showGroup()?(c(),d("div",yo,[lo(o.$slots,"groupMenu",{},void 0,!0)])):f("",!0),Bo,o.showGroup()?(c(),d("div",bo,[o.hasAdminAuth?(c(),d("div",Uo,[i("div",{class:"item",onClick:s[1]||(s[1]=(...M)=>o.goUserApplication&&o.goUserApplication(...M))},[a(k),Ro])])):f("",!0)])):f("",!0),i("div",null,[o.showGroup()?(c(),uo(I,{key:0})):f("",!0)]),Oo]),_:3}),a(S,{onRegister:o.registerMaintainModal,onUpdate:o.updateAppMaintStatus},null,8,["onRegister","onUpdate"]),a(N,{onRegister:o.registerDrawer},null,8,["onRegister"]),a(C,{onRegister:o.registerDeleteModal,onSuccess:o.deleteOk},null,8,["onRegister","onSuccess"]),a(D,{onRegister:o.registerBackupModal,onSuccess:o.backupOk},null,8,["onRegister","onSuccess"]),a(y,{onRegister:o.registerBackupListModal},null,8,["onRegister"])],64)}const Ze=q(Io,[["render",To],["__scopeId","data-v-1d32f099"]]);export{Ze as default};
