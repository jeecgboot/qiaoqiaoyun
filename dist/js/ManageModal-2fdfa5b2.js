var le=Object.defineProperty;var q=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var $=(u,i,s)=>i in u?le(u,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):u[i]=s,W=(u,i)=>{for(var s in i||(i={}))se.call(i,s)&&$(u,s,i[s]);if(q)for(var s of q(i))re.call(i,s)&&$(u,s,i[s]);return u};var y=(u,i,s)=>new Promise((v,f)=>{var b=t=>{try{S(s.next(t))}catch(h){f(h)}},e=t=>{try{S(s.throw(t))}catch(h){f(h)}},S=t=>t.done?v(t.value):Promise.resolve(t.value).then(b,e);S((s=s.apply(u,i)).next())});import{d as N,f as R,e as J,r as P,w as ie,n as Q,V as g,a6 as x,a7 as G,a5 as I,k as l,u as w,af as E,W as F,ai as c,E as B,ak as L,ae as ce,a3 as ue,a4 as de,a2 as pe,ag as me,I as fe}from"./vue-vendor-24c7dc61.js";import{B as _e}from"./index-1c3affea.js";import"./index-52c8c841.js";import ge from"./MeetRoomSelect-1395272c.js";import{r as ve,i as he,F as we}from"./fullcalendar-vendor-e153c929.js";import{q as ye}from"./room.data-cba2a619.js";import{q as be,g as Se,a as Ce,s as ke}from"./manage.api-62536fbe.js";import{e as xe,aS as H,l as Me,a as Te,j as Ue}from"./index-831af9dd.js";import{f as Re}from"./manage.data-9b48f59f.js";import{p as Ie}from"./antd-vue-vendor-0d72f01e.js";import{u as ze,B as Ve}from"./useForm-14b2bc77.js";const X=u=>(ue("data-v-ef455a73"),u=u(),de(),u),De={style:{margin:"0 auto"},class:"calendar-div"},Ee={key:0},Be=X(()=>I("br",null,null,-1)),Fe=X(()=>I("br",null,null,-1)),Oe=N({__name:"MeetCalendarUse",props:{adleEdit:{type:Boolean,default:!0}},emits:["change","reloadTable"],setup(u,{expose:i,emit:s}){const v=u,[f,{openModal:b}]=xe(),e=R([ve,he]),S=J(()=>({resourceAreaHeaderContent:"会议室",resourceAreaWidth:"20%",height:"auto",contentHeight:"50",locale:"zh-cn",selectable:!0,plugins:e.value,weekNumberCalculation:"ISO",selectAllow:t.handlerSelectAllow,firstDay:0,schedulerLicenseKey:"GPL-My-Project-Is-Open-Source",aspectRatio:1.65,headerToolbar:{left:"prev,next,today",center:"title",right:"resourceTimelineMonth,resourceTimelineWeek,resourceTimelineDay"},initialView:"resourceTimelineMonth",buttonText:{today:"今天",resourceTimelineMonth:"月",resourceTimelineWeek:"周",resourceTimelineDay:"日"},resources:t.resources,events:t.calendarEventsNew,eventClick:k,eventMouseEnter:D,eventMouseLeave:O,slotEventOverlap:!1})),t=P({visible:!0,showBox:!1,tranLeft:0,tranTop:0,eventDataSource:[],eventMaps:{},item:{},eventLimitClick:"resourceTimelineDay",handlerSelectAllow:n=>{const _=new Date,o=n.start,a=n.end,p=t.currentView=="resourceTimelineDay";return o<=a&&o>=_&&p&&v.adleEdit},resources:[],calendarEventsNew:[]});ie(()=>t.resources,n=>{s("change",n)});function h(n,_){return y(this,null,function*(){let o=yield ye({departId:n,nullFlag:_});if(o.success){let a=[];if(o.result!=null)for(let p of o.result){let U={id:p.id,title:p.name};a.push(U)}t.resources=a,M()}})}function M(){return y(this,null,function*(){let n=yield be();if(n.success){let _={};t.eventDataSource=n.result,n.result.forEach(o=>_[o.id]=o),t.eventMaps=_,T()}})}function z(){return y(this,null,function*(){yield M(),s("reloadTable")})}function T(n){t.calendarEventsNew=t.eventDataSource.map(_=>{let{id:o,name:a,beginTime:p,endTime:U,location:C}=_;return{id:o,title:a,resourceId:C,start:p,end:U,backgroundColor:"#6f66f6"}})}function r(n){t.currentView=n.view.type}function d(n){}function k(n){v.adleEdit&&b(!0,{isUpdate:!0,id:n.event.id})}function V(n){v.adleEdit}function D(n){setTimeout(()=>{Q(()=>{t.visible=!0,t.tranLeft=n.jsEvent.pageX-490+"px",t.tranTop=n.jsEvent.pageY-155+"px",t.item=n.event,t.showBox=!0})},500)}function O(n){t.showBox=!1}return i({loadRoom:h}),(n,_)=>{const o=g("a-empty"),a=g("a-tooltip");return x(),G("div",null,[I("div",De,[l(w(we),{ref:"baseCalendar",options:S.value,onSelect:V},null,8,["options"]),t.resources.length==0?(x(),E(o,{key:0,style:{"margin-top":"10px"}})):F("",!0)]),t.showBox?(x(),G("div",Ee,[I("div",{class:"show-parent",style:ce({left:t.tranLeft,top:t.tranTop})},[l(a,{open:t.visible,"onUpdate:open":_[0]||(_[0]=p=>t.visible=p),placement:"top"},{title:c(()=>[B(L(t.item.title),1),Be,B(" "+L(w(H)(t.item.start)),1),Fe,B(" "+L(w(H)(t.item.end)),1)]),_:1},8,["open"])],4)])):F("",!0),l(ee,{onRegister:w(f),onSuccess:z},null,8,["onRegister"])])}}});const Y=Me(Oe,[["__scopeId","data-v-ef455a73"]]),Xe=Object.freeze(Object.defineProperty({__proto__:null,default:Y},Symbol.toStringTag,{value:"Module"})),Z=N({__name:"MeetRoomUseModal",setup(u,{expose:i}){const s=Te(),v=[{title:"会议名称",align:"center",dataIndex:"name"},{title:"召集人",align:"center",dataIndex:"originator_dictText"},{title:"位置",align:"center",dataIndex:"location_dictText"},{title:"开始时间",align:"center",dataIndex:"beginTime"},{title:"结束时间",align:"center",dataIndex:"endTime"},{title:"状态",align:"center",dataIndex:"status_dictText"}],f=R(!1),b=R(null),e=P({loading:!1,resourceIsNull:!0,dataSource:[],ipagination:{current:1,pageSize:10,pageSizeOptions:["10","20","30"],showTotal:(r,d)=>d[0]+"-"+d[1]+" 共"+r+"条",showQuickJumper:!0,showSizeChanger:!0,total:0},selectedRowKeys:[],selectionRows:[]});function S(){return y(this,null,function*(){t(),T(b).then(r=>{r.value.loadRoom()}),f.value=!0})}function t(){return y(this,null,function*(){let r={};r.pageNo=e.ipagination.current,r.pageSize=e.ipagination.pageSize,e.loading=!0;let d=yield Se(r);e.loading=!1,d&&d.records?(e.dataSource=d.records,e.ipagination.total=d.total):s.warning(res.message)})}function h(){f.value=!1}function M(r,d){e.selectedRowKeys=r,e.selectionRows=d}function z(r){r!=null&&r.length>0?e.resourceIsNull=!1:e.resourceIsNull=!0}function T(r){return new Promise(d=>{(function k(){r.value?d(r):Q(()=>k())})()})}return i({show:S}),(r,d)=>{const k=g("a-table"),V=g("a-card"),D=g("a-modal");return x(),E(D,{title:"会议使用情况",width:1e3,open:f.value,onCancel:h,footer:null,cancelText:"关闭"},{default:c(()=>[l(V,{bordered:!1},{default:c(()=>[l(Y,{ref_key:"calendarUser",ref:b,onChange:z},null,512),e.resourceIsNull?F("",!0):(x(),E(k,{key:0,ref:"table",size:"middle",rowKey:"id",columns:v,dataSource:e.dataSource,pagination:e.ipagination,loading:e.loading,rowSelection:{selectedRowKeys:e.selectedRowKeys,onChange:M}},null,8,["dataSource","pagination","loading","rowSelection"]))]),_:1})]),_:1},8,["open"])}}}),Ye=Object.freeze(Object.defineProperty({__proto__:null,default:Z},Symbol.toStringTag,{value:"Module"})),je=I("span",{style:{"margin-left":"10px",color:"red","font-size":"14px"}},"注：字体最小值为24",-1),ee=N({__name:"ManageModal",emits:["register","success"],setup(u,{emit:i}){const s=pe(),v=R(!0),f=R("1"),b=R(null),e=P({bgColor:"#006699",bgImg:"",fontColor:"#FFFFFF",fontSize:24,showAvatar:"",showDepart:"",showSign:""}),[S,{resetFields:t,setFieldsValue:h,getFieldsValue:M,validate:z,clearValidate:T}]=ze({schemas:Re,showActionButtonGroup:!1,baseColProps:{lg:12,md:24}}),[r,{setModalProps:d,closeModal:k}]=Ue(o=>y(this,null,function*(){if(yield t(),d({confirmLoading:!1}),v.value=!!(o!=null&&o.isUpdate),h({approvalStatus:"0"}),w(v)){let a=yield Ce({id:o.id});if(a.success){let p=a.result;yield h(W({},p)),Object.assign(e,Ie(p,["bgColor","fontColor","fontSize"]))}T()}})),V=J(()=>w(v)?"编辑":"新增");function D(o,a){return y(this,null,function*(){h({location:o,approvalStatus:a}),T(["location","customLocation"])})}function O(){return y(this,null,function*(){try{let o=yield z(),a=Object.assign(o,fe(e));d({confirmLoading:!0}),yield ke(a,w(v)),k(),i("success")}catch(o){f.value="1"}finally{d({confirmLoading:!1})}})}function n(){return y(this,null,function*(){let o=e.fontSize,a=M(),p=s.resolve({path:"/meet/signPreview",query:{bgColor:e.bgColor,fontColor:e.fontColor,fontSize:o,id:a.id}});window.open(p.href,"_blank")})}function _(){b.value.show()}return(o,a)=>{const p=g("a-tab-pane"),U=g("a-input"),C=g("a-form-item"),A=g("a-input-number"),j=g("a-switch"),te=g("a-form"),ae=g("a-tabs"),oe=g("a-button");return x(),E(w(_e),me(o.$attrs,{onRegister:w(r),title:V.value,onOk:O,width:"1200px"}),{centerFooter:c(()=>[f.value=="2"?(x(),E(oe,{key:0,type:"primary",onClick:n,style:{"margin-right":"5px"}},{default:c(()=>[B("签到预览")]),_:1})):F("",!0)]),default:c(()=>[l(ae,{activeKey:f.value,"onUpdate:activeKey":a[6]||(a[6]=m=>f.value=m)},{default:c(()=>[l(p,{tab:"基本信息",key:"1"},{default:c(()=>[l(w(Ve),{onRegister:w(S)},{meetUse:c(()=>[I("a",{style:{color:"#19a5ff","margin-left":"50px"},onClick:_},"会议室使用情况")]),location:c(({model:m,field:K})=>[l(ge,{multi:!1,value:m[K],"onUpdate:value":ne=>m[K]=ne,onChange:D},null,8,["value","onUpdate:value"])]),_:1},8,["onRegister"])]),_:1}),l(p,{tab:"签到信息",key:"2"},{default:c(()=>[l(te,{model:e,"label-col":{xs:{span:24},sm:{span:5}},"wrapper-col":{xs:{span:24},sm:{span:16}}},{default:c(()=>[l(C,{label:"背景颜色","wrapper-col":{xs:{span:24},sm:{span:8}}},{default:c(()=>[l(U,{value:e.bgColor,"onUpdate:value":a[0]||(a[0]=m=>e.bgColor=m)},null,8,["value"])]),_:1}),l(C,{label:"字体颜色","wrapper-col":{xs:{span:24},sm:{span:8}}},{default:c(()=>[l(U,{value:e.fontColor,"onUpdate:value":a[1]||(a[1]=m=>e.fontColor=m)},null,8,["value"])]),_:1}),l(C,{label:"字体大小"},{default:c(()=>[l(A,{placeholder:"请输入字体大小",value:e.fontSize,"onUpdate:value":a[2]||(a[2]=m=>e.fontSize=m),min:24,max:100,precision:0,style:{width:"150px"}},null,8,["value"]),je]),_:1}),l(C,{label:"显示头像"},{default:c(()=>[l(j,{checked:e.showAvatar,"onUpdate:checked":a[3]||(a[3]=m=>e.showAvatar=m),unCheckedValue:"0",checkedValue:"1"},null,8,["checked"])]),_:1}),l(C,{label:"显示部门"},{default:c(()=>[l(j,{checked:e.showDepart,"onUpdate:checked":a[4]||(a[4]=m=>e.showDepart=m),unCheckedValue:"0",checkedValue:"1"},null,8,["checked"])]),_:1}),l(C,{label:"显示签到信息"},{default:c(()=>[l(j,{checked:e.showSign,"onUpdate:checked":a[5]||(a[5]=m=>e.showSign=m),unCheckedValue:"0",checkedValue:"1"},null,8,["checked"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["activeKey"]),l(Z,{ref_key:"roomUse",ref:b},null,512)]),_:1},16,["onRegister","title"])}}}),Ze=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));export{Y as M,ee as _,Xe as a,Ye as b,Ze as c};
