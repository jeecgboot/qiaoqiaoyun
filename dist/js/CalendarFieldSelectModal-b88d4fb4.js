var v=(i,r,s)=>new Promise((d,c)=>{var f=t=>{try{l(s.next(t))}catch(p){c(p)}},n=t=>{try{l(s.throw(t))}catch(p){c(p)}},l=t=>t.done?d(t.value):Promise.resolve(t.value).then(f,n);l((s=s.apply(i,r)).next())});import{j as O,a as k,k as F,l as S}from"./index-831af9dd.js";import{B as V}from"./index-1c3affea.js";import{bJ as L,aC as R,a$ as b}from"./antd-vue-vendor-0d72f01e.js";import{d as $,f as u,a5 as a,V as h,a6 as D,af as A,ai as y,k as B}from"./vue-vendor-24c7dc61.js";import T from"./CalendarFieldSelect-832a62ad.js";import"./vxe-table-vendor-8813019a.js";import"./BasicModal-58413bab.js";import"./useWindowSizeFn-8f085f6f.js";import"./type.definition-4eb605ee.js";const z=$({name:"CalendarFieldSelectModal",components:{BasicModal:V,CalendarOutlined:L,PlusOutlined:R,DeleteOutlined:b,CalendarFieldSelect:T},emits:["register","select"],setup(i,{emit:r}){const s=u(""),d=u(),c=u([]),f=u(),n=u(""),{createMessage:l}=k(),t=u(""),[p,{closeModal:w}]=O(e=>v(this,null,function*(){s.value=e.code,d.value=e.columnList,n.value=e.id||"",C()}));function C(){let o=d.value.filter(m=>m.isTitle===!0);o&&o.length>0&&(t.value=o[0].model)}function x(){return v(this,null,function*(){let e=f.value.getData();if((e==null?void 0:e.length)==0){l.warn("未选择日期字段，无法创建该视图！");return}if((e==null?void 0:e.length)==1&&!e[0].beginDateField){l.warn("未选择日期字段，无法创建该视图！");return}n.value?E(e):M(e)})}function E(e){let o=n.value;const m="/desform/view/updateViewConfig";let _={id:o,type:"calendar",titleField:t.value,calendarColumnList:e};F.put({url:m,params:_},{isTransformResponse:!1}).then(g=>{g.success&&(r("select",o),w())})}function M(e){return v(this,null,function*(){const o="/desform/view/addView";let m={type:"calendar",titleField:t.value,code:s.value,calendarColumnList:e},_=yield F.post({url:o,params:m},{isTransformResponse:!1});if(_.success){let g=_.result;r("select",g),w()}})}return{registerModal:p,designFormCode:s,handleOk:x,columnList:d,fieldSelectRef:f,selectedList:c}}}),I={style:{display:"flex","flex-direction":"row",color:"rgb(51, 51, 51)"}},N={style:{width:"97px",padding:"0px 24px 0px 16px"}},j={style:{display:"inline-block",width:"100%"}},H=a("div",{style:{flex:"1",display:"flex","flex-direction":"column"}},[a("div",null,"日历视图"),a("div",{style:{"font-size":"14px","margin-top":"10px","font-weight":"normal"}}," 选择一个日期类型的字段，数据将按照此字段中的日期显示在日历上。 ")],-1),J={style:{width:"100%"}};function P(i,r,s,d,c,f){const n=h("CalendarOutlined"),l=h("CalendarFieldSelect"),t=h("BasicModal");return D(),A(t,{onRegister:i.registerModal,width:600,canFullscreen:!1,destroyOnClose:"",closable:!1,onOk:i.handleOk},{title:y(()=>[a("div",I,[a("div",N,[a("span",j,[B(n,{style:{color:"#f54081","font-size":"50px"}})])]),H])]),default:y(()=>[a("div",J,[B(l,{ref:"fieldSelectRef",columnList:i.columnList,selectedList:i.selectedList},null,8,["columnList","selectedList"])])]),_:1},8,["onRegister","onOk"])}const te=S(z,[["render",P]]);export{te as default};
