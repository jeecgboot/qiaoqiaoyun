var k=(r,u,f)=>new Promise((L,g)=>{var E=m=>{try{b(f.next(m))}catch(y){g(y)}},U=m=>{try{b(f.throw(m))}catch(y){g(y)}},b=m=>m.done?L(m.value):Promise.resolve(m.value).then(E,U);b((f=f.apply(r,u)).next())});import{k as P,Z as x,ax as j,_ as D,O as w,l as ne}from"./index-831af9dd.js";import{d as ae,f as M,r as oe,e as F,u as i,V as d,a6 as C,af as I,ai as t,k as l,E as _,W as V,ag as S,a7 as se,am as re,ak as ie,F as ue}from"./vue-vendor-24c7dc61.js";import{B as pe}from"./BasicModal-58413bab.js";import{M as de}from"./antd-vue-vendor-0d72f01e.js";import{C as me}from"./CommentPanel-4027e3d7.js";const je=[{title:"标题",dataIndex:"title"},{title:"开始时间",dataIndex:"startTime"},{title:"结束时间",dataIndex:"endTime"},{title:"类型",dataIndex:"type_dictText"},{title:"是否全天",dataIndex:"allDay_dictText"},{title:"紧急程度",dataIndex:"urgentLevel_dictText"},{title:"提醒类型",align:"center",dataIndex:"remindType",customRender:({text:r})=>{if(r&&r.length>0)return r.split(",").map(u=>u==="1"?"邮件":u==="2"?"短信":u==="4"?"系统消息":u).join(" | ")}},{title:"状态",align:"center",dataIndex:"status_dictText"}],Me=[{field:"title",label:"标题",component:"Input",colProps:{span:6}},{field:"status",label:"状态",component:"JDictSelectTag",componentProps:{dictCode:"eoa_plan_status",placeholder:"请选择状态"},colProps:{span:6}},{field:"type",label:"类型",component:"JDictSelectTag",componentProps:{dictCode:"eoa_plan_type",placeholder:"请选择类型"},colProps:{span:6}},{field:"remindType",label:"提醒类型",component:"Input",slot:"remindType",colProps:{span:6}}],ce=[{key:"薄暮",color:"#F5222D"},{key:"火山",color:"#FA541C"},{key:"日暮",color:"#FAAD14"},{key:"明青",color:"#13C2C2"},{key:"极光绿",color:"#52C41A"},{key:"拂晓蓝（默认）",color:"#1890FF"},{key:"极客蓝",color:"#2F54EB"},{key:"酱紫",color:"#722ED1"}];const Ie="/eoa/plan/exportXls",Le="/eoa/plan/importExcel";const _e=r=>P.get({url:"/eoa/plan/queryById",params:r}),fe=(r,u)=>P.delete({url:"/eoa/plan/delete",params:r},{joinParamsToUrl:!0}).then(()=>{u()}),Ee=(r,u)=>{de.confirm({title:"确认删除",content:"是否删除选中数据",okText:"确认",cancelText:"取消",onOk:()=>P.delete({url:"/eoa/plan/deleteBatch",data:r},{joinParamsToUrl:!0}).then(()=>{u()})})},ye=(r,u)=>{let f=u?"/eoa/plan/edit":"/eoa/plan/add";return P.post({url:f,params:r})},Ue=r=>P.get({url:"/eoa/plan/myPlanlist",params:r});const Be=r=>P.get({url:"/eoa/plan/getPlanList",params:r},{isTransformResponse:!1}),he=r=>P.get({url:"/eoa/plan/getPlanListByPage",params:r},{isTransformResponse:!1}),ve=ae({__name:"PlanModal",emits:["success","register"],setup(r,{expose:u,emit:f}){const L=x(()=>D(()=>import("./JCheckbox-0b89d32a.js"),["js/JCheckbox-0b89d32a.js","js/vue-vendor-24c7dc61.js","js/index-831af9dd.js","js/antd-vue-vendor-0d72f01e.js","js/vxe-table-vendor-8813019a.js","assets/index-3d0fbd8d.css","assets/JCheckbox-ce9c44dd.css"])),g=x(()=>D(()=>import("./JDictSelectTag-54dc3bdb.js").then(e=>e.a),["js/JDictSelectTag-54dc3bdb.js","js/vue-vendor-24c7dc61.js","js/index-831af9dd.js","js/antd-vue-vendor-0d72f01e.js","js/vxe-table-vendor-8813019a.js","assets/index-3d0fbd8d.css","js/useFormItem-86503382.js","assets/JDictSelectTag-72919d86.css"])),E=x(()=>D(()=>import("./JSelectUserByDept-bd619076.js"),["js/JSelectUserByDept-bd619076.js","js/vue-vendor-24c7dc61.js","js/UserSelectByDepModal-db060ece.js","js/index-831af9dd.js","js/antd-vue-vendor-0d72f01e.js","js/vxe-table-vendor-8813019a.js","assets/index-3d0fbd8d.css","js/index-1c3affea.js","js/BasicModal-58413bab.js","js/useWindowSizeFn-8f085f6f.js","assets/BasicModal-d929f5ce.css","assets/index-ad7edbf1.css","js/index-f2fd5a28.js","js/useContextMenu-810f9346.js","assets/useContextMenu-aed8cfe5.css","assets/index-a95e0833.css","js/useSelectBiz-2f560b0b.js","js/depart.api-339f4da6.js","js/props-8a7ac45b.js","js/JSelectBiz-55a9591f.js","assets/JSelectBiz-ba37f0a8.css","js/useFormItem-86503382.js","assets/JSelectUserByDept-f5671717.css"])),U=x(()=>D(()=>import("./JEditor-249b2194.js"),["js/JEditor-249b2194.js","js/vue-vendor-24c7dc61.js","js/index-b845562c.js","js/index-831af9dd.js","js/antd-vue-vendor-0d72f01e.js","js/vxe-table-vendor-8813019a.js","assets/index-3d0fbd8d.css"])),b=x(()=>D(()=>import("./index-831af9dd.js").then(e=>e.d4),["js/index-831af9dd.js","js/vue-vendor-24c7dc61.js","js/antd-vue-vendor-0d72f01e.js","js/vxe-table-vendor-8813019a.js","assets/index-3d0fbd8d.css"])),m=M(),y=M(!1),B=M(!1),T=M(!0),J={title:[{required:!0,message:"请输入标题!"}],rangeTime:[{required:!0,message:"请选择时间!"}],remindType:[{required:!0,message:"请选择提醒类型!"}],reminders:[{required:!0,message:"请选择重复提醒!"}],remind:[{required:!0,message:"请选择提醒时间!"}],type:[{required:!0,message:"请选择日程类型!"}]},n=oe({id:null,title:"",type:"",remindType:[],urgentLevel:"",remind:"",reminders:"",rangeTime:[],allDay:"",joinPerson:"",planColor:"#1890FF",remark:""}),Y=F(()=>i(T)?"编辑计划":"新增计划"),O=F(()=>n.allDay=="1"),N=F(()=>({showTime:i(O)?!1:{format:"HH:mm",hideDisabledOptions:!0,defaultValue:[j("00:00:00","HH:mm:ss"),j("00:00:00","HH:mm:ss")]},disabledTime:()=>({disabledMinutes:()=>X(0,59).filter(e=>![0,15,30,45].includes(e))}),format:"YYYY-MM-DD"+(i(O)?"":" HH:mm")}));function X(e,o){const c=[];for(let v=e;v<=o;v++)c.push(v);return c}function $(){Object.assign(n,{id:null,title:"",type:"",remindType:[],urgentLevel:"",remind:"",reminders:"",rangeTime:[],allDay:"",joinPerson:"",planColor:"#1890FF",remark:""})}function z(){return k(this,null,function*(){B.value=!0,yield fe({id:n.id},h),B.value=!1})}function h(){y.value=!1,f("success")}function G(){return k(this,null,function*(){m.value.validate().then(()=>k(this,null,function*(){let e=Object.assign({},n),o=e.rangeTime.map(c=>c?c.format("YYYY-MM-DD HH:mm:ss"):null);e.startTime=o[0],e.endTime=o[1],e.allDay=e.allDay==="1"?"1":"0",e.remindType=e.remindType.join(","),e.joinPerson=e.joinPerson?e.joinPerson.join(","):"",yield ye(e,i(T)),h()})).catch(e=>{})})}function W(e){return k(this,null,function*(){var c,v;if($(),T.value=!!(e!=null&&e.isUpdate),i(T)){const a=yield _e({id:(c=e==null?void 0:e.record)==null?void 0:c.id});Object.assign(n,a),a!=null&&a.startTime&&(a!=null&&a.endTime)&&(n.rangeTime=[a==null?void 0:a.startTime,a==null?void 0:a.endTime].map(p=>p?j(p):null)),n.allDay=(a==null?void 0:a.allDay)==="1"?"1":"",n.remindType=a.remindType&&w(a.remindType)?a.remindType.split(","):[],n.joinPerson=a.joinPerson&&w(a.joinPerson)?a.joinPerson.split(","):[]}else{if(((v=e==null?void 0:e.view)==null?void 0:v.type)=="dayGridMonth"){var o=e.end/1e3;e.end=(o-86400)*1e3}n.allDay=e!=null&&e.allDay?"1":"",n.joinPerson=e.joinPerson&&w(e.joinPerson)?e.joinPerson.split(","):[],e!=null&&e.start&&(e!=null&&e.end)&&(n.rangeTime=[e==null?void 0:e.start,e==null?void 0:e.end].map(a=>a?j(a):null))}y.value=!0,i(m)&&setTimeout(()=>{m.value.clearValidate()},100)})}return u({show:W}),(e,o)=>{const c=d("a-divider"),v=d("a-input"),a=d("a-form-item"),p=d("a-col"),q=d("a-select-option"),Z=d("a-select"),A=d("a-range-picker"),R=d("a-row"),K=d("a-icon"),Q=d("a-tag"),ee=d("a-tooltip"),le=d("a-form"),H=d("a-button");return C(),I(pe,S({wrapClassName:"plan-modal"},e.$attrs,{"body-style":{padding:"0 30px 0 24px"},title:Y.value,width:1e3,visible:y.value,"onUpdate:visible":o[10]||(o[10]=s=>y.value=s),defaultFullscreen:T.value,enableComment:T.value}),{footer:t(()=>[l(H,{key:"back",onClick:h},{default:t(()=>[_("取消")]),_:1}),n.id?(C(),I(i(b),{key:0,type:"primary",danger:"",loading:B.value,title:"您确定要删除日程安排吗？",onConfirm:z,okText:"确定",cancelText:"取消"},{default:t(()=>[_("删除")]),_:1},8,["loading"])):V("",!0),l(H,{type:"primary",onClick:G},{default:t(()=>[_("确认")]),_:1})]),comment:t(()=>[l(me,{"table-name":"eoa_plan","data-id":n.id},null,8,["data-id"])]),default:t(()=>[l(le,{ref_key:"formEl",ref:m,model:n,"label-col":{xs:{span:24},sm:{span:5}},"wrapper-col":{xs:{span:24},sm:{span:18}},rules:J},{default:t(()=>[l(c,{orientation:"left",style:{"margin-bottom":"40px"}},{default:t(()=>[_("基本信息")]),_:1}),l(R,null,{default:t(()=>[l(p,{span:12},{default:t(()=>[l(a,{label:"日程标题",name:"title"},{default:t(()=>[l(v,{placeholder:"请输入标题",value:n.title,"onUpdate:value":o[0]||(o[0]=s=>n.title=s)},null,8,["value"])]),_:1})]),_:1}),l(p,{span:12},{default:t(()=>[l(a,{label:"日程类型",name:"type"},{default:t(()=>[l(i(g),{placeholder:"请选择类型",type:"select",value:n.type,"onUpdate:value":o[1]||(o[1]=s=>n.type=s),dictCode:"eoa_plan_type"},null,8,["value"])]),_:1})]),_:1}),l(p,{span:12},{default:t(()=>[l(a,{label:"提醒类型",name:"remindType"},{default:t(()=>[l(Z,{placeholder:"请选择提醒类型",mode:"multiple",value:n.remindType,"onUpdate:value":o[2]||(o[2]=s=>n.remindType=s)},{default:t(()=>[l(q,{value:"1"},{default:t(()=>[_("邮件")]),_:1}),l(q,{value:"2"},{default:t(()=>[_("短信")]),_:1}),l(q,{value:"4"},{default:t(()=>[_("系统消息")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),l(p,{span:12},{default:t(()=>[l(a,{label:"紧急程度",name:"urgentLevel"},{default:t(()=>[l(i(g),{placeholder:"请选择紧急程度",type:"select",value:n.urgentLevel,"onUpdate:value":o[3]||(o[3]=s=>n.urgentLevel=s),dictCode:"urgent_level"},null,8,["value"])]),_:1})]),_:1}),l(p,{span:12},{default:t(()=>[l(a,{label:"提醒时间",name:"remind"},{default:t(()=>[l(i(g),{placeholder:"请选择提醒时间",type:"select",value:n.remind,"onUpdate:value":o[4]||(o[4]=s=>n.remind=s),dictCode:"remindTime"},null,8,["value"])]),_:1})]),_:1}),l(p,{span:12},{default:t(()=>[l(a,{label:"重复提醒",name:"reminders"},{default:t(()=>[l(i(g),{placeholder:"请选择重复提醒",type:"select",value:n.reminders,"onUpdate:value":o[5]||(o[5]=s=>n.reminders=s),dictCode:"reminders"},null,8,["value"])]),_:1})]),_:1}),l(p,{span:12},{default:t(()=>[l(a,{label:"日程时间",name:"rangeTime"},{default:t(()=>[l(A,S(N.value,{value:n.rangeTime,"onUpdate:value":o[6]||(o[6]=s=>n.rangeTime=s)}),null,16,["value"])]),_:1})]),_:1}),l(p,{span:12},{default:t(()=>[l(a,{label:"是否全天"},{default:t(()=>[l(i(L),{options:[{value:"1"}],value:n.allDay,"onUpdate:value":o[7]||(o[7]=s=>n.allDay=s)},null,8,["value"])]),_:1})]),_:1})]),_:1}),l(c,{orientation:"left",style:{"margin-bottom":"40px"}},{default:t(()=>[_("其他信息")]),_:1}),l(R,null,{default:t(()=>[l(p,{span:12},{default:t(()=>[l(a,{label:"颜色"},{default:t(()=>[(C(!0),se(ue,null,re(i(ce),(s,te)=>(C(),I(ee,{class:"setting-drawer-theme-color-colorBlock",key:te},{title:t(()=>[_(ie(s.key),1)]),default:t(()=>[l(Q,{color:s.color,onClick:Pe=>n.planColor=s.color},{default:t(()=>[s.color===n.planColor?(C(),I(K,{key:0,type:"check"})):V("",!0)]),_:2},1032,["color","onClick"])]),_:2},1024))),128))]),_:1})]),_:1}),l(p,{span:12},{default:t(()=>[l(a,{label:"参与人"},{default:t(()=>[l(i(E),{value:n.joinPerson,"onUpdate:value":o[8]||(o[8]=s=>n.joinPerson=s)},null,8,["value"])]),_:1})]),_:1}),l(p,{span:24},{default:t(()=>[l(a,{labelCol:{xs:{span:24},sm:{span:3}},wrapperCol:{xs:{span:24},sm:{span:20}},label:"备注"},{default:t(()=>[l(i(U),{placeholder:"请输入备注",value:n.remark,"onUpdate:value":o[9]||(o[9]=s=>n.remark=s),showImageUpload:!1,height:200},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},16,["title","visible","defaultFullscreen","enableComment"])}}});const ge=ne(ve,[["__scopeId","data-v-14ef192b"]]),qe=Object.freeze(Object.defineProperty({__proto__:null,default:ge},Symbol.toStringTag,{value:"Module"}));export{ge as P,Le as a,Ee as b,je as c,fe as d,Be as e,he as f,Ie as g,qe as h,Ue as q,Me as s};
