var fe=Object.defineProperty,me=Object.defineProperties;var pe=Object.getOwnPropertyDescriptors;var ee=Object.getOwnPropertySymbols;var ge=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable;var te=(e,t,a)=>t in e?fe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,B=(e,t)=>{for(var a in t||(t={}))ge.call(t,a)&&te(e,a,t[a]);if(ee)for(var a of ee(t))he.call(t,a)&&te(e,a,t[a]);return e},E=(e,t)=>me(e,pe(t));var I=(e,t,a)=>new Promise((f,n)=>{var r=d=>{try{c(a.next(d))}catch(m){n(m)}},o=d=>{try{c(a.throw(d))}catch(m){n(m)}},c=d=>d.done?f(d.value):Promise.resolve(d.value).then(r,o);c((a=a.apply(e,t)).next())});import{u as i,h as L,d as N,H as ye,k as b,i as be,f as H,e as $,w as X,o as Ce,b as Se,n as _,V as h,v as ve,a6 as C,af as M,ai as g,q as He,a7 as q,ae as ke,O,a8 as Fe,F as ne,W as U,ag as z,E as J,ak as K,y as Be,g as $e,ao as oe,am as le,ap as ae,aq as se}from"./vue-vendor-24c7dc61.js";import{o as Y,M as Me,T as Oe,at as Te,au as we,av as Pe,aw as _e,ax as Ne}from"./antd-vue-vendor-0d72f01e.js";import{o as re,p as De,q as Re,t as We,v as je,x as Ee,S as Le,y as qe,l as A,h as ce,B as ze,z as Ae,C as Ve}from"./index-831af9dd.js";import{u as Ie}from"./useWindowSizeFn-8f085f6f.js";const{t:ie}=re(),Xe={visible:{type:Boolean},scrollTop:{type:Boolean,default:!0},height:{type:Number},minHeight:{type:Number},draggable:{type:Boolean,default:!0},centered:{type:Boolean},cancelText:{type:String,default:ie("common.cancelText")},okText:{type:String,default:ie("common.okText")},closeFunc:Function},Q=Object.assign({},Xe,{defaultFullscreen:{type:Boolean},canFullscreen:{type:Boolean,default:!0},wrapperFooterOffset:{type:Number,default:0},helpMessage:[String,Array],useWrapper:{type:Boolean,default:!0},loading:{type:Boolean},loadingTip:{type:String},showCancelBtn:{type:Boolean,default:!0},showOkBtn:{type:Boolean,default:!0},wrapperProps:Object,afterClose:Function,bodyStyle:Object,closable:{type:Boolean,default:!0},closeIcon:Object,confirmLoading:{type:Boolean},destroyOnClose:{type:Boolean},footer:Object,getContainer:Function,mask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},maskStyle:Object,okType:{type:String,default:"primary"},okButtonProps:Object,cancelButtonProps:Object,title:{type:String},visible:{type:Boolean},open:{type:Boolean},width:[String,Number],wrapClassName:{type:String},zIndex:{type:Number},maxHeight:{type:Number},enableComment:{type:Boolean,default:!1}});function Ye(e){const t=(n,r)=>getComputedStyle(n)[r],a=n=>{if(!n)return;n.setAttribute("data-drag",i(e.draggable));const r=n.querySelector(".ant-modal-header"),o=n.querySelector(".ant-modal");!r||!o||!i(e.draggable)||(r.style.cursor="move",r.onmousedown=c=>{if(!c)return;const d=c.clientX,m=c.clientY,l=document.body.clientWidth,u=document.documentElement.clientHeight,p=o.offsetWidth,y=o.offsetHeight,v=o.offsetLeft,S=l-o.offsetLeft-p,k=o.offsetTop;let F=u-o.offsetTop-y;F<0&&(F=u-o.offsetTop);const P=t(o,"left"),D=t(o,"top");let R=+P,W=+D;P.includes("%")?(R=+document.body.clientWidth*(+P.replace(/%/g,"")/100),W=+document.body.clientHeight*(+D.replace(/%/g,"")/100)):(R=+P.replace(/px/g,""),W=+D.replace(/px/g,"")),document.onmousemove=function(V){let T=V.clientX-d,w=V.clientY-m;-T>v?T=-v:T>S&&(T=S),-w>k?w=-k:w>F&&(w=F),o.style.cssText+=`;left:${T+R}px;top:${w+W}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})},f=()=>{const n=document.querySelectorAll(".ant-modal-wrap");for(const r of Array.from(n)){if(!r)continue;const o=t(r,"display"),c=r.getAttribute("data-drag");o!=="none"&&(c===null||i(e.destroyOnClose))&&a(r)}};L(()=>{!i(e.visible)||!i(e.draggable)||De(()=>{f()},30)})}function Ue(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!be(e)}const Ge=N({name:"Modal",inheritAttrs:!1,props:Y(Q,["visible"]),emits:["cancel"],setup(e,{slots:t,emit:a}){const{open:f,draggable:n,destroyOnClose:r}=ye(e),o=Re();Ye({visible:f,destroyOnClose:r,draggable:n});const c=d=>{a("cancel",d)};return()=>{let d;const m=E(B(B({},i(o)),e),{onCancel:c});return b(Me,m,Ue(d=We(t))?d:{default:()=>[d]})}}}),ue=Symbol();function Je(e){return je(e,ue)}function Ct(){return Ee(ue)}const Ke={loading:{type:Boolean},useWrapper:{type:Boolean,default:!0},modalHeaderHeight:{type:Number,default:57},modalFooterHeight:{type:Number,default:74},minHeight:{type:Number,default:null},maxHeight:{type:Number,default:null},height:{type:Number},footerOffset:{type:Number,default:0},visible:{type:Boolean},fullScreen:{type:Boolean},loadingTip:{type:String}},Qe=N({name:"ModalWrapper",components:{ScrollContainer:Le},inheritAttrs:!1,props:Ke,emits:["height-change","ext-height"],setup(e,{emit:t}){const a=H(null),f=H(null),n=H(0),r=H(0);let o=0,c=()=>{};Ie(l.bind(null,!1)),qe(f,()=>{l()},{attributes:!0,subtree:!0}),Je({redoModalHeight:l});const d=$(()=>{if(e.fullScreen)return{height:`${i(n)}px`};if(e.height!=null){let p=e.height;return e.minHeight===null?{height:`${p}px`}:{height:`${e.minHeight>p?e.minHeight:p}px`}}else return{minHeight:`${e.minHeight===null?200:e.minHeight}px`,maxHeight:`${e.maxHeight?e.maxHeight:i(n)}px`}});L(()=>{e.useWrapper&&l()}),X(()=>e.fullScreen,u=>{l(),u?r.value=n.value:n.value=r.value}),Ce(()=>{const{modalHeaderHeight:u,modalFooterHeight:p}=e;t("ext-height",u+p)}),Se(()=>{c&&c()});function m(){return I(this,null,function*(){_(()=>{var p;const u=i(a);u&&((p=u==null?void 0:u.scrollTo)==null||p.call(u,0))})})}function l(){return I(this,null,function*(){if(!e.visible)return;const u=i(a);if(!u)return;const p=u.$el.parentElement;if(p){p.style.padding="0",yield _();try{const y=p.parentElement&&p.parentElement.parentElement;if(!y)return;const v=getComputedStyle(y).top,S=Number.parseInt(v);let k=window.innerHeight-S*2+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;S<40&&(k-=26),yield _();const F=i(f);if(!F)return;yield _(),o=F.scrollHeight,e.fullScreen?n.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight-28:n.value=e.height?e.height:o>k?k:o,t("height-change",i(n))}catch(y){}}})}return{wrapperRef:a,spinRef:f,spinStyle:d,scrollTop:m,setModalHeight:l}}}),Ze=["loading-tip"];function xe(e,t,a,f,n,r){const o=h("ScrollContainer"),c=ve("loading");return C(),M(o,{ref:"wrapperRef"},{default:g(()=>[He((C(),q("div",{ref:"spinRef",style:ke(e.spinStyle),"loading-tip":e.loadingTip},[O(e.$slots,"default")],12,Ze)),[[c,e.loading]])]),_:3},512)}const et=A(Qe,[["render",xe]]),tt=N({name:"ModalClose",components:{Tooltip:Oe,FullscreenExitOutlined:Te,FullscreenOutlined:we,CloseOutlined:Pe,LeftSquareOutlined:_e,RightSquareOutlined:Ne},props:{canFullscreen:{type:Boolean,default:!0},fullScreen:{type:Boolean},enableComment:{type:Boolean,default:!1},commentSpan:{type:Number,default:0}},emits:["cancel","fullscreen","comment"],setup(e,{emit:t}){const{prefixCls:a}=ce("basic-modal-close"),{t:f}=re(),n=$(()=>[a,`${a}--custom`,{[`${a}--can-full`]:e.canFullscreen||e.enableComment}]);function r(l){t("cancel",l)}function o(l){l==null||l.stopPropagation(),l==null||l.preventDefault(),(e.commentSpan==0||e.enableComment==!1)&&t("fullscreen")}function c(l){l==null||l.stopPropagation(),l==null||l.preventDefault(),e.fullScreen==!1&&t("fullscreen"),t("comment",!0)}function d(l){l==null||l.stopPropagation(),l==null||l.preventDefault(),t("comment",!1)}const m=$(()=>e.enableComment===!0?!1:e.canFullscreen);return{t:f,getClass:n,prefixCls:a,handleCancel:r,handleFullScreen:o,handleOpenComment:c,handleCloseComment:d,fullScreenStatus:m}}});function nt(e,t,a,f,n,r){const o=h("FullscreenExitOutlined"),c=h("Tooltip"),d=h("FullscreenOutlined"),m=h("RightSquareOutlined"),l=h("LeftSquareOutlined"),u=h("CloseOutlined");return C(),q("div",{class:Fe(e.getClass)},[e.fullScreenStatus?(C(),q(ne,{key:0},[e.fullScreen?(C(),M(c,{key:0,title:e.t("component.modal.restore"),placement:"bottom"},{default:g(()=>[b(o,{role:"full",onClick:e.handleFullScreen},null,8,["onClick"])]),_:1},8,["title"])):(C(),M(c,{key:1,title:e.t("component.modal.maximize"),placement:"bottom"},{default:g(()=>[b(d,{role:"close",onClick:e.handleFullScreen},null,8,["onClick"])]),_:1},8,["title"]))],64)):U("",!0),e.enableComment?(C(),q(ne,{key:1},[e.commentSpan>0?(C(),M(c,{key:0,title:"收起",placement:"bottom"},{default:g(()=>[b(m,{onClick:e.handleCloseComment,style:{"font-size":"16px"}},null,8,["onClick"])]),_:1})):(C(),M(c,{key:1,title:"展开",placement:"bottom"},{default:g(()=>[b(l,{onClick:e.handleOpenComment,style:{"font-size":"16px"}},null,8,["onClick"])]),_:1}))],64)):U("",!0),b(c,{title:e.t("component.modal.close"),placement:"bottom"},{default:g(()=>[b(u,{onClick:e.handleCancel},null,8,["onClick"])]),_:1},8,["title"])],2)}const ot=A(tt,[["render",nt]]),lt=N({name:"BasicModalFooter",props:Q,emits:["ok","cancel"],setup(e,{emit:t}){function a(n){t("ok",n)}function f(n){t("cancel",n)}return{handleOk:a,handleCancel:f}}});function at(e,t,a,f,n,r){const o=h("a-button");return C(),q("div",null,[O(e.$slots,"insertFooter"),e.showCancelBtn?(C(),M(o,z({key:0},e.cancelButtonProps,{onClick:e.handleCancel}),{default:g(()=>[J(K(e.cancelText),1)]),_:1},16,["onClick"])):U("",!0),O(e.$slots,"centerFooter"),e.showOkBtn?(C(),M(o,z({key:1,type:e.okType,onClick:e.handleOk,loading:e.confirmLoading},e.okButtonProps),{default:g(()=>[J(K(e.okText),1)]),_:1},16,["type","onClick","loading"])):U("",!0),O(e.$slots,"appendFooter")])}const st=A(lt,[["render",at]]),it=N({name:"BasicModalHeader",components:{BasicTitle:ze},emits:["dblclick"],props:{helpMessage:{type:[String,Array]},title:{type:String}}});function rt(e,t,a,f,n,r){const o=h("BasicTitle");return C(),M(o,{helpMessage:e.helpMessage},{default:g(()=>[J(K(e.title),1)]),_:1},8,["helpMessage"])}const ct=A(it,[["render",rt]]);function ut(e){const t=H(!1),a=$(()=>{const n=i(e.wrapClassName)||"";return i(t)?`fullscreen-modal ${n} `:i(n)});function f(n){n&&n.stopPropagation(),t.value=!i(t)}return{getWrapClassName:a,handleFullScreen:f,fullScreenRef:t}}const dt=N({name:"BasicModal",components:{Modal:Ge,ModalWrapper:et,ModalClose:ot,ModalFooter:st,ModalHeader:ct},inheritAttrs:!1,props:Q,emits:["visible-change","open-change","height-change","cancel","ok","register","update:visible","update:open","fullScreen"],setup(e,{emit:t,attrs:a,slots:f}){const n=H(!1),r=H(null),o=H(null),{prefixCls:c}=ce("basic-modal"),d=H(0),m={setModalProps:R,emitVisible:void 0,redoModalHeight:()=>{_(()=>{i(o)&&i(o).setModalHeight()})}},l=$e();l&&t("register",m,l.uid);const u=$(()=>B(B({},e),i(r))),p=$(()=>!i(u).title&&!f.title),{handleFullScreen:y,getWrapClassName:v,fullScreenRef:S}=ut({modalWrapperRef:o,extHeightRef:d,wrapClassName:Be(u.value,"wrapClassName")}),k=$(()=>{const s=E(B({},i(u)),{visible:i(n),okButtonProps:void 0,cancelButtonProps:void 0,title:void 0});return E(B({},s),{wrapClassName:i(v)})}),F=$(()=>{const s=E(B(B({},a),i(u)),{open:i(n),wrapClassName:i(v)});return i(S)?Y(s,["height","title","visible"]):Y(s,["title","visible"])}),P=$(()=>{if(!i(S))return i(k).height});L(()=>{S.value=!!e.defaultFullscreen}),L(()=>{n.value=!!e.visible}),L(()=>{n.value=!!e.open}),X(()=>i(n),s=>{var j;t("visible-change",s),t("update:visible",s),t("update:open",s),l&&((j=m.emitVisible)==null||j.call(m,s,l.uid)),_(()=>{e.scrollTop&&s&&i(o)&&i(o).scrollTop()})},{immediate:!1});function D(s){return I(this,null,function*(){var j,x;if(s==null||s.stopPropagation(),!((x=(j=s.target)==null?void 0:j.classList)!=null&&x.contains(c+"-close--custom"))){if(e.closeFunc&&Ae(e.closeFunc)){const de=yield e.closeFunc();n.value=!de;return}n.value=!1,t("cancel",s)}})}function R(s){r.value=Ve(i(r)||{},s),Reflect.has(s,"visible")&&(n.value=!!s.visible),Reflect.has(s,"open")&&(n.value=!!s.open),Reflect.has(s,"defaultFullscreen")&&(S.value=!!s.defaultFullscreen)}function W(s){t("ok",s)}function V(s){t("height-change",s)}function T(s){d.value=s}function w(s){e.canFullscreen&&(s.stopPropagation(),y(s))}const G=H(0);X(()=>e.enableComment,s=>{Z(s)},{immediate:!0});function Z(s){s===!0?G.value=6:G.value=0}return X(S,s=>{t("fullScreen",s)}),{handleCancel:D,getBindValue:F,getProps:k,handleFullScreen:y,fullScreenRef:S,getMergeProps:u,handleOk:W,visibleRef:n,omit:Y,modalWrapperRef:o,handleExtHeight:T,handleHeightChange:V,handleTitleDbClick:w,getWrapperHeight:P,commentSpan:G,handleComment:Z,isNoTitle:p}}});function ft(e,t,a,f,n,r){const o=h("ModalClose"),c=h("ModalHeader"),d=h("ModalFooter"),m=h("ModalWrapper"),l=h("a-col"),u=h("a-row"),p=h("Modal");return C(),M(p,z(e.getBindValue,{onCancel:e.handleCancel}),oe({default:g(()=>[b(u,{class:"jeecg-modal-wrapper"},{default:g(()=>[b(l,{span:24-e.commentSpan,class:"jeecg-modal-content"},{default:g(()=>[b(m,z({useWrapper:e.getProps.useWrapper,footerOffset:e.wrapperFooterOffset,fullScreen:e.fullScreenRef,ref:"modalWrapperRef",loading:e.getProps.loading,"loading-tip":e.getProps.loadingTip,minHeight:e.getProps.minHeight,maxHeight:e.getProps.maxHeight,height:e.getWrapperHeight,visible:e.visibleRef,modalFooterHeight:e.footer!==void 0&&!e.footer?0:void 0},e.omit(e.getProps.wrapperProps,"visible","height","modalFooterHeight"),{onExtHeight:e.handleExtHeight,onHeightChange:e.handleHeightChange}),{default:g(()=>[O(e.$slots,"default")]),_:3},16,["useWrapper","footerOffset","fullScreen","loading","loading-tip","minHeight","maxHeight","height","visible","modalFooterHeight","onExtHeight","onHeightChange"])]),_:3},8,["span"]),b(l,{span:e.commentSpan,class:"jeecg-comment-outer"},{default:g(()=>[O(e.$slots,"comment")]),_:3},8,["span"])]),_:3})]),_:2},[e.$slots.closeIcon?void 0:{name:"closeIcon",fn:g(()=>[b(o,{canFullscreen:e.getProps.canFullscreen,fullScreen:e.fullScreenRef,commentSpan:e.commentSpan,enableComment:e.getProps.enableComment,onComment:e.handleComment,onCancel:e.handleCancel,onFullscreen:e.handleFullScreen},null,8,["canFullscreen","fullScreen","commentSpan","enableComment","onComment","onCancel","onFullscreen"])]),key:"0"},e.isNoTitle?void 0:{name:"title",fn:g(()=>[b(c,{helpMessage:e.getProps.helpMessage,title:e.getMergeProps.title,onDblclick:e.handleTitleDbClick},null,8,["helpMessage","title","onDblclick"])]),key:"1"},e.$slots.footer?void 0:{name:"footer",fn:g(()=>[b(d,z(e.getBindValue,{onOk:e.handleOk,onCancel:e.handleCancel}),oe({_:2},[le(Object.keys(e.$slots),y=>({name:y,fn:g(v=>[O(e.$slots,y,ae(se(v||{})))])}))]),1040,["onOk","onCancel"])]),key:"2"},le(Object.keys(e.omit(e.$slots,"default")),y=>({name:y,fn:g(v=>[O(e.$slots,y,ae(se(v||{})))])}))]),1040,["onCancel"])}const mt=A(dt,[["render",ft]]),St=Object.freeze(Object.defineProperty({__proto__:null,default:mt},Symbol.toStringTag,{value:"Module"}));export{mt as B,St as a,Ct as u};
