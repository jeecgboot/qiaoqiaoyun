var O=Object.defineProperty,$=Object.defineProperties;var H=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var x=(e,o,t)=>o in e?O(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,D=(e,o)=>{for(var t in o||(o={}))K.call(o,t)&&x(e,t,o[t]);if(B)for(var t of B(o))Q.call(o,t)&&x(e,t,o[t]);return e},V=(e,o)=>$(e,H(o));var h=(e,o,t)=>new Promise((n,p)=>{var F=a=>{try{f(t.next(a))}catch(s){p(s)}},b=a=>{try{f(t.throw(a))}catch(s){p(s)}},f=a=>a.done?n(a.value):Promise.resolve(a.value).then(F,b);f((t=t.apply(e,o)).next())});import{d as W,f as r,V as E,a6 as X,a7 as Y,k as l,ai as w,a5 as u,E as Z,q as d,A as m,ag as ee,u as oe,F as te,a3 as ne,a4 as se,n as ie}from"./vue-vendor-24c7dc61.js";import ae from"./FileLoginForm-d3cceff8.js";import le from"./FileMobileForm-03b4c12c.js";import re from"./FileForgetPasswordForm-6a66f657.js";import ce from"./FileRegisterForm-45910650.js";import ue from"./FileThirdModal-54f2cb0d.js";import{d as N,h as fe,bn as ge,a7 as de,j as me,o as pe,b7 as _e,l as ve}from"./index-831af9dd.js";import{B as Le}from"./BasicModal-58413bab.js";import"./index-1c3affea.js";import"./antd-vue-vendor-0d72f01e.js";import"./checkcode-5ec5fe8f.js";import"./index-f99b266a.js";import"./vxe-table-vendor-8813019a.js";import"./useWindowSizeFn-8f085f6f.js";const he=e=>(ne("data-v-87fd3638"),e=e(),se(),e),we=he(()=>u("span",null,"微信登录",-1)),Fe=W({__name:"FileLoginModal",props:{closable:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0}},emits:["success","register"],setup(e,{emit:o}){const t=e,n=r("accountLogin"),p=N(),{prefixCls:F}=fe("login"),{t:b}=pe(),a=ge().getShowPicker,s=r(""),c=de(),_=r(),k=r(),R=r(),S=r(),T=r(),[U,{setModalProps:G,closeModal:j}]=me(i=>h(this,null,function*(){G({confirmLoading:!1}),s.value="登录"}));function v(i){return h(this,null,function*(){const{token:P,userInfo:g}=i;c.setToken(P),c.setTenant(g.loginTenantId),yield c.getUserInfoAction(),c.getSessionTimeout?c.setSessionTimeout(!1):(yield c.setLoginInfo(V(D({},i),{isLogin:!0})),localStorage.setItem(_e.DRAG_BASE_URL,N().domainUrl)),o("success",g),j()})}function q(){s.value="登录",n.value="phoneLogin",setTimeout(()=>{k.value.initFrom()},300)}function L(){s.value="登录",n.value="accountLogin",M()}function C(){s.value="重置密码",n.value="forgetPassword",setTimeout(()=>{R.value.initFrom()},300)}function y(){s.value="注册账号 ",n.value="registerAccount",setTimeout(()=>{S.value.initFrom()},300)}function A(i){ie(()=>{n.value="accountLogin",_.value.setFormData(i)})}function z(i){i||(n.value="accountLogin",M())}function M(){setTimeout(()=>{_.value.initFrom()},300)}function J(){T.value.onThirdLogin("wechat_open")}return(i,P)=>{const g=E("a-button"),I=E("a-divider");return X(),Y(te,null,[l(Le,ee({wrapClassName:"file-login-modal"},i.$attrs,{onRegister:oe(U),width:"428px",title:s.value,showCancelBtn:!1,showOkBtn:!1,closable:e.closable,maskClosable:e.maskClosable,onVisibleChange:z}),{default:w(()=>[u("div",null,[l(g,{size:"large",class:"wechat",block:"",preIcon:"ant-design:wechat-outlined",onClick:J},{default:w(()=>[we]),_:1}),l(I,{class:"or-divider"},{default:w(()=>[Z("或")]),_:1})]),d(u("div",null,[l(ae,{ref_key:"fileLoginRef",ref:_,onSuccess:v,onPhoneLogin:q,onForgetPassword:C,onRegisterAccount:y},null,512)],512),[[m,n.value==="accountLogin"]]),d(u("div",null,[l(le,{ref_key:"fileMobileRef",ref:k,onSuccess:v,onAccountLogin:L,onForgetPassword:C,onRegisterAccount:y},null,512)],512),[[m,n.value==="phoneLogin"]]),d(u("div",null,[l(re,{ref_key:"filePwdRef",ref:R,onAccountLogin:L,onLoginData:A},null,512)],512),[[m,n.value==="forgetPassword"]]),d(u("div",null,[l(ce,{ref_key:"fileRegisterRef",ref:S,onAccountLogin:L,onLoginData:A},null,512)],512),[[m,n.value==="registerAccount"]])]),_:1},16,["onRegister","title","closable","maskClosable"]),l(ue,{ref_key:"fileThirdRef",ref:T,onSuccess:v},null,512)],64)}}});const Ee=ve(Fe,[["__scopeId","data-v-87fd3638"]]);export{Ee as default};
