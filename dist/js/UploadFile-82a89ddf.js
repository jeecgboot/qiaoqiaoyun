var ee=Object.defineProperty,te=Object.defineProperties;var ae=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var M=(l,s,i)=>s in l?ee(l,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[s]=i,A=(l,s)=>{for(var i in s||(s={}))le.call(s,i)&&M(l,i,s[i]);if(H)for(var i of H(s))se.call(s,i)&&M(l,i,s[i]);return l},W=(l,s)=>te(l,ae(s));import{d as j,f as a,V as x,a6 as n,a7 as d,k as c,ai as m,a5 as t,u as o,E as y,ak as h,F as C,am as I,W as oe,a3 as ie,a4 as ne,n as de}from"./vue-vendor-24c7dc61.js";import{aL as ce,a as ue,bA as re,l as fe}from"./index-831af9dd.js";import{u as P}from"./FileList.api-9749c044.js";import pe from"./SelectFolder-91dc24b4.js";import{h as L}from"./antd-vue-vendor-0d72f01e.js";import"./vxe-table-vendor-8813019a.js";const q=l=>(ie("data-v-ebad54d4"),l=l(),ne(),l),_e={style:{width:"600px",margin:"10px auto",height:"160px"}},ve={class:"ant-upload-drag-icon"},me=q(()=>t("p",{class:"ant-upload-text"},"拖拽文件到这里上传",-1)),he={style:{"text-align":"center","margin-top":"30px"}},ge={style:{"text-align":"center",padding:"10px 0"}},xe={key:0},ke=q(()=>t("div",{class:"file-list"},[t("div",{class:"file-item"},[t("div",{class:"file-name"},"文件"),t("div",{class:"file-size"},"大小"),t("div",{class:"file-status"},"状态"),t("div",{class:"file-location"},"位置")])],-1)),be={class:"file-content"},ye={class:"file-item"},Ce={class:"file-name"},Le={class:"file-size"},Ne={key:0,class:"file-status"},Fe={key:1,class:"file-status"},Se={class:"file-location"},Te=j({name:"upload-file"}),Ue=j(W(A({},Te),{emits:["register","ok"],setup(l,{expose:s,emit:i}){const V=a(""),G=a(800),N=a(!1),we=a(!1),J=a(),r=a([]),k=a([]),{createMessage:K}=ue(),ze=a([]),F=ce(),b=a(""),_=a(""),v=a(""),S=a(""),T=a({parentId:b,bizPath:"manage"}),B=a(),g=a(0);function Q(e){V.value="上传至",b.value=e.pid,v.value=e.firstTitle,S.value=e.firstPid,_.value=e.fileName,N.value=!0}function Ie(){J.value.submitForm()}function Pe(){O()}function O(){i("ok",o(r).length>0),N.value=!1,r.value=[],k.value=[]}function U(e){const f=e.file.status;if(f!="uploading"&&(f==="done"||f==="error")){if(e.file.response.code==500){let z={percent:100,firstTitle:L(o(v)),folderName:L(o(_)),status:"error",fileName:e.file.name,fileSize:e.file.size};k.value.push(z),K.error(e.file.response.message);return}let u=e.file.response.result;u.percent=100,u.firstTitle=L(o(v)),u.folderName=L(o(_)),u.status=f,k.value.push(u),de(()=>{g.value=g.value-1,o(g)==0&&i("ok",o(r).length>0)})}}function R(e){return re(e)}function w(e,f){r.value=[...o(f),e],g.value=g.value+1}function X(){B.value.add({pid:b.value,fileName:_.value,firstPid:S.value,firstTitle:v.value})}function Y(e){b.value=e.pid,_.value=e.folderName,S.value=e.firstPid,v.value=e.firstTitle}return s({add:Q}),(e,f)=>{const u=x("Icon"),z=x("a-upload-dragger"),D=x("a-button"),E=x("a-upload"),Z=x("a-modal");return n(),d(C,null,[c(Z,{"body-style":{"min-height":"350px"},title:V.value,width:G.value,open:N.value,onCancel:O,cancelText:"关闭",footer:null},{default:m(()=>[t("div",_e,[c(z,{name:"file",multiple:!0,action:o(P),fileList:r.value,onChange:U,showUploadList:!1,headers:o(F),data:T.value,beforeUpload:w,class:"upload-dragger"},{default:m(()=>[t("p",ve,[c(u,{icon:"ant-design:inbox-outlined",class:"upload-icon"})]),me]),_:1},8,["action","fileList","headers","data"])]),t("div",he,[c(E,{action:o(P),multiple:!0,showUploadList:!1,fileList:r.value,onChange:U,headers:o(F),data:T.value,beforeUpload:w},{default:m(()=>[c(D,null,{default:m(()=>[c(u,{icon:"ant-design:upload-outlined"}),y(" 上传文件 ")]),_:1})]),_:1},8,["action","fileList","headers","data"]),c(E,{action:o(P),showUploadList:!1,fileList:r.value,onChange:U,headers:o(F),directory:"",data:T.value,beforeUpload:w},{default:m(()=>[c(D,{style:{"margin-left":"10px"}},{default:m(()=>[c(u,{icon:"ant-design:inbox-outlined"}),y(" 上传文件夹 ")]),_:1})]),_:1},8,["action","fileList","headers","data"])]),t("div",ge,[y(" 文件上传到: "+h(v.value),1),(n(!0),d(C,null,I(_.value,p=>(n(),d("span",null,"/"+h(p.title),1))),256)),t("span",{style:{"margin-left":"10px",color:"#1e88e5",cursor:"pointer"},onClick:X},"更改")]),r.value.length>0?(n(),d("div",xe,[ke,t("div",be,[(n(!0),d(C,null,I(k.value,p=>(n(),d("ul",null,[t("li",ye,[t("div",Ce,h(p.fileName),1),t("div",Le,h(R(p.fileSize)),1),p.status==="done"?(n(),d("div",Ne," 成功")):(n(),d("div",Fe,"失败")),t("div",Se,[y(h(p.firstTitle),1),(n(!0),d(C,null,I(p.folderName,$=>(n(),d("span",null,"/"+h($.title),1))),256))])])]))),256))])])):oe("",!0)]),_:1},8,["title","width","open"]),c(pe,{ref_key:"selectFolder",ref:B,onOk:Y},null,512)],64)}}}));const Ae=fe(Ue,[["__scopeId","data-v-ebad54d4"]]);export{Ae as default};
