var z=Object.defineProperty,M=Object.defineProperties;var T=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var y=(e,o,n)=>o in e?z(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n,I=(e,o)=>{for(var n in o||(o={}))B.call(o,n)&&y(e,n,o[n]);if(C)for(var n of C(o))U.call(o,n)&&y(e,n,o[n]);return e},v=(e,o)=>M(e,T(o));var b=(e,o,n)=>new Promise((a,d)=>{var u=l=>{try{i(n.next(l))}catch(s){d(s)}},c=l=>{try{i(n.throw(l))}catch(s){d(s)}},i=l=>l.done?a(l.value):Promise.resolve(l.value).then(u,c);i((n=n.apply(e,o)).next())});import{d as D,a2 as Q,r as R,o as W,H as $,u as k,a3 as q,a4 as E,a5 as r,V as f,a6 as F,af as V,ai as g,ae as x,k as m,ak as w}from"./vue-vendor-24c7dc61.js";import{c as N,o as P}from"./useWebSocket-df578a5f.js";import{a7 as j,d as G,b as H,bB as A,l as J}from"./index-831af9dd.js";import{m as K,b as L}from"./manage.api-62536fbe.js";import{Q as O}from"./index-8553d60f.js";import"./antd-vue-vendor-0d72f01e.js";import"./vxe-table-vendor-8813019a.js";import"./Qrcode-8252d989.js";import"./download-1ac6acce.js";const X=D({components:{QrCode:O},setup(){const e=j(),{currentRoute:o}=Q(),n=G(),a=R({text:"",background:"#006699",fontSize:"24px",fontColor:"#000",name:"",depart:"",signTime:"",websockSign:null,lockReconnect:!1});function d(){const t=k(o).query;let _=t.fontSize,S=t.fontColor,p=t.bgColor,h=t.id;h&&(a.text=h),_&&(a.fontSize=t.fontSize+"px"),S&&(a.fontColor=t.fontColor),p&&(a.background=t.bgColor)}function u(){return b(this,null,function*(){let s=k(e.getUserInfo).id,t=yield K({mettingId:a.text,userId:s});t.success&&(yield c(t.result.userId))})}function c(s){return b(this,null,function*(){let t=yield L({id:a.text,userid:s});t.success&&(a.name=t.result.username,a.depart=t.result.userDepart,t.result.signTime!=null&&(a.signTime=t.result.signTime.split(" ")[1]))})}function i(){var p;let s=H(),t=A(s),_=k(e.getUserInfo).id+"_"+t,S=((p=n.domainUrl)==null?void 0:p.replace("https://","wss://").replace("http://","ws://"))+"/websocket/"+_;N(S),P(l)}function l(s){s.cmd==="sign"&&c(s.userId)}return W(()=>{d(),i()}),v(I({},$(a)),{testSign:u})}});const Y=e=>(q("data-v-925aac62"),e=e(),E(),e),Z=Y(()=>r("thead",null,[r("tr",{align:"center"},[r("th",null,"姓名"),r("th",null,"部门"),r("th",null,"签到时间")])],-1)),ee={align:"center"},te={style:{padding:"0 20px"}},oe={style:{padding:"0 20px"}},ne={style:{padding:"0 20px"}};function se(e,o,n,a,d,u){const c=f("QrCode"),i=f("a-col"),l=f("a-row"),s=f("a-modal");return F(),V(s,{open:!0,switchFullscreen:"",width:960,class:"prewiewModal",footer:null,closable:!1,keyboard:!1,maskClosable:!1},{default:g(()=>[r("div",{class:"container",onClick:o[0]||(o[0]=(...t)=>e.testSign&&e.testSign(...t)),style:x({backgroundColor:e.background})},[m(l,{gutter:24},{default:g(()=>[m(i,{span:12,style:{"padding-top":"40px","padding-left":"40px"}},{default:g(()=>[m(c,{value:e.text,width:300,logo:"http://jeecg.com/images/logo.png",options:{color:{dark:"#000000",light:"#ffffff"}}},null,8,["value"])]),_:1}),m(i,{span:12,style:{"padding-top":"30px"}},{default:g(()=>[r("table",{style:x({fontSize:e.fontSize,color:e.fontColor}),class:"prewiew-right-table"},[Z,r("tbody",null,[r("tr",ee,[r("td",te,w(e.name),1),r("td",oe,w(e.depart),1),r("td",ne,w(e.signTime),1)])])],4)]),_:1})]),_:1})],4)]),_:1})}const me=J(X,[["render",se],["__scopeId","data-v-925aac62"]]);export{me as default};
