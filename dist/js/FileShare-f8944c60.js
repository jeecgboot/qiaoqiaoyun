var ue=Object.defineProperty,ce=Object.defineProperties;var fe=Object.getOwnPropertyDescriptors;var $=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var E=(u,o,i)=>o in u?ue(u,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):u[o]=i,P=(u,o)=>{for(var i in o||(o={}))de.call(o,i)&&E(u,i,o[i]);if($)for(var i of $(o))pe.call(o,i)&&E(u,i,o[i]);return u},W=(u,o)=>ce(u,fe(o));var H=(u,o,i)=>new Promise((I,v)=>{var m=s=>{try{f(i.next(s))}catch(k){v(k)}},z=s=>{try{f(i.throw(s))}catch(k){v(k)}},f=s=>s.done?I(s.value):Promise.resolve(s.value).then(m,z);f((i=i.apply(u,o)).next())});import{d as J,a2 as ge,f as d,o as ve,V as b,a6 as n,a7 as h,a5 as p,k as w,ai as T,F as O,am as he,ak as M,W as me,E as _e,af as y,u as c,a3 as ye,a4 as Ie,n as ke}from"./vue-vendor-24c7dc61.js";import{H as Se,I as R,J as we,K as ze,L as xe}from"./FileList.api-9749c044.js";import{d as Fe,a7 as Ce,e as be,a as Te,ap as A,l as Ne}from"./index-831af9dd.js";import{L as Ue}from"./link-d33a2dbc.js";import Le from"./FileLoginModal-147a1764.js";import"./index-1c3affea.js";import{h as Me}from"./header-55b09394.js";import"./antd-vue-vendor-0d72f01e.js";import"./vxe-table-vendor-8813019a.js";import"./FileLoginForm-d3cceff8.js";import"./checkcode-5ec5fe8f.js";import"./FileMobileForm-03b4c12c.js";import"./index-f99b266a.js";import"./FileForgetPasswordForm-6a66f657.js";import"./FileRegisterForm-45910650.js";import"./FileThirdModal-54f2cb0d.js";import"./BasicModal-58413bab.js";import"./useWindowSizeFn-8f085f6f.js";const N=u=>(ye("data-v-216b5c0c"),u=u(),Ie(),u),Re={key:0,class:"share-file"},Ve={class:"pointer all-file"},qe=N(()=>p("span",null," >    ",-1)),Be=["onClick"],De=N(()=>p("span",{class:"font-size-15",style:{"margin-left":"2px"}},"进入系统",-1)),$e=N(()=>p("span",{class:"font-size-15",style:{"margin-left":"2px"}},"下载",-1)),Ee=N(()=>p("span",{class:"font-size-15",style:{"margin-left":"2px"}},"存入知识",-1)),Pe={key:1,class:"header-image"},We=["src"],He={key:2,class:"login-user pointer",style:{"line-height":"50px"}},Oe=["src"],Ae=["src"],Je={class:"file-text"},Ge={key:1},Ke=J({name:"file-share"}),Qe=J(W(P({},Ke),{setup(u){const o=Te(),i=Fe(),I=ge(),v=d([]),m=d({}),z=d(!1),f=d(""),s=d([]),k=d(!1),je=d(!1),x=d(""),F=d("加载中，请稍后"),_=Ce(),g=d({total:0,current:1,pageSize:10,pageSizeOptions:["10","20","30"],showTotal:(e,t)=>t[0]+"-"+t[1]+" 共"+e+"条",showQuickJumper:!0,showSizeChanger:!0,onChange:ee,showSizeChange:te}),S=d({}),U=d(""),[G,{openModal:K}]=be();function Q(e,t){x.value=t,U.value=e,Se({id:e}).then(l=>{l.success&&l.result?_.getUserInfo.id?R({fileId:e,rootId:c(x),userId:_.getUserInfo.id}).then(a=>{a.success&&a.result?L(a):D(l,e)}):D(l,e):z.value=!1})}function V(e){return e?A(e):Me}function j(e){if(e.izFolder==="1"){f.value=e.id;let t=s.value.filter(l=>l.key==e.id);(!t||t.length==0)&&s.value.push({key:e.id,title:e.fileName}),C()}else X(e)}function q(e){ke(()=>{if(g.value.current=1,g.value.pageSize=10,e=="all")s.value=[],f.value="",v.value=[],v.value.push(c(m)),g.value.total=1;else{const t=d([]);f.value=e.key;for(let l=0;l<s.value.length;l++){if(e.key==s.value[l].key){t.value.push({key:s.value[l].key,title:s.value[l].title});break}t.value.push({key:s.value[l].key,title:s.value[l].title})}C()}})}function X(e){if(e&&e.url){if(e.ext==="url"){window.open(e.url,"_blank");return}let t=encodeURIComponent(A(e.url));(t.endsWith(".pdf")||t.endsWith(".doc")||t.endsWith(".docx"))&&(t=t+"&officePreviewType=pdf");let l=`${i.viewUrl}?url=`+t;window.open(l,"_blank")}}function C(){k.value=!0;let e={shareId:m.value.id,parentId:c(f),pageNo:g.value.current,pageSize:g.value.pageSize,delFlag:"0"};v.value=[],we(e).then(t=>{if(t.success)if(t.result.records&&t.result.records.length>0){let l=t.result.records;for(let a of l)a.showInput=!1,a.izFolder!=="1"&&a.fileName&&(a.ext=Y(a.fileName),a.fileName=a.fileName.substr(0,a.fileName.lastIndexOf(".")));v.value=l,g.value.total=t.result.total}else v.value=[],g.value.total=0,F.value="当前文件不存在或您没有查看权限"}).finally(()=>{k.value=!1})}function Y(e){let t=e.split(".");return t=t[t.length-1],t}function Z(){let e=m.value.fileName;c(s).length>0&&(e=s.value[s.value.length-1].title);let t=m.value.id;c(f)&&(t=c(f));let l=document.createElement("a");l.href=ze+"?fileId="+t+"&zipName="+e+"&type=share&shareId="+m.value.id,l.target="_target",l.click()}function ee(e,t){g.value.current=e,g.value.pageSize=t,C()}function te(e,t){g.value.pageSize=t,C()}function Xe(){let e=_.getUserInfo;e?(S.value=e,B()):S.value={}}function le(){K(!0,{})}function se(){return H(this,null,function*(){_.getUserInfo.id?B():o.createMessage.warning("请先登录")})}function ae(e){R({fileId:c(U),rootId:c(x),userId:_.getUserInfo.id}).then(t=>{t.success&&t.result?L(t):S.value=e})}function B(){R({fileId:c(U),rootId:c(x),userId:_.getUserInfo.id}).then(e=>{if(e.success&&e.result)L(e);else{let t=m.value.id;c(f)&&(t=c(f));let l={fileName:"我的文件",fileType:"folder",izFolder:"1",izRootFolder:"1",parentId:"",storeType:"manage",downCount:0,readCount:0,createBy:_.getUserInfo.username,delFlag:"0",fileId:t,userId:_.getUserInfo.id};xe(l).then(a=>{a.success?o.createMessage.success("存入知识库成功"):o.createMessage.info(a.message)})}})}function D(e,t){e.result.izFolder==="0"?(window.open(e.result.url,"_self"),z.value=!1):(F.value="当前文件不存在或您没有查看权限",z.value=!0,v.value.push(e.result),m.value=e.result,f.value=t,g.value.total=1,S.value=_.getUserInfo)}function L(e){F.value="已在共享文件夹中，正在跳转到知识库";let t={parentId:e.result.parentId?e.result.parentId:c(x),rootId:c(x)};e.result.tenantId&&(t.tenantId=e.result.tenantId);let l=I.currentRoute.value.query.path,a=l||"/file";I.push({path:a,query:t})}function ne(){I.push({path:"/file"})}return ve(()=>{let e=I.currentRoute.value.query.id,t=I.currentRoute.value.query.rootId;e&&t&&Q(e,t)}),(e,t)=>{const l=b("Icon"),a=b("a-button"),oe=b("a-list-item"),ie=b("a-list");return n(),h(O,null,[p("div",null,[z.value?(n(),h("div",Re,[w(ie,{size:"small",bordered:"","data-source":v.value,loading:k.value,pagination:g.value},{header:T(()=>[p("div",Ve,[p("span",{onClick:t[0]||(t[0]=r=>q("all"))},"全部文件"),(n(!0),h(O,null,he(s.value,r=>(n(),h("span",null,[qe,p("span",{class:"pointer title-hover",onClick:re=>q(r)},M(r.title),9,Be)]))),256))]),S.value.realname?(n(),h("div",{key:0,class:"go-system pointer",onClick:ne},[w(l,{class:"font-size-15",icon:"ant-design:play-circle-outlined"}),De])):me("",!0),p("div",{class:"download-file pointer",onClick:Z},[w(l,{class:"font-size-15",icon:"ant-design:arrow-down-outlined"}),$e]),p("div",{class:"save-file pointer",onClick:se},[w(l,{class:"font-size-15",icon:"ant-design:cloud-outlined"}),Ee]),S.value.realname?(n(),h("div",Pe,[p("img",{style:{"border-radius":"50%"},src:V(S.value.avatar)},null,8,We)])):(n(),h("div",He,[w(a,{type:"primary",size:"small",onClick:le,class:"login-user"},{default:T(()=>[_e("登录")]),_:1})]))]),renderItem:T(({item:r})=>[w(oe,{class:"share-info pointer",onClick:re=>j(r)},{default:T(()=>[p("div",null,[r.fileType==="image"?(n(),h("img",{key:0,class:"file-image",src:V(r.url)},null,8,Oe)):r.fileType==="excel"?(n(),y(l,{key:1,class:"file-icon",icon:"ant-design:file-excel-outlined",style:{color:"rgb(98, 187, 55)"}})):r.fileType==="pdf"?(n(),y(l,{key:2,class:"file-icon",icon:"ant-design:file-pdf-outlined",style:{color:"rgb(211, 47, 47)"}})):r.fileType==="doc"?(n(),y(l,{key:3,class:"file-icon",icon:"ant-design:file-word-outlined",style:{color:"rgb(68, 138, 255)"}})):r.fileType==="ppt"?(n(),y(l,{key:4,class:"file-icon",icon:"ant-design:file-ppt-outlined",style:{color:"rgb(245, 124, 0)"}})):r.fileType==="video"?(n(),y(l,{key:5,class:"file-icon",icon:"ant-design:play-square-outlined",style:{color:"rgb(119, 87, 188)"}})):r.fileType==="text"?(n(),y(l,{key:6,class:"file-icon",icon:"ant-design:file-text-outlined",style:{color:"rgb(41, 211, 178)"}})):r.fileType==="zip"?(n(),y(l,{key:7,class:"file-icon",icon:"ant-design:file-zip-outlined",style:{color:"rgb(253, 202, 7)"}})):r.izFolder==="1"?(n(),y(l,{key:8,class:"file-icon file-folder",icon:"ant-design:folder-open-outlined"})):r.ext==="url"?(n(),h("img",{key:9,src:c(Ue),class:"file-image"},null,8,Ae)):(n(),y(l,{key:10,class:"file-icon",icon:"ant-design:file-unknown-outlined"})),p("span",Je,M(r.fileName),1)])]),_:2},1032,["onClick"])]),_:1},8,["data-source","loading","pagination"])])):(n(),h("div",Ge,M(F.value),1))]),w(Le,{onRegister:c(G),onSuccess:ae},null,8,["onRegister"])],64)}}}));const mt=Ne(Qe,[["__scopeId","data-v-216b5c0c"]]);export{mt as default};
