var M=Object.defineProperty,P=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var E=(n,i,e)=>i in n?M(n,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[i]=e,A=(n,i)=>{for(var e in i||(i={}))X.call(i,e)&&E(n,e,i[e]);if(V)for(var e of V(i))Y.call(i,e)&&E(n,e,i[e]);return n},O=(n,i)=>P(n,Q(i));var I=(n,i,e)=>new Promise((t,_)=>{var m=l=>{try{u(e.next(l))}catch(a){_(a)}},k=l=>{try{u(e.throw(l))}catch(a){_(a)}},u=l=>l.done?t(l.value):Promise.resolve(l.value).then(m,k);u((e=e.apply(n,i)).next())});import{f as x,h as Z,c as $,e as N,w as tt,I as ot,V as L,q as et,a6 as s,a7 as d,a5 as h,F as nt,am as it,ak as v,W as w,af as T,al as lt,k as C,ai as b,E as F,A as rt}from"./vue-vendor-24c7dc61.js";import{s as at}from"./type.definition-4eb605ee.js";import{u as st}from"./LinkRecordSelect-385d0eae.js";import{a_ as ct,p as dt}from"./antd-vue-vendor-0d72f01e.js";import mt from"./FilterFiledList-8a929f88.js";import{u as ut}from"./useCustomButton-fa741dda.js";import{l as ft}from"./index-831af9dd.js";import"./index-1c3affea.js";import"./BasicModal-58413bab.js";import"./useWindowSizeFn-8f085f6f.js";import"./SelectItem-04dd2229.js";import"./vxe-table-vendor-8813019a.js";import"./lowAppUtils-56892d30.js";import"./auto.desform.api-839115ed.js";import"./desformUtils-c7daaa89.js";import"./LinkRecordTags-cf4c2463.js";import"./FormSchemaFactory-ec827fa7.js";import"./index-bff0b654.js";import"./JUpload-76e119c7.js";import"./index-d508f1f4.js";import"./componentMap-c857637c.js";import"./useFormItem-86503382.js";import"./download-1ac6acce.js";import"./index-f99b266a.js";import"./JSelectUser-a44af43a.js";import"./useSelectBiz-2f560b0b.js";import"./props-8a7ac45b.js";import"./JSelectBiz-55a9591f.js";import"./JImageUpload-d644253a.js";import"./JDictSelectTag-54dc3bdb.js";import"./JSelectDept-a90caee3.js";import"./index-f2fd5a28.js";import"./useContextMenu-810f9346.js";import"./areaDataUtil-cdeee717.js";import"./china-area-data-vendor-556d14ee.js";import"./JPopup-2a779923.js";import"./useMethods-f689b480.js";import"./JCheckbox-0b89d32a.js";import"./JSelectUserByDept-bd619076.js";import"./UserSelectByDepModal-db060ece.js";import"./depart.api-339f4da6.js";import"./index-6507b9cd.js";import"./index-4d0525a5.js";import"./UserSelectModal-d78c1490.js";import"./lowAppAuth-3d637b7d.js";import"./useFuncSwitch-b7681246.js";import"./DictColors-73058d23.js";import"./TableImage-14ca1f5d.js";import"./SubTableTag-81763fd6.js";import"./CardCellFile-92b3c8c8.js";import"./SuperQueryValComponent-97f284a9.js";import"./helper-22dafba0.js";import"./ComponentIcon-f1bbb90f.js";const pt={name:"ButtonShowConditions",props:{visible:{type:Boolean,default:!1},conditions:{type:Array,default:()=>[]},type:{type:String,default:""},code:{type:String,default:""},allColumns:{type:Array,default:()=>[]}},components:{EditOutlined:ct,FilterFiledList:mt},emits:["ok","back"],setup(n,{emit:i}){const e=x([]),t=x("and"),{translateCondition:_}=ut(n);Z(()=>I(this,null,function*(){t.value=n.type;let o=n.conditions;if(!o||o.length==0)e.value=[];else{let c=[];for(let y of o){let g=dt(y,"field","rule","val","type");c.push(g)}let f=JSON.stringify(c);const p=yield _(f);p.length>0?e.value=p:e.value=c}}));const m=$("globalColumnList",void 0),{getTypeLabel:k}=st(),u=N(()=>[...(m==null?void 0:m.value)||[],...at.map(o=>O(A({},o),{model:o.field}))]);function l(o){let f=u.value.filter(p=>p.model===o);return f.length>0?f[0].name:o}const a=x(!1),r=x();function S(){a.value=!0}function D(){r.value.saveCondition()}function R(o){i("ok",o),a.value=!1}function H(){i("back"),a.value=!1}const j=N(()=>({conditions:e.value,conditionType:t.value}));tt(()=>n.visible,o=>{o===!0&&(n.conditions&&n.conditions.length>0||(a.value=!0))});const q={maxHeight:window.innerHeight-200+"px",overflow:"auto"};function J(){i("ok",{conditions:[],conditionType:"and"}),a.value=!1}const U=["radio","checkbox","select","select-user","select-depart","table-dict","select-tree","link-record"];function W(o){let{val:c,field:f,type:p}=o,y=ot(c);if(U.indexOf(p)>=0){let g=n.allColumns;if(!g||g.length==0)return y;for(let B of g)if(B.dataIndex===f){B.customRender&&(y=B.customRender({text:y,record:{}}));break}}return y}const z=["link-record"];function G(o){let c=n.allColumns;return!c||c.length==0?!1:z.indexOf(o.type)>=0}function K(o){return o&&(o=o==null?void 0:o.replace(/#\{\s*sys_user_code\s*}/g,"当前用户"),o)}return{conditionList:e,conditionType:t,getFieldLabel:l,getTypeLabel:k,goEdit:S,onConditionSelected:D,modalVisible:a,columnList:m,filterInfo:j,saveInfo:R,bodyStyle:q,filterRef:r,onBack:H,clearAll:J,isLinkrecordComponent:G,getFieldValue:W,getValueText:K}}};const yt={class:"button-conditions"},_t={key:0,class:"button-conditions-text"},kt={style:{flex:"1"}},gt={class:"condition-item"},ht={key:0},vt={style:{color:"#333","font-weight":"700"}},Ct={key:1,class:"link-record-span"},bt={key:2},xt={key:3},Lt={class:"button-edit-icon"},wt={class:"inner-content filter-select-adding",style:{padding:"0 20px 20px 15px",height:"100%",overflow:"auto"}};function St(n,i,e,t,_,m){const k=L("EditOutlined"),u=L("FilterFiledList"),l=L("a-button"),a=L("a-modal");return et((s(),d("div",yt,[t.conditionList&&t.conditionList.length>0?(s(),d("div",_t,[h("div",kt,[(s(!0),d(nt,null,it(t.conditionList,(r,S)=>(s(),d("div",gt,[S>0?(s(),d("span",ht,v(t.conditionType=="and"?"且":"或"),1)):w("",!0),h("span",null,v(t.getFieldLabel(r.field)),1),h("span",vt,v(t.getTypeLabel(r.rule)),1),t.isLinkrecordComponent(r)?(s(),d("span",Ct,[r.val?(s(),T(lt(t.getFieldValue(r)),{key:0})):w("",!0)])):r.valText?(s(),d("span",bt,v(t.getValueText(r.valText)),1)):(s(),d("span",xt,v(t.getValueText(r.val)),1))]))),256))]),h("div",Lt,[C(k,{onClick:t.goEdit},null,8,["onClick"])])])):w("",!0),C(a,{centered:"",open:t.modalVisible,"onUpdate:open":i[0]||(i[0]=r=>t.modalVisible=r),title:"筛选",bodyStyle:t.bodyStyle,onCancel:t.onBack,onOk:t.onConditionSelected,wrapClassName:"button-condition-modal"},{footer:b(()=>[t.conditionList.length>0?(s(),T(l,{key:0,onClick:t.clearAll},{default:b(()=>[F("清空")]),_:1},8,["onClick"])):w("",!0),C(l,{style:{"margin-left":"18px"},onClick:t.onBack},{default:b(()=>[F("取消")]),_:1},8,["onClick"]),C(l,{style:{"margin-left":"10px"},type:"primary",onClick:t.onConditionSelected},{default:b(()=>[F("确定")]),_:1},8,["onClick"])]),default:b(()=>[h("div",wt,[C(u,{ref:"filterRef",columnList:t.columnList,onSave:t.saveInfo,info:t.filterInfo,parentContainer:"button-condition-modal",saveButton:!1},null,8,["columnList","onSave","info"])])]),_:1},8,["open","bodyStyle","onCancel","onOk"])],512)),[[rt,e.visible]])}const Vo=ft(pt,[["render",St]]);export{Vo as default};
