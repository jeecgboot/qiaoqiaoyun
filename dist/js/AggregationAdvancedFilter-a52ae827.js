var B=Object.defineProperty,N=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var C=(u,i,o)=>i in u?B(u,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):u[i]=o,y=(u,i)=>{for(var o in i||(i={}))U.call(i,o)&&C(u,o,i[o]);if(g)for(var o of g(i))W.call(i,o)&&C(u,o,i[o]);return u},S=(u,i)=>N(u,J(i));import{u as z,I as G,d as H,V as X,a6 as Z,a7 as V,k as ee}from"./vue-vendor-24c7dc61.js";import{F as te}from"./FormSchemaFactory-ec827fa7.js";import{s as P}from"./type.definition-4eb605ee.js";import{h as re}from"./componentMap-c857637c.js";import{L as le}from"./LinkRecordSelect-385d0eae.js";import{b1 as he,l as ne}from"./index-831af9dd.js";import ae from"./SuperQueryValComponent-97f284a9.js";const O={};function se(u,i,o){v();function v(){const e="linkRecordSelect";O[e]||(re(e,le),O[e]=1)}function f(e){var s;const t=[...z(u.columnList)||[],...P.map(a=>S(y({},a),{model:a.field}))];if(!t||t.length==0)return"";const r=t.filter(a=>a.model===e||a.value===e);return!r||r.length==0?"":((s=r[0])!=null&&s.name||(r[0].name=r[0].title),r[0])}function d(e,t){const r=P.filter(l=>l.field===e.field);return e.field==="create_by"||e.field==="update_by"?{view:"select_user2",multi:!0,store:"username",query:!0,key:e.field,title:r[0].name}:{key:e.field,view:t=="range"?"rangeDate":e.type,title:r[0].name,datetime:!0}}function h(e,t){const{type:r}=e;switch(r){case"radio":return k(e,!1);case"checkbox":return k(e,!0);case"select":return k(e,!1);case"time":return _(e,t);case"date":case"year":case"month":return q(e,t);case"datetime":return A(e,t);case"integer":case"number":case"money":case"rate":case"slider":case"formula":case"summary":return T(e,t);case"select-depart":return M(e);case"select-user":return x(e);case"table-dict":return R(e);case"select-tree":return L(e);case"switch":return $(e);case"link-record":return j(e);case"area-linkage":return D(e);default:return b(e)}}function b(e){return{view:"input",title:e.name}}function _(e,t){return t==="range"?{view:"rangeTime",title:e.name,format:e.format}:{view:"time",title:e.name}}function q(e,t){let r="date";return t==="range"&&(r="rangeDate"),{view:r,timestamp:e.timestamp,title:e.name,type:e.type}}function A(e,t){return t==="range"?{view:"rangeDate",datetime:!0,title:e.name}:{view:"datetime",title:e.name}}function T(e,t){return t==="range"?{view:"rangeNumber",title:e.name}:{view:"input",type:"number",title:e.name}}function M(e){const t=JSON.stringify({multiSelect:e!=null&&e.multiSelect?e==null?void 0:e.multiSelect:e.multiple,store:e.rowKey||e.customReturnField,primaryKey:e.rowKey||e.customReturnField});return{view:"sel_depart",title:e.name,fieldExtendJson:t}}function x(e){return{view:"select_user2",multi:e!=null&&e.multiSelect?e==null?void 0:e.multiSelect:e.multiple,store:e.rowKey||e.customReturnField,title:e.name,query:!0}}function R(e){const{dictTable:t,dictCode:r,dictText:l,multiple:s,subType:a,scope:c,name:n,model:m}=e;if(a=="select"){if(c=="database")return{view:"list",title:n,dictTable:t,dictCode:r,dictText:l};if(c=="cgreport")return{view:"popup",title:n,code:t,popupMulti:s,orgFields:r,destFields:m}}else if(a=="popup")return{view:"popup",title:n,code:t,popupMulti:s,orgFields:r,destFields:l};return b(e)}function L(e){const{conf:t,dataFrom:r,name:l}=e;if(r=="category")return{view:"cat_tree",title:l,pcode:t.category.code};{const{name:s,code:a,text:c,pidField:n,rootPid:m}=t.table,p=`${s},${c},${a}`;return{view:"sel_tree",title:e.name,dict:p,pidField:n,placeholder:"请选择",pidValue:m}}}function $(e){const t={view:"list",title:e.name,multi:!1};return t.enum=[{value:e.options[0],title:"是"},{value:e.options[1],title:"否"}],t}function j(e){const{multi:t,code:r,titleField:l,name:s}=e;return{view:"LinkTableForQuery",title:s,multi:t,code:r,titleField:l}}function D(e){const{name:t}=e;return{view:"CascaderPcaForQuery",title:t}}function k(e,t){const{remote:r,dictCode:l,options:s,name:a}=e;t||(t=e.multiple);const c={view:"list",title:a,multi:t||!1};return r=="dict"&&l?c.dictCode=l:c.enum=s.map(n=>({value:n.value,title:n.label||n.title||n.text||n.value})),c}const Y=["create_time","create_by","update_time","update_by"];function I(e){var m;const t=e!=null&&e.field?e==null?void 0:e.field:e==null?void 0:e.value,r=e.queryType||e.rule;let l=f(t);if(l!=null&&l.options&&(l=y(y({},l),l==null?void 0:l.options)),["in","not_in"].includes(r)&&(l.multi=!0,l.multiple=!0,l.multiSelect=!0),l.type==="link-record")return E(l,e);if(l.type==="org-role")return K(l,e);let s=h(l,r);Y.indexOf(t)>=0&&(s=d(e,r));const a=te.createFormSchema(t,s);if(a.noChange(),i===!0){a.isInPopover();const p=o||"jee-filter-select-pop";a.setCustomPopContainer(p)}else a.asSearchForm();const c=p=>{e.val=p[e.field]};a.setFunctionForFieldValue(c);const n=a.getFormItemSchema();return n.componentProps=(m=n.componentProps)!=null?m:{},(r==="empty"||r==="not_empty")&&(e.val="",n.componentProps?n.componentProps.disabled=!0:n.componentProps={disabled:!0}),n.component==="UserSelect"&&(n.componentProps.inSuperQuery=!0),s.type=="month"?(n.componentProps.picker=s.type,n.componentProps.valueFormat="YYYY-MM"):s.type=="year"&&(n.componentProps.picker=s.type,n.componentProps.valueFormat="YYYY",n.componentProps.timestamp=s.timestamp),["in","not_in"].includes(r)&&(n.componentProps.mode="multiple",n.componentProps.multi=!0,n.componentProps.multiple=!0),n}function E(e,t){const{model:r,value:l,code:s,sourceCode:a,showMode:c,name:n,multi:m,showFields:p}=e,w={component:"linkRecordSelect",field:r||l,componentProps:{code:s||a,multi:m||c==="many",titleField:e.titleField,showFields:G(p),style:{width:"100%"},getContainer:()=>document.body},itemProps:{labelCol:{class:"online-form-label"}},label:n,labelLength:4},Q=o||"jee-filter-select-pop";i===!0&&(w.componentProps.getContainer=()=>document.querySelector(`.${Q}`));const F=t.queryType||t.rule;return(F==="empty"||F==="not_empty")&&(t.val="",w.componentProps.disabled=!0),w}function K(e,t){const{model:r,multiple:l,name:s}=e,a={component:"RoleSelect",field:r,componentProps:{multi:l,store:"code",style:{width:"100%"},getContainer:()=>document.body},itemProps:{labelCol:{class:"online-form-label"}},label:s,labelLength:4},c=o||"jee-filter-select-pop";i===!0&&(a.componentProps.getContainer=()=>document.querySelector(`.${c}`));const n=t.queryType||t.rule;return(n==="empty"||n==="not_empty")&&(t.val="",a.componentProps.disabled=!0),a}return{getSchema:I,getFieldConfig:f}}const ue=H({name:"AggregationAdvancedFilter",components:{OnlineSuperQueryValComponent:ae},emits:["save"],props:{columnList:{type:Array,default:()=>[]},condition:{type:Object},parentContainer:{type:String,default:""}},setup(u){const{getSchema:i}=se(u,!1,u.parentContainer);function o(v,f,d){d.val=f}return{getSchema:i,setFormModel:o}}}),oe={style:{"padding-top":"0"}};function ie(u,i,o,v,f,d){const h=X("online-super-query-val-component");return Z(),V("div",oe,[ee(h,{style:{width:"100%"},schema:u.getSchema(u.condition),formModel:u.condition,setFormModel:(b,_)=>{u.setFormModel(b,_,u.condition)}},null,8,["schema","formModel","setFormModel"])])}const ce=ne(ue,[["render",ie]]),ke=Object.freeze(Object.defineProperty({__proto__:null,default:ce},Symbol.toStringTag,{value:"Module"}));export{ce as A,ke as a,se as u};
