var L=Object.defineProperty,J=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var F=(o,t,a)=>t in o?L(o,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[t]=a,N=(o,t)=>{for(var a in t||(t={}))P.call(t,a)&&F(o,a,t[a]);if(I)for(var a of I(t))G.call(t,a)&&F(o,a,t[a]);return o},T=(o,t)=>J(o,K(t));var z=(o,t,a)=>new Promise((y,i)=>{var m=u=>{try{v(a.next(u))}catch(p){i(p)}},f=u=>{try{v(a.throw(u))}catch(p){i(p)}},v=u=>u.done?y(u.value):Promise.resolve(u.value).then(m,f);v((a=a.apply(o,t)).next())});import{c as x,f as g,h as H,u as M,d as Q,e as R,a3 as le,a4 as ue,V as U,a6 as W,a7 as X,ae as Y,k as Z}from"./vue-vendor-24c7dc61.js";import{q as j}from"./aggregation.api-c441389c.js";import{l as O}from"./index-831af9dd.js";import"./antd-vue-vendor-0d72f01e.js";import"./vxe-table-vendor-8813019a.js";function ee(o){const t=x("tableRelationObj"),a=x("reloadTable"),y=g(),i=g([]),m=g([]),f=g([]),v=g(!1),u=g({}),p=g({current:1,pageSize:20,total:0,onChange:(n,e)=>{$(n,e)},showTotal:(n,e)=>e[0]+"-"+e[1]+" 共"+n+"条"});H(()=>{a.value&&q()});function q(){const n=[];try{t!=null&&t.headerFields&&(t==null?void 0:t.headerFields.length)>0&&t.headerFields.forEach(e=>{n.push({title:e==null?void 0:e.name,align:"center",dataIndex:e==null?void 0:e.value.split("-")[0],customCell:(s,l,r)=>({rowSpan:u.value[e==null?void 0:e.value.split("-")[0]][l]})})}),t!=null&&t.calculateFields&&(t==null?void 0:t.calculateFields.length)>0&&t.calculateFields.forEach(e=>{n.push({title:e==null?void 0:e.name,align:"center",dataIndex:e==null?void 0:e.id})})}catch(e){}m.value=[...n],b(),a.value=!1}function b(){var n,e;i.value=[],j(T(N({},t),{pageNum:((n=p.value)==null?void 0:n.current)||1,pageSize:((e=p.value)==null?void 0:e.pageSize)||10})).then(s=>z(this,null,function*(){var r;const l=(r=s.result)==null?void 0:r.record;if(s.success&&l&&l.length>0){v.value=!0;const d=s.result.translateData;f.value=s.result.record,i.value=l,u.value=V(),p.value.total=s.result.total}else v.value=!1,i.value=[]})).catch(s=>{})}function E(n,e,s){const l=M(i),r=new Array(l.length);let d="",w="",_=0,D=0;for(let c=0;c<l.length;c++){const h=l[c][n],S=e?l[c][e]:"";if(c===0)d=h,w=S,_=1,r[0]=1;else if(h===d&&(!S&&h||S&&w===S)){_++;const C=[...r];C[D]=_,C[c]=0;const k=A(s[e],c),B=A(C,c);k>=B?(r[D]=_,r[c]=0):r[c]=1}else _=1,d=h,w=S,D=c,r[c]=1}return r}function A(n,e){return n&&n.length>0?n.slice(0,e).reduce((r,d)=>r+d,0):1}function V(){const n={};for(let e=0;e<t.headerFields.length;e++){const s=t.headerFields[e].value.split("-")[0],l=e>0?t.headerFields[e-1].value.split("-")[0]:"";n[s]=E(s,l,n)}return n}function oe(n,e){const s={};let l=null;for(let r=0;r<e.length;r++){const d=parseInt(e[r].value.split("-")[0]);s[d]=countRowSpan(n,d,l),l=s[d]}return s}function $(n,e){p.value.current=n,p.value.pageSize=e,b()}return{queryData:b,dataSource:i,columns:m,tableRef:y,ipagination:p}}const te=Q({name:"JTable",props:{id:{type:String,default:""}},emits:["success"],setup(o){let{dataSource:t,queryData:a,columns:y,tableRef:i,ipagination:m}=ee(o);const f=R(()=>({height:"auto",border:"none"}));return{dataSource:t,columns:y,tableRef:i,styleObject:f,queryData:a,ipagination:m}}});const ne=["id"];function ae(o,t,a,y,i,m){const f=U("a-table");return W(),X("div",{id:o.id,style:Y(o.styleObject)},[Z(f,{ref:"tableRef",size:"small",tableLayout:"fixed",scroll:{x:!0},pagination:o.ipagination,bordered:"",rowClassName:(v,u)=>u%2===1?"table-striped":"table-oddNumber",columns:o.columns,dataSource:o.dataSource},null,8,["pagination","rowClassName","columns","dataSource"])],12,ne)}const me=O(te,[["render",ae],["__scopeId","data-v-3310b60e"]]);export{me as default};
