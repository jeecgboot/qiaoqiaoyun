var Oe=Object.defineProperty,Ye=Object.defineProperties;var $e=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var Re=Object.prototype.hasOwnProperty,Ve=Object.prototype.propertyIsEnumerable;var le=(r,c,u)=>c in r?Oe(r,c,{enumerable:!0,configurable:!0,writable:!0,value:u}):r[c]=u,ne=(r,c)=>{for(var u in c||(c={}))Re.call(c,u)&&le(r,u,c[u]);if(se)for(var u of se(c))Ve.call(c,u)&&le(r,u,c[u]);return r},ie=(r,c)=>Ye(r,$e(c));var E=(r,c,u)=>new Promise((O,B)=>{var Y=t=>{try{N(u.next(t))}catch(f){B(f)}},q=t=>{try{N(u.throw(t))}catch(f){B(f)}},N=t=>t.done?O(t.value):Promise.resolve(t.value).then(Y,q);N((u=u.apply(r,c)).next())});import{d as fe,u as s,f as i,V as w,a6 as m,a7 as y,k as v,ai as T,a5 as o,a8 as A,F as ue,am as re,af as ce,ak as p,q as k,A as b,E as g,W as K,ag as je,a3 as ze,a4 as Ee,n as de}from"./vue-vendor-24c7dc61.js";import{B as Fe}from"./index-1c3affea.js";import{j as qe,q as Pe,M as We,k as F,ap as Je,b6 as Qe,bz as Xe,l as Ze}from"./index-831af9dd.js";import{i as ve}from"./antd-vue-vendor-0d72f01e.js";import et from"./AddressLeftTree-f084803d.js";import pe from"./AddressBookMore-5a4ee64b.js";import{h as _e}from"./header-55b09394.js";import{g as tt}from"./FileList.api-9749c044.js";import"./BasicModal-58413bab.js";import"./useWindowSizeFn-8f085f6f.js";import"./vxe-table-vendor-8813019a.js";const h=r=>(ze("data-v-38483c42"),r=r(),Ee(),r),ot={style:{"margin-top":"20px"}},at=["onClick"],st={style:{"vertical-align":"middle"}},lt=["onClick"],nt=["onClick"],it={class:"center-book-search"},ut={class:"task-select"},rt=h(()=>o("span",{class:"font-size-13"},"所有群组",-1)),ct=h(()=>o("span",{class:"font-size-13"},"我创建的群组",-1)),dt={class:"all-contact"},vt=["onClick"],pt=["src"],_t={class:"list-item-name"},ft={class:"list-item-number"},mt={class:"all-contact"},gt={class:"all-contact"},ht={key:0},yt={key:1,class:"project-info pointer"},kt={class:"right-book-detail"},bt=["src","onerror"],Ct={class:"right-book-info"},Dt={key:0},Tt={key:1},wt={class:"right-book-btn"},Gt={class:"right-book-footer"},Mt={class:"right-book-footer-info"},It=h(()=>o("span",null,"创建人：",-1)),xt={class:"right-book-footer-info"},At=h(()=>o("span",null,"群组成员：",-1)),Bt={class:"right-book-footer-info"},Nt=h(()=>o("span",null,"创建时间",-1)),Lt={class:"right-book-footer-info"},Ut=h(()=>o("span",null,"电话：",-1)),St={class:"right-book-footer-info"},Ht=h(()=>o("span",null,"邮箱：",-1)),Kt={class:"right-book-footer-info two-columns"},Ot=h(()=>o("span",null,"生日：",-1)),Yt={class:"right-book-footer-info two-columns"},$t=h(()=>o("span",null,"性别：",-1)),Rt={class:"right-book-footer-info two-columns"},Vt=h(()=>o("span",null,"职务：",-1)),jt={class:"right-book-footer-info two-columns"},zt=h(()=>o("span",null,"部门：",-1)),Et=fe({name:"address-book"}),Ft=fe(ie(ne({},Et),{setup(r){const c=r;let u;(e=>{e.getMyDepartList="/sys/sysDepart/getMyDepartList",e.getMyGroupList="/eoa/im/newApi/getMyGroupList"})(u||(u={}));const[O,{closeModal:B}]=qe(e=>E(this,null,function*(){Be()})),Y=Pe(),q=Object.assign({},s(c),s(Y)),N=i([]),t=i("allContact"),f=i(""),P=i([]),G=i([]),a=i({}),C=i(""),qt=i(""),L=i("allGroup"),U=i(!1),W=i(1),M=i(),x=i(),S=i(""),me=We("sex"),d=i(!0),H=i(""),J=i([]),_=i([]),Q=i(0);function ge(){R()}function X(e){G.value=[],a.value={},f.value="",S.value="",d.value=!1,C.value="",e.id?t.value=e.id:t.value=e,M.value.clearSelectedKeys(),s(t)==="myGroup"?$():s(t)===_.id+"group"?V():s(t)==="allContact"?setTimeout(()=>{x.value.getUserData()},100):(setTimeout(()=>{M.value.loadRootTreeData(e)},100),W.value=1,S.value=e.id)}function Pt(){F.get({url:"/sys/sysDepart/getMyDepartList"},{isTransformResponse:!1}).then(e=>{e.success&&(P.value=e.result)})}function $(){U.value=!0;let e={keyword:s(C),type:s(L),searchType:"allGroup"};F.get({url:"/eoa/im/newApi/getMyGroupList",params:e},{isTransformResponse:!1}).then(l=>{l.success&&(G.value=l.result)}).finally(()=>{U.value=!1})}function Z(e){return e?Je(e):_e}function he(e){f.value=e.groupId,a.value=e}function ye(){let e=s(a),l=Qe(Xe),I=document.getElementById("jChatOnline"),D="";s(t)==="myGroup"||s(t)===s(_).id+"group"?D=e.groupId:D=e.id,I.contentWindow.postMessage({type:"open-chat",messageId:l,data:{id:D,type:e.type?e.type:"friend",groupName:e.groupName,avatar:e.avatar,username:e.realname}},"*"),R()}function ke(e){return e?ve(new Date(e)).format("YYYY-MM-DD HH:mm:ss"):"无"}function be(e){return e?ve(new Date(e)).format("YYYY-MM-DD"):"未填写"}function Ce(e){let l=me.find(D=>D.value===e),I="未填写";return l&&l.length>0&&(I=l[0].text),I}function R(){B(),t.value="allContact",L.value="allGroup",f.value="",P.value=[],G.value=[],a.value=[]}function De(e){G.value=[],s(t)==="myGroup"?$():s(t)===s(_).id+"group"?V():s(t)==="allContact"?(a.value={},x.value.updateKeyword(s(C))):(d.value=!1,a.value={},setTimeout(()=>{M.value.searchDepart({id:s(_).id,departName:s(C)})},100))}function Te(){$()}function we(e){f.value=e.orgCode,d.value=!1,setTimeout(()=>{S.value=e.id,H.value=e.title,x.value.updateDepartId(e.id,s(C))},100)}function Ge(e){ee(e),d.value=!0,a.value=e,f.value=e.centerActiveKey}function Me(e){ee(e),a.value=e,f.value=e.centerActiveKey,d.value=!0}function Ie(){d.value=!1}function ee(e){return E(this,null,function*(){e.post_dictText&&(e.post_dictText=e.post_dictText.replaceAll(",","|"))})}function xe(e){H.value=H.value+"("+e+")"}function Ae(e){e.show=!e.show}function Be(){tt().then(e=>{e.success&&(J.value=e.result.list)})}function te(){G.value=[],a.value={},f.value="",S.value="",C.value=""}function oe(e,l){t.value=e.id+l,_.value=e}function Ne(e){de(()=>{te(),d.value=!0,oe(e,"depart"),setTimeout(()=>{M.value.clearDepartName(),M.value.loadRootTreeData(e)},300),W.value=1})}function Le(e){Q.value=e.id,de(()=>{te(),d.value=!1,oe(e,"group"),V()})}function V(){U.value=!0;let e={type:"allGroup",tenantId:s(Q),keyword:s(C)};F.get({url:"/eoa/im/newApi/getMyGroupList",params:e},{isTransformResponse:!1}).then(l=>{l.success&&(G.value=l.result)}).finally(()=>{U.value=!1})}return(e,l)=>{const I=w("a-divider"),D=w("Icon"),j=w("a-col"),Ue=w("a-input-search"),ae=w("a-select-option"),Se=w("a-select"),He=w("a-button"),Ke=w("a-row");return m(),y("div",null,[v(s(Fe),je({wrapClassName:"address-book-dialog",title:"通讯录"},e.$attrs,{canFullscreen:!1,onRegister:s(O),width:"900px",onOk:ge,onCancel:R,destroyOnClose:"",footer:null}),{default:T(()=>[v(Ke,{span:"24"},{default:T(()=>[v(j,{span:6,class:"left-book"},{default:T(()=>[o("div",ot,[o("div",{class:A(["book-item",t.value==="allContact"?"book-item-active":""]),onClick:l[0]||(l[0]=n=>X("allContact"))}," 所有联系人 ",2),o("div",{class:A(["book-item",t.value==="myGroup"?"book-item-active":""]),onClick:l[1]||(l[1]=n=>X("myGroup"))}," 我的群组 ",2),v(I),(m(!0),y(ue,null,re(J.value,n=>(m(),y("div",null,[o("div",{class:"book-list",onClick:z=>Ae(n)},[n.show?(m(),ce(D,{key:0,icon:"ant-design:down-outlined",class:"book-list-icon"})):(m(),ce(D,{key:1,icon:"ant-design:right-outlined",class:"book-list-icon"})),o("span",st,p(n.name),1)],8,at),k(o("div",null,[o("div",{class:A(["tenant-depart",t.value===n.id+"depart"?"book-item-active":""]),onClick:z=>Ne(n)},"部门",10,lt),o("div",{class:A(["tenant-depart",t.value===n.id+"group"?"book-item-active":""]),onClick:z=>Le(n)},"群组",10,nt)],512),[[b,n.show]])]))),256))])]),_:1}),v(j,{span:7,class:"center-book"},{default:T(()=>[o("div",it,[v(Ue,{placeholder:"搜索",value:C.value,"onUpdate:value":l[2]||(l[2]=n=>C.value=n),onSearch:De},null,8,["value"])]),o("div",ut,[k(v(Se,{value:L.value,"onUpdate:value":l[3]||(l[3]=n=>L.value=n),style:{width:"115px"},size:"small",onChange:Te},{default:T(()=>[v(ae,{value:"allGroup"},{default:T(()=>[rt]),_:1}),v(ae,{value:"createdGroup"},{default:T(()=>[ct]),_:1})]),_:1},8,["value"]),[[b,t.value==="myGroup"]])]),k(o("div",dt,[(m(!0),y(ue,null,re(G.value,n=>(m(),y("div",{class:A([f.value===n.groupId?"list-item-active":"","list-item pointer"]),onClick:z=>he(n)},[o("img",{src:Z(n.avatar),class:"list-item-avatar"},null,8,pt),o("span",_t,p(n.groupName),1),o("span",ft,p(n.membersNumber),1)],10,vt))),256))],512),[[b,t.value==="myGroup"||t.value===_.value.id+"group"]]),k(o("div",mt,[v(pe,{ref_key:"bookMore",ref:x,onUpdateDetail:Ge},null,512)],512),[[b,t.value==="allContact"]]),k(o("div",gt,[v(et,{ref_key:"leftTree",ref:M,onSelect:we},null,512)],512),[[b,t.value===_.value.id+"depart"]])]),_:1}),v(j,{span:12,class:"right-book"},{default:T(()=>[f.value!==""?(m(),y("div",ht,[t.value!=="allContact"&&t.value!=="myGroup"&&d.value&&t.value!==_.value.id+"group"?(m(),y("div",{key:0,class:"project-info pointer",onClick:Ie},[v(D,{icon:"ant-design:left-outlined",class:"right-back"}),g(" 返回 ")])):K("",!0),t.value!=="allContact"&&t.value!=="myGroup"&&!d.value&&t.value!==_.value.id+"group"?(m(),y("div",yt,[o("span",null,p(H.value),1)])):K("",!0),k(o("div",kt,[o("img",{src:Z(a.value.avatar),onerror:s(_e),class:"right-book-avatar"},null,8,bt),o("div",Ct,[t.value==="myGroup"||t.value===_.value.id+"group"?(m(),y("span",Dt,p(a.value.groupName),1)):t.value==="allContact"||d.value?(m(),y("span",Tt,p(a.value.realname),1)):K("",!0)])],512),[[b,d.value||t.value==="myGroup"||t.value===_.value.id+"group"]]),k(o("div",wt,[v(He,{style:{"border-radius":"18px"},type:"primary",preIcon:"ant-design:message-outlined",onClick:ye},{default:T(()=>[g("发消息 ")]),_:1})],512),[[b,d.value||t.value==="myGroup"||t.value===_.value.id+"group"]]),o("div",Gt,[k(o("div",null,[o("div",Mt,[It,g(" "+p(a.value.realname),1)]),o("div",xt,[At,g(" "+p(a.value.membersNumber),1)]),o("div",Bt,[Nt,g(" "+p(ke(a.value.createTime)),1)])],512),[[b,t.value==="myGroup"||t.value===_.value.id+"group"]]),k(o("div",null,[o("div",Lt,[Ut,g(" "+p(a.value.phone?a.value.phone:"未填写"),1)]),o("div",St,[Ht,g(" "+p(a.value.email?a.value.email:"未填写"),1)]),o("div",Kt,[Ot,g(" "+p(be(a.value.birthday)),1)]),o("div",Yt,[$t,g(" "+p(Ce(a.value.sex)),1)]),o("div",Rt,[Vt,g(" "+p(a.value.post_dictText?a.value.post_dictText:"未填写"),1)]),o("div",jt,[zt,g(" "+p(a.value.departName),1)])],512),[[b,t.value==="allContact"||d.value]]),k(o("div",null,[v(pe,{ref_key:"bookMore",ref:x,onUpdateDetail:Me,onUpdateTotal:xe},null,512)],512),[[b,t.value!="myGroup"&&t.value!="allContact"&&!d.value&&t.value!==_.value.id+"group"]])])])):K("",!0)]),_:1})]),_:1})]),_:1},16,["onRegister"])])}}}));const io=Ze(Ft,[["__scopeId","data-v-38483c42"]]);export{io as default};
