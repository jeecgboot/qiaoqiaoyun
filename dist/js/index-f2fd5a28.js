var Pe=Object.defineProperty,je=Object.defineProperties;var Re=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var Ie=Object.prototype.hasOwnProperty,$e=Object.prototype.propertyIsEnumerable;var ce=(e,n,t)=>n in e?Pe(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,B=(e,n)=>{for(var t in n||(n={}))Ie.call(n,t)&&ce(e,t,n[t]);if(oe)for(var t of oe(n))$e.call(n,t)&&ce(e,t,n[t]);return e},le=(e,n)=>je(e,Re(n));var de=(e,n,t)=>new Promise((p,b)=>{var C=S=>{try{g(t.next(S))}catch(K){b(K)}},i=S=>{try{g(t.throw(S))}catch(K){b(K)}},g=S=>S.done?p(S.value):Promise.resolve(S.value).then(C,i);g((t=t.apply(e,n)).next())});import{aw as Ue,d as Ae,f as Ce,aj as ze,e as M,w as j,a6 as D,a7 as I,u as c,O as Ve,W as P,af as J,ai as $,E as ue,ak as fe,a8 as he,k as T,F as Q,am as He,ap as Ye,aq as qe,z as Ge,l as Xe,r as pe,h as U,o as We,I as Y,q as ye,A as ge,ag as Je,i as Ze}from"./vue-vendor-24c7dc61.js";import{aU as Qe,aV as et,aW as tt,aX as nt,q as rt,D as at,h as ee,o as st,y as it,X as ot,E as me,aY as ct,az as lt}from"./antd-vue-vendor-0d72f01e.js";import{aV as dt,D as ut,B as ft,R as te,o as ht,aW as ke,aX as pt,ad as yt,aY as gt,t as mt,S as kt,P as bt,z as Z,W as be,a6 as St,an as xt}from"./index-831af9dd.js";import{u as At}from"./useContextMenu-810f9346.js";function ne(e,n){return n?typeof n=="string"?` ${e}--${n}`:Array.isArray(n)?n.reduce((t,p)=>t+ne(e,p),""):Object.keys(n).reduce((t,p)=>t+(n[p]?ne(e,p):""),""):""}function Ct(e){return(n,t)=>(n&&typeof n!="string"&&(t=n,n=""),n=n?`${e}__${n}`:e,`${n}${ne(n,t)}`)}function Te(e){return[Ct(`${dt}-${e}`)]}function Tt(e,n){const t=Object.create(null),p=e.split(",");for(let b=0;b<p.length;b++)t[p[b]]=!0;return n?b=>!!t[b.toLowerCase()]:b=>!!t[b]}const Ht=Array.isArray;const Et=e=>typeof e=="string";const Kt=e=>e!==null&&typeof e=="object";const q=e=>{const n=Object.create(null);return t=>n[t]||(n[t]=e(t))},Lt=/-(\w)/g,Yt=q(e=>e.replace(Lt,(n,t)=>t?t.toUpperCase():"")),wt=/\B([A-Z])/g,qt=q(e=>e.replace(wt,"-$1").toLowerCase()),_t=q(e=>e.charAt(0).toUpperCase()+e.slice(1)),Gt=q(e=>e?`on${_t(e)}`:"");const vt="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly";const Xt=Tt(vt+",async,autofocus,autoplay,controls,default,defer,disabled,hidden,inert,loop,open,required,reversed,scoped,seamless,checked,muted,multiple,selected");const Se=Symbol(),xe=Symbol();function Ot(e,n){if(!Kt(e)||e[xe])return e;const{values:t,required:p,default:b,type:C,validator:i}=e,g=t||i?S=>{let K=!1,E=[];if(t&&(E=[...t,b],K||(K=E.includes(S))),i&&(K||(K=i(S))),!K&&E.length>0){const f=[...new Set(E)].map(r=>JSON.stringify(r)).join(", ");Ue(`Invalid prop: validation failed${n?` for prop "${n}"`:""}. Expected one of [${f}], got value ${JSON.stringify(S)}.`)}return K}:void 0;return{type:typeof C=="object"&&Object.getOwnPropertySymbols(C).includes(Se)?C[Se]:C,required:!!p,default:b,validator:g,[xe]:!0}}const Nt=e=>Qe(Object.entries(e).map(([n,t])=>[n,Ot(t,n)]));var w=(e=>(e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY",e))(w||{});const Ft=["update:expandedKeys","update:selectedKeys","update:value","change","check","search","update:searchValue"],Dt=Nt({value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:Boolean,search:Boolean,searchValue:{type:String,default:""},checkStrictly:Boolean,clickRowToExpand:{type:Boolean,default:!1},checkable:Boolean,defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:Boolean,fieldNames:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:Array,default:()=>[]},beforeRightClick:{type:Function,default:void 0},rightMenuList:{type:Array},filterFn:{type:Function,default:void 0},highlight:{type:[Boolean,String],default:!1},expandOnSearch:Boolean,checkOnSearch:Boolean,selectedOnSearch:Boolean,loading:{type:Boolean,default:!1}}),Mt={key:2,class:"flex items-center flex-1 cursor-pointer justify-self-stretch justify-end"},Bt=Ae({__name:"TreeHeader",props:{helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},search:{type:Boolean,default:!1},searchText:{type:String,default:""},checkAll:{type:Function,default:void 0},expandAll:{type:Function,default:void 0}},emits:["strictly-change","search","clickSearch"],setup(e,{emit:n}){const t=e,p=Ce(""),[b]=Te("tree-header"),C=ze(),{t:i}=ht(),g=M(()=>["mr-1","w-full",{"ml-5":C.headerTitle||t.title}]),S=M(()=>{const{checkable:r}=t,s=[{label:i("component.tree.expandAll"),value:w.EXPAND_ALL},{label:i("component.tree.unExpandAll"),value:w.UN_EXPAND_ALL,divider:r}];return r?[{label:i("component.tree.selectAll"),value:w.SELECT_ALL},{label:i("component.tree.unSelectAll"),value:w.UN_SELECT_ALL,divider:r},...s,{label:i("component.tree.checkStrictly"),value:w.CHECK_STRICTLY},{label:i("component.tree.checkUnStrictly"),value:w.CHECK_UN_STRICTLY}]:s});function K(r){var o,l,u,d;const{key:s}=r;switch(s){case w.SELECT_ALL:(o=t.checkAll)==null||o.call(t,!0);break;case w.UN_SELECT_ALL:(l=t.checkAll)==null||l.call(t,!1);break;case w.EXPAND_ALL:(u=t.expandAll)==null||u.call(t,!0);break;case w.UN_EXPAND_ALL:(d=t.expandAll)==null||d.call(t,!1);break;case w.CHECK_STRICTLY:n("strictly-change",!1);break;case w.CHECK_UN_STRICTLY:n("strictly-change",!0);break}}function E(r){n("search",r)}const f=ut(E,200);return j(()=>p.value,r=>{f(r)}),j(()=>t.searchText,r=>{r!==p.value&&(p.value=r)}),(r,s)=>(D(),I("div",{class:he([c(b)(),"flex px-2 py-1.5 items-center"])},[c(C).headerTitle?Ve(r.$slots,"headerTitle",{key:0}):P("",!0),!c(C).headerTitle&&r.title?(D(),J(c(ft),{key:1,helpMessage:r.helpMessage},{default:$(()=>[ue(fe(r.title),1)]),_:1},8,["helpMessage"])):P("",!0),r.search||r.toolbar?(D(),I("div",Mt,[r.search?(D(),I("div",{key:0,class:he(g.value)},[T(c(et),{placeholder:c(i)("common.searchText"),size:"small",allowClear:"",value:p.value,"onUpdate:value":s[0]||(s[0]=o=>p.value=o),onSearch:s[1]||(s[1]=o=>r.$emit("clickSearch",o))},null,8,["placeholder","value"])],2)):P("",!0),r.toolbar?(D(),J(c(at),{key:1,onClick:s[2]||(s[2]=Ge(()=>{},["prevent"]))},{overlay:$(()=>[T(c(rt),{onClick:K},{default:$(()=>[(D(!0),I(Q,null,He(S.value,o=>(D(),I(Q,{key:o.value},[T(c(tt),Ye(qe({key:o.value})),{default:$(()=>[ue(fe(o.label),1)]),_:2},1040),o.divider?(D(),J(c(nt),{key:0})):P("",!0)],64))),128))]),_:1})]),default:$(()=>[T(c(te),{icon:"ion:ellipsis-vertical"})]),_:1})):P("",!0)])):P("",!0)],2))}}),Pt=({icon:e})=>e?Et(e)?Xe(te,{icon:e,class:"mr-1"}):te:null;function jt(e,n){function t(f){const r=[],s=f||c(e),{key:o,children:l}=c(n);if(!l||!o)return r;for(let u=0;u<s.length;u++){const d=s[u];r.push(d[o]);const y=d[l];y&&y.length&&r.push(...t(y))}return r}function p(f){const r=[],s=f||c(e),{key:o,children:l}=c(n);if(!l||!o)return r;for(let u=0;u<s.length;u++){const d=s[u];d.disabled!==!0&&d.selectable!==!1&&r.push(d[o]);const y=d[l];y&&y.length&&r.push(...p(y))}return r}function b(f,r){const s=[],o=r||c(e),{key:l,children:u}=c(n);if(!u||!l)return s;for(let d=0;d<o.length;d++){const y=o[d],L=y[u];f===y[l]?(s.push(y[l]),L&&L.length&&s.push(...t(L))):L&&L.length&&s.push(...b(f,L))}return s}function C(f,r,s){if(!f)return;const o=s||c(e),{key:l,children:u}=c(n);if(!(!u||!l))for(let d=0;d<o.length;d++){const y=o[d],L=y[u];if(y[l]===f){o[d]=B(B({},o[d]),r);break}else L&&L.length&&C(f,r,y[u])}}function i(f=1,r,s=1){if(!f)return[];const o=[],l=r||c(e)||[];for(let u=0;u<l.length;u++){const d=l[u],{key:y,children:L}=c(n),G=y?d[y]:"",R=L?d[L]:[];o.push(G),R&&R.length&&s<f&&(s+=1,o.push(...i(f,R,s)))}return o}function g({parentKey:f=null,node:r,push:s="push"}){const o=ee(c(e));if(!f){o[s](r),e.value=o;return}const{key:l,children:u}=c(n);!u||!l||(ke(o,d=>{if(d[l]===f)return d[u]=d[u]||[],d[u][s](r),!0}),e.value=o)}function S({parentKey:f=null,list:r,push:s="push"}){const o=ee(c(e));if(!(!r||r.length<1))if(f){const{key:l,children:u}=c(n);if(!u||!l)return;ke(o,d=>{if(d[l]===f){d[u]=d[u]||[];for(let y=0;y<r.length;y++)d[u][s](r[y]);return e.value=o,!0}})}else for(let l=0;l<r.length;l++)o[s](r[l])}function K(f,r){if(!f)return;const s=r||c(e),{key:o,children:l}=c(n);if(!(!l||!o))for(let u=0;u<s.length;u++){const d=s[u],y=d[l];if(d[o]===f){s.splice(u,1);break}else y&&y.length&&K(f,d[l])}}function E(f,r,s){return!f&&f!==0?null:((r||c(e)).forEach(l=>{if(s!=null&&s.key||(s==null?void 0:s.key)===0)return s;if(l.key===f){s=l;return}l.children&&l.children.length&&(s=E(f,l.children,s))}),s||null)}return{deleteNodeByKey:K,insertNodeByKey:g,insertNodesByKey:S,filterByLevel:i,updateNodeByKey:C,getAllKeys:t,getChildrenKeys:b,getEnabledKeys:p,getSelectedNode:E}}function Rt(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ze(e)}const Wt=Ae({name:"BasicTree",inheritAttrs:!1,props:Dt,emits:Ft,setup(e,{attrs:n,slots:t,emit:p,expose:b}){const[C]=Te("tree"),i=pe({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),g=pe({startSearch:!1,searchText:"",searchData:[]}),S=Ce([]),[K]=At(),E=M(()=>{const{fieldNames:a}=e;return B({children:"children",title:"title",key:"key"},a)}),f=M(()=>{let a=le(B(B({blockNode:!0},n),e),{expandedKeys:i.expandedKeys,selectedKeys:i.selectedKeys,checkedKeys:i.checkedKeys,checkStrictly:i.checkStrictly,fieldNames:c(E),"onUpdate:expandedKeys":h=>{i.expandedKeys=h,p("update:expandedKeys",h)},"onUpdate:selectedKeys":h=>{i.selectedKeys=h,p("update:selectedKeys",h)},onCheck:(h,x)=>{let m=Y(i.checkedKeys);if(bt(m)&&g.startSearch){const A=x.node.eventKey;m=ct(m,G(A)),x.checked&&m.push(A),i.checkedKeys=m}else i.checkedKeys=h;const k=Y(i.checkedKeys);p("update:value",k),p("check",k,x)},onRightClick:Le});return st(a,"treeData","class")}),r=M(()=>g.startSearch?g.searchData:c(S)),s=M(()=>!r.value||r.value.length===0),{deleteNodeByKey:o,insertNodeByKey:l,insertNodesByKey:u,filterByLevel:d,updateNodeByKey:y,getAllKeys:L,getChildrenKeys:G,getEnabledKeys:R,getSelectedNode:Ee}=jt(S,E);function Ke(a,h){return!h&&e.renderIcon&&Z(e.renderIcon)?e.renderIcon(a):h}function Le(x){return de(this,arguments,function*({event:a,node:h}){var N;const{rightMenuList:m=[],beforeRightClick:k}=e;let A={event:a,items:[]};if(k&&Z(k)){let _=yield k(h,a);Array.isArray(_)?A.items=_:Object.assign(A,_)}else A.items=m;(N=A.items)!=null&&N.length&&(A.items=A.items.filter(_=>!_.hidden),K(A))})}function z(a){i.expandedKeys=a}function we(){return i.expandedKeys}function re(a){i.selectedKeys=a}function _e(){return i.selectedKeys}function ae(a){i.checkedKeys=a}function ve(){return i.checkedKeys}function se(a){i.checkedKeys=a?R():[]}function X(a){i.expandedKeys=a?L():[]}function Oe(a){i.checkStrictly=a}j(()=>e.searchValue,a=>{a!==g.searchText&&(g.searchText=a)},{immediate:!0}),j(()=>e.treeData,a=>{a&&W(g.searchText)});function W(a){if(a!==g.searchText&&(g.searchText=a),p("update:searchValue",a),!a){g.startSearch=!1;return}const{filterFn:h,checkable:x,expandOnSearch:m,checkOnSearch:k,selectedOnSearch:A}=c(e);g.startSearch=!0;const{title:N,key:_}=c(E),O=[];if(g.searchData=pt(c(S),v=>{var V,H;const F=h?h(a,v,c(E)):(H=(V=v[N])==null?void 0:V.includes(a))!=null?H:!1;return F&&O.push(v[_]),F},c(E)),m){const v=yt(g.searchData).map(F=>F[_]);v&&v.length&&z(v)}k&&x&&O.length&&ae(O),A&&O.length&&re(O)}function Ne(a,h){if(!(!e.clickRowToExpand||!h||h.length===0))if(!i.expandedKeys.includes(a))z([...i.expandedKeys,a]);else{const x=[...i.expandedKeys],m=x.findIndex(k=>k===a);m!==-1&&x.splice(m,1),z(x)}}U(()=>{S.value=e.treeData}),We(()=>{const a=parseInt(e.defaultExpandLevel);a>0?i.expandedKeys=d(a):e.defaultExpandAll&&X(!0)}),U(()=>{i.expandedKeys=e.expandedKeys}),U(()=>{i.selectedKeys=e.selectedKeys}),U(()=>{i.checkedKeys=e.checkedKeys}),j(()=>e.value,()=>{i.checkedKeys=Y(e.value||e.checkedKeys||[])},{immediate:!0}),j(()=>i.checkedKeys,()=>{const a=Y(i.checkedKeys);p("update:value",a),p("change",a)}),U(()=>{i.checkStrictly=e.checkStrictly});const Fe={setExpandedKeys:z,getExpandedKeys:we,setSelectedKeys:re,getSelectedKeys:_e,setCheckedKeys:ae,getCheckedKeys:ve,insertNodeByKey:l,insertNodesByKey:u,deleteNodeByKey:o,updateNodeByKey:y,getSelectedNode:Ee,checkAll:se,expandAll:X,filterByLevel:a=>{i.expandedKeys=d(a)},setSearchValue:a=>{W(a)},getSearchValue:()=>g.searchText};function De(a){const{actionList:h}=e;if(!(!h||h.length===0))return h.map((x,m)=>{var A;let k=!0;return Z(x.show)?k=(A=x.show)==null?void 0:A.call(x,a):be(x.show)&&(k=x.show),k?T("span",{key:m,class:C("action")},[x.render(a)]):null})}const Me=M(()=>{const a=ee(r.value);return gt(a,(h,x)=>{var ie;const m=g.searchText,{highlight:k}=c(e),{title:A,key:N,children:_}=c(E),O=Ke(h,h.icon),v=lt(h,A),F=m?v.indexOf(m):-1,V=g.startSearch&&!St(m)&&k&&F!==-1,H=`color: ${be(k)?"#f50":k}`,Be=V?T("span",{class:(ie=c(f))!=null&&ie.blockNode?`${C("content")}`:""},[T("span",null,[v.substr(0,F)]),T("span",{style:H},[m]),T("span",null,[v.substr(F+m.length)])]):v;return h[A]=T("span",{class:`${C("title")} pl-2`,onClick:Ne.bind(null,h[N],h[_])},[t!=null&&t.title?xt(t,"title",h):T(Q,null,[O&&T(Pt,{icon:O},null),Be,T("span",{class:C("actions")},[De(h)])])]),h}),a});return b(Fe),()=>{let a;const{title:h,helpMessage:x,toolbar:m,search:k,checkable:A}=e,N=h||m||k||t.headerTitle,_={height:"calc(100% - 38px)"};return T("div",{class:[C(),"h-full",n.class]},[N&&T(Bt,{checkable:A,checkAll:se,expandAll:X,title:h,search:k,toolbar:m,helpMessage:x,onStrictlyChange:Oe,onSearch:W,onClickSearch:O=>p("search",O),searchText:g.searchText},Rt(a=mt(t))?a:{default:()=>[a]}),T(it,{spinning:c(e.loading),tip:"加载中..."},{default:()=>[ye(T(kt,{style:_},{default:()=>[T(ot,Je(c(f),{showIcon:!1,treeData:Me.value}),null)]}),[[ge,!c(s)]]),ye(T(me,{image:me.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[ge,c(s)]])]})])}}});export{Wt as _};
