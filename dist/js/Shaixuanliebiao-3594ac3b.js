var te=Object.defineProperty,le=Object.defineProperties;var ie=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var j=(e,l,s)=>l in e?te(e,l,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[l]=s,_=(e,l)=>{for(var s in l||(l={}))oe.call(l,s)&&j(e,s,l[s]);if(N)for(var s of N(l))ae.call(l,s)&&j(e,s,l[s]);return e},$=(e,l)=>le(e,ie(l));var P=(e,l,s)=>new Promise((n,k)=>{var F=m=>{try{f(s.next(m))}catch(y){k(y)}},p=m=>{try{f(s.throw(m))}catch(y){k(y)}},f=m=>m.done?n(m.value):Promise.resolve(m.value).then(F,p);f((s=s.apply(e,l)).next())});import{d as se,r as Q,e as q,f as V,w as J,H as ne,I as z,a3 as ue,a4 as de,a5 as u,V as r,a6 as C,a7 as h,ak as B,k as a,ai as c,E as b,W as O,af as re,F as H,am as ce}from"./vue-vendor-24c7dc61.js";import{u as pe}from"./useFieldSelect-1dde1da7.js";import{aC as fe,n as Fe,c0 as me,cd as ve,cm as Ce,a$ as he,be as ye}from"./antd-vue-vendor-0d72f01e.js";import{a5 as W,l as ge}from"./index-831af9dd.js";import{C as _e}from"./ComponentIcon-f1bbb90f.js";import{p as Be}from"./auto.desform.api-839115ed.js";import"./type.definition-4eb605ee.js";import"./vxe-table-vendor-8813019a.js";const be="/assets/shaixuanliebiao-05e19d85.png",De=se({name:"Shaixuanliebiao",props:{columnList:{type:Array,default:()=>[]},info:{type:Object,require:!1,default:{}}},components:{PlusOutlined:fe,SearchOutlined:Fe,DownSquareOutlined:me,ApartmentOutlined:ve,SaveOutlined:Ce,DeleteOutlined:he,QuestionCircleFilled:ye,ComponentIcon:_e},emits:["save"],setup(e,{emit:l}){const s={title:"筛选列表",tip:"将所选字段选项以列表的形式显示在视图左侧，帮助用户快速查看记录，支持下拉、关联记录和下拉树字段。"},n=Q({leftFilterField:"",leftFilterData:"all",leftFilterCondition:"",leftFilterOrder:"desc",addFormDefaultStatus:!1}),k=q({get(){return n.leftFilterCondition?n.leftFilterCondition.split(","):[]},set(t){t.length>0?n.leftFilterCondition=t.join(","):n.leftFilterCondition=""}}),F=Q({dictCode:"",dictTable:"",dictText:"",staticOptions:[],type:""}),p=V([]),f=V(!1),m=q(()=>f.value!=!0);J(()=>e.info,t=>{if(Object.keys(n).map(o=>{n[o]=t[o]}),t.leftFilterField&&e.columnList){let o=e.columnList.filter(d=>d.model==t.leftFilterField);if(o.length>0){let d=o[0],v=d.options;D(v?$(_({},d),{staticOptions:v}):_({},d))}}},{immediate:!0,deep:!0});const y="link-record,table-dict,radio,select,select-tree",{selectFieldList:w,getColumnInfo:S,filterValue:E,isFilterItem:T,showPop:A,myFilter:I}=pe(e,{type:y,remote:!1});function L(t){n.leftFilterField=t.value,D(t)}function R(){}function D(t){f.value=t.type=="select-tree",t.type==="link-record"?(F.dictText=t.titleField,F.dictTable=t.code):(F.dictText=t.dictText,F.dictTable=t.dictTable,F.dictCode=t.dictCode,F.staticOptions=t.staticOptions),F.type=t.type}J(F,t=>P(this,null,function*(){if(t.type==="link-record"){let o=yield x(t.dictTable,t.dictText);p.value=o}else if(t.dictTable&&t.dictText&&t.dictCode){let o=`${t.dictTable},${t.dictText},${t.dictCode}`,d=yield W(o);p.value=d}else if(t.dictCode){let o=yield W(t.dictCode);p.value=o}else if(t.staticOptions&&t.staticOptions.length>0){let o=[],d=t.staticOptions;for(let v of d)o.push({value:v.value,label:v.value});p.value=o}else p.value=[]}),{deep:!0,immediate:!0});function i(t){if(t.length>0){let o=t[t.length-1],d=e.columnList.filter(v=>v.model===o||v.key===o);d.length>0&&D(d[0]),n.leftFilterField=o}else n.leftFilterField="";g.value.blur()}const g=V();function K(){n.leftFilterField="";let t=z(n);Object.keys(t).map(o=>{t[o]=""}),t.addFormDefaultStatus=!0,l("save",_({},t))}const M=[{value:"all",label:"全部"},{value:"exist",label:"显示有数据的项"},{value:"part",label:"显示指定的项"}],X=[{value:"asc",label:"升序"},{value:"desc",label:"降序"}];function Y(){let t=z(n);l("save",_({},t))}function Z(t){t=="part"}function x(t,o){return P(this,null,function*(){let d=yield Be.list({pageSize:100,desformCode:t}),v=[];return d.result.records.forEach(U=>{let ee=JSON.parse(U.desformDataJson);v.push({value:U.id,label:ee[o]})}),v})}return $(_(_({},ne(n)),s),{selectRef:g,filterValue:E,isFilterItem:T,showPop:A,selectFieldList:w,getColumnInfo:S,onSelectField:L,onAdd:R,saveCondition:Y,myFilter:I,handleChange:i,noDataImage:be,dataFilterOptions:M,orderOptions:X,onRemoveField:K,selectPartDataList:p,onChange:Z,partCondition:k,showDataFilterConfig:m,isTreeField:f})}});const G=e=>(ue("data-v-95ce64f7"),e=e(),de(),e),Oe={class:"inner-content"},ke={key:0},Ee={class:"title"},we={class:"tip"},Se={class:"config-detail",style:{width:"320px","padding-top":"20px"}},Te={class:"label",style:{display:"flex","justify-content":"space-between"}},Ae=G(()=>u("div",null,"筛选字段",-1)),Ie={class:"config-item"},Le={key:0,class:"label"},Re={key:1,class:"config-item"},$e={key:0,style:{"margin-top":"5px",width:"100%"}},Pe={key:2,class:"label"},Ve={key:3,class:"config-item"},Ue=G(()=>u("div",{class:"label"},"设置",-1)),Ne={class:"config-item"},je={style:{margin:"10px 0 0 5px"}},Qe={class:"tip"},qe={class:"field-list"},Je=["onClick"];function ze(e,l,s,n,k,F){const p=r("component-icon"),f=r("a-select"),m=r("a-checkbox"),y=r("QuestionCircleFilled"),w=r("a-tooltip"),S=r("SaveOutlined"),E=r("a-button"),T=r("DeleteOutlined"),A=r("SearchOutlined"),I=r("a-input"),L=r("PlusOutlined"),R=r("a-popover"),D=r("a-empty");return C(),h("div",Oe,[e.leftFilterField?(C(),h("div",ke,[u("div",Ee,B(e.title),1),u("div",we,B(e.tip),1),u("div",Se,[u("div",null,[u("div",Te,[Ae,u("div",{onClick:l[0]||(l[0]=(...i)=>e.onRemoveField&&e.onRemoveField(...i)),class:"clear-text"})]),u("div",Ie,[a(f,{"show-search":"",ref:"selectRef",placeholder:"请选择字段",style:{width:"100%"},options:e.selectFieldList,"filter-option":e.myFilter,mode:"tags",onChange:e.handleChange,value:e.leftFilterField,"onUpdate:value":l[1]||(l[1]=i=>e.leftFilterField=i)},{option:c(({label:i,type:g})=>[a(p,{type:g},null,8,["type"]),b(" "+B(i),1)]),tagRender:c(({label:i,option:g})=>[a(p,{type:g.type,style:{margin:"0 5px"}},null,8,["type"]),b(" "+B(i),1)]),_:1},8,["options","filter-option","onChange","value"])]),e.showDataFilterConfig?(C(),h("div",Le,"显示项 ")):O("",!0),e.showDataFilterConfig?(C(),h("div",Re,[a(f,{style:{width:"100%"},options:e.dataFilterOptions,value:e.leftFilterData,"onUpdate:value":l[2]||(l[2]=i=>e.leftFilterData=i),onChange:e.onChange},null,8,["options","value","onChange"]),e.leftFilterData=="part"?(C(),h("div",$e,[a(f,{value:e.partCondition,"onUpdate:value":l[3]||(l[3]=i=>e.partCondition=i),"show-search":"",maxTagCount:3,mode:"multiple",placeholder:"请选择字段",style:{width:"100%",cursor:"pointer"},options:e.selectPartDataList,"filter-option":e.myFilter},null,8,["value","options","filter-option"])])):O("",!0)])):O("",!0),e.showDataFilterConfig?(C(),h("div",Pe,"排序方式 ")):O("",!0),e.showDataFilterConfig?(C(),h("div",Ve,[a(f,{style:{width:"100%"},options:e.orderOptions,value:e.leftFilterOrder,"onUpdate:value":l[4]||(l[4]=i=>e.leftFilterOrder=i)},null,8,["options","value"])])):O("",!0),Ue,u("div",Ne,[a(m,{checked:e.addFormDefaultStatus,"onUpdate:checked":l[5]||(l[5]=i=>e.addFormDefaultStatus=i)},{default:c(()=>[b("创建记录时，以选中列表作为默认值")]),_:1},8,["checked"]),a(w,{title:"如：在商品表中以商品类型（生鲜、副食、饮料等）作为筛选列表时，如果当前选中了饮料分类，则创建记录时商品类型默认为饮料。"},{default:c(()=>[a(y,{style:{color:"#9e9e9e"}})]),_:1})])]),u("div",je,[a(E,{onClick:e.saveCondition,style:{"border-radius":"20px"},type:"primary"},{default:c(()=>[a(S),b("保 存 ")]),_:1},8,["onClick"]),a(E,{onClick:e.onRemoveField,style:{"border-radius":"20px","margin-left":"20px"}},{default:c(()=>[a(T),b("清除 ")]),_:1},8,["onClick"])])])])):(C(),re(D,{key:1,class:"no-data",image:e.noDataImage,"image-style":{height:"222px",marginTop:"50px"}},{description:c(()=>[u("span",null,[u("h6",null,B(e.title),1),u("div",Qe,B(e.tip),1)])]),default:c(()=>[a(R,{overlayClassName:"view-pop-field-select",open:e.showPop,"onUpdate:open":l[7]||(l[7]=i=>e.showPop=i),trigger:"click"},{content:c(()=>[u("div",qe,[(C(!0),h(H,null,ce(e.selectFieldList,i=>(C(),h(H,null,[e.isFilterItem(i)?(C(),h("div",{key:0,class:"field-item",onClick:g=>e.onSelectField(i)},[u("div",null,[a(p,{type:i.type},null,8,["type"]),b(B(i.label),1)])],8,Je)):O("",!0)],64))),256))])]),title:c(()=>[a(I,{placeholder:"搜索字段",class:"my-input",value:e.filterValue,"onUpdate:value":l[6]||(l[6]=i=>e.filterValue=i)},{prefix:c(()=>[a(A,{style:{color:"#c0c0c0"}})]),_:1},8,["value"])]),default:c(()=>[a(E,{type:"primary",style:{"border-radius":"15px"}},{default:c(()=>[a(L),b("选择字段 ")]),_:1})]),_:1},8,["open"])]),_:1},8,["image"]))])}const et=ge(De,[["render",ze],["__scopeId","data-v-95ce64f7"]]);export{et as default};
