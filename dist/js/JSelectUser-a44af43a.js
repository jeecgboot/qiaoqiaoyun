var G=Object.defineProperty,N=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var $=(e,t,l)=>t in e?G(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,U=(e,t)=>{for(var l in t||(t={}))W.call(t,l)&&$(e,l,t[l]);if(L)for(var l of L(t))Z.call(t,l)&&$(e,l,t[l]);return e},J=(e,t)=>N(e,q(t));import{d as K,f as d,u as I,w as V,V as p,a6 as P,a7 as z,k as r,ag as _,ai as v,a5 as Q,r as X,p as O,h as Y}from"./vue-vendor-24c7dc61.js";import{Z as ee,_ as te,j as ae,q as j,aC as k,l as A,H as x,e as le}from"./index-831af9dd.js";import{B as ne}from"./index-1c3affea.js";import{u as se}from"./useSelectBiz-2f560b0b.js";import{s as oe}from"./props-8a7ac45b.js";import{J as ie}from"./JSelectBiz-55a9591f.js";import{u as re}from"./useFormItem-86503382.js";const ce=K({name:"UserSelectModal",components:{BasicModal:ne,BasicTable:ee(()=>te(()=>import("./BasicTable-d435f501.js"),["js/BasicTable-d435f501.js","js/vue-vendor-24c7dc61.js","js/antd-vue-vendor-0d72f01e.js","js/index-52c8c841.js","js/useForm-14b2bc77.js","js/componentMap-c857637c.js","js/index-831af9dd.js","js/vxe-table-vendor-8813019a.js","assets/index-3d0fbd8d.css","js/useFormItem-86503382.js","js/index-1c3affea.js","js/BasicModal-58413bab.js","js/useWindowSizeFn-8f085f6f.js","assets/BasicModal-d929f5ce.css","assets/index-ad7edbf1.css","js/download-1ac6acce.js","js/index-f99b266a.js","assets/index-15cc10f8.css","js/useSelectBiz-2f560b0b.js","js/props-8a7ac45b.js","js/JSelectBiz-55a9591f.js","assets/JSelectBiz-ba37f0a8.css","js/JImageUpload-d644253a.js","assets/JImageUpload-d7ba7f20.css","js/JDictSelectTag-54dc3bdb.js","assets/JDictSelectTag-72919d86.css","js/JSelectDept-a90caee3.js","js/index-f2fd5a28.js","js/useContextMenu-810f9346.js","assets/useContextMenu-aed8cfe5.css","assets/index-a95e0833.css","assets/JSelectDept-2ce3f5d2.css","js/areaDataUtil-cdeee717.js","js/china-area-data-vendor-556d14ee.js","js/JPopup-2a779923.js","js/useMethods-f689b480.js","assets/JPopup-2f2ed00d.css","js/JCheckbox-0b89d32a.js","assets/JCheckbox-ce9c44dd.css","js/JSelectUserByDept-bd619076.js","js/UserSelectByDepModal-db060ece.js","js/depart.api-339f4da6.js","assets/JSelectUserByDept-f5671717.css","js/JUpload-76e119c7.js","js/index-d508f1f4.js","assets/index-27837f17.css","assets/JUpload-557f03ea.css","js/index-6507b9cd.js","js/index-4d0525a5.js","js/UserSelectModal-d78c1490.js","assets/UserSelectModal-aaef1bbb.css","assets/index-89763e09.css","assets/componentMap-2e742ecf.css","js/helper-22dafba0.js","assets/useForm-9101c3b7.css","js/JAreaLinkage-173780c9.js","js/JCodeEditor-66bd225e.js","js/codemirror-17b6f671.js","js/codemirror-26b29690.js","js/active-line-512fef49.js","assets/active-line-8a3c1e84.css","assets/JCodeEditor-d0a9ffd7.css","js/EasyCronInput-b2123242.js","assets/EasyCronInput-0e4d0046.css","js/JEditor-249b2194.js","js/index-b845562c.js","assets/BasicTable-adf414bd.css"]),{loading:!0})},props:J(U({},oe),{modalTitle:{type:String,default:"选择用户"},excludeUserIdList:{type:Array,default:[]}}),emits:["register","getSelectResult"],setup(e,{emit:t,refs:l}){const u=d({x:!1}),o=d(),[c,{closeModal:s}]=ae(()=>{window.innerWidth<900?u.value={x:900}:u.value={x:!1},setTimeout(()=>{o.value&&o.value.setSelectedRowKeys(C.value||[])},800)}),a=j(),h={canResize:!1,bordered:!0,size:"small"},f=Object.assign({},I(e),I(a),h),[{rowSelection:m,visibleChange:g,selectValues:C,indexColumnProps:y,getSelectResult:b,handleDeleteSelected:R,selectRows:B}]=se(k,f),n=d(e.params);V(m.selectedRowKeys,i=>{o.value&&o.value.setSelectedRowKeys(i)});const w={baseColProps:{xs:24,sm:8,md:6,lg:8,xl:6,xxl:6},actionColOptions:{xs:24,sm:8,md:8,lg:8,xl:8,xxl:8},schemas:[{label:"账号",field:"username",component:"JInput"},{label:"姓名",field:"realname",component:"JInput"}]},E=[{title:"用户账号",dataIndex:"username",width:120,align:"left"},{title:"用户姓名",dataIndex:"realname",width:120},{title:"性别",dataIndex:"sex_dictText",width:50},{title:"手机号码",dataIndex:"phone",width:120},{title:"邮箱",dataIndex:"email"},{title:"状态",dataIndex:"status_dictText",width:80}],F={pagination:!1,showIndexColumn:!1,scroll:{y:390},size:"small",canResize:!1,bordered:!0,rowKey:"id",columns:[{title:"用户姓名",dataIndex:"realname",width:40},{title:"操作",dataIndex:"action",align:"center",width:40,slots:{customRender:"action"}}]};function D(){b((i,S)=>{t("getSelectResult",i,S),s()})}function H(i){let S=e.excludeUserIdList;if(!S)return i;let T=[];if(S.length>0&&i&&i.length>0){for(let M of i)S.indexOf(M.id)<0&&T.push(U({},M));return T}return i}return{handleOk:D,searchInfo:n,register:c,indexColumnProps:y,visibleChange:g,getBindValue:f,getUserList:k,formConfig:w,columns:E,rowSelection:m,selectRows:B,selectedTable:F,handleDeleteSelected:R,tableScroll:u,tableRef:o,afterFetch:H}}}),de=["onClick"];function ue(e,t,l,u,o,c){const s=p("BasicTable"),a=p("a-col"),h=p("Icon"),f=p("a-row"),m=p("BasicModal");return P(),z("div",null,[r(m,_(e.$attrs,{onRegister:e.register,title:e.modalTitle,width:e.showSelected?"1200px":"900px",wrapClassName:"j-user-select-modal",onOk:e.handleOk,destroyOnClose:"",onVisibleChange:e.visibleChange}),{default:v(()=>[r(f,null,{default:v(()=>[r(a,{span:e.showSelected?18:24},{default:v(()=>[r(s,_({ref:"tableRef",columns:e.columns,scroll:e.tableScroll},e.getBindValue,{useSearchForm:!0,formConfig:e.formConfig,api:e.getUserList,searchInfo:e.searchInfo,rowSelection:e.rowSelection,indexColumnProps:e.indexColumnProps,afterFetch:e.afterFetch}),{tableTitle:v(()=>[]),_:1},16,["columns","scroll","formConfig","api","searchInfo","rowSelection","indexColumnProps","afterFetch"])]),_:1},8,["span"]),r(a,{span:e.showSelected?6:0},{default:v(()=>[r(s,_(e.selectedTable,{dataSource:e.selectRows,useSearchForm:!0,formConfig:{showActionButtonGroup:!1,baseRowStyle:{minHeight:"40px"}}}),{action:v(({record:g})=>[Q("a",{href:"javascript:void(0)",onClick:C=>e.handleDeleteSelected(g)},[r(h,{icon:"ant-design:delete-outlined"})],8,de)]),_:1},16,["dataSource"])]),_:1},8,["span"])]),_:1})]),_:1},16,["onRegister","title","width","onOk","onVisibleChange"])])}const fe=A(ce,[["render",ue]]),me=K({name:"JSelectUser",components:{UserSelectModal:fe,JSelectBiz:ie},inheritAttrs:!1,props:{value:x.oneOfType([x.string,x.array]),labelKey:{type:String,default:"realname"},rowKey:{type:String,default:"username"},params:{type:Object,default:()=>{}},excludeUserIdList:{type:Array,default:()=>[]}},emits:["options-change","change","update:value"],setup(e,{emit:t}){const l=d(),[u,{openModal:o}]=le(),[c]=re(e,"value","change",l),s=d([]);let a=X({value:[],change:!1});const h=d(!1);O("selectOptions",s),O("selectValues",a),O("loadingEcho",h);const f=d(!1),m=j();Y(()=>{e.value&&y(),e.value||(a.value=[])}),V(a,()=>{a&&(c.value=a.value)});const g=d([]);V(()=>e.excludeUserIdList,n=>{g.value=n},{immediate:!0});function C(){f.value=!0,o(!0,{isUpdate:!1})}function y(){let n=e.value?e.value:[];n&&typeof n=="string"&&n!="null"&&n!="undefined"?(c.value=n.split(","),a.value=n.split(",")):a.value=n}function b(n,w){s.value=n,c.value=w,a.value=w,t("update:value",w.join(","))}const R=Object.assign({},I(e),I(m));function B(n){t("update:value",n)}return{state:c,attrs:m,selectOptions:s,getBindValue:R,selectValues:a,loadingEcho:h,tag:f,regModal:u,setValue:b,handleOpen:C,excludeUserIdList:g,handleChange:B}}});function pe(e,t,l,u,o,c){const s=p("JSelectBiz"),a=p("UserSelectModal");return P(),z("div",null,[r(s,_({onChange:e.handleChange,onHandleOpen:e.handleOpen,loading:e.loadingEcho},e.attrs),null,16,["onChange","onHandleOpen","loading"]),r(a,_({rowKey:e.rowKey,onRegister:e.regModal,onGetSelectResult:e.setValue},e.getBindValue,{excludeUserIdList:e.excludeUserIdList}),null,16,["rowKey","onRegister","onGetSelectResult","excludeUserIdList"])])}const ye=A(me,[["render",pe],["__scopeId","data-v-00f5e96f"]]);export{ye as J,fe as U};
