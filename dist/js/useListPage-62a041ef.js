var A=Object.defineProperty,F=Object.defineProperties;var I=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var T=(e,r,t)=>r in e?A(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,y=(e,r)=>{for(var t in r||(r={}))L.call(r,t)&&T(e,t,r[t]);if(O)for(var t of O(r))M.call(r,t)&&T(e,t,r[t]);return e},v=(e,r)=>F(e,I(r));var R=(e,r,t)=>new Promise((h,s)=>{var f=l=>{try{u(t.next(l))}catch(d){s(d)}},a=l=>{try{u(t.throw(l))}catch(d){s(d)}},u=l=>l.done?h(l.value):Promise.resolve(l.value).then(f,a);u((t=t.apply(e,r)).next())});import{u as X,f as j,r as k}from"./vue-vendor-24c7dc61.js";import{A as E}from"./antd-vue-vendor-0d72f01e.js";import{u as K}from"./index-621e597c.js";import{a as D,h as U,L as W}from"./index-831af9dd.js";import{u as $}from"./useMethods-f689b480.js";const{handleExportXls:q,handleImportXls:z}=$();function Q(e){const r=D();let t={};e.designScope&&(t=U(e.designScope));const h=B(e.tableProps),[,{getForm:s,reload:f,setLoading:a},{selectedRowKeys:u}]=h;function l(){return R(this,null,function*(){var g;let{url:i,name:n,params:w}=(g=e==null?void 0:e.exportConfig)!=null?g:{},m=typeof i=="function"?i():i;if(m){let b=typeof n=="function"?n():n,o={};try{o=yield s().validate()}catch(x){}return o!=null&&o.column||Object.assign(o,{column:"createTime",order:"desc"}),w&&Object.keys(w).map(x=>{let C=w[x];C&&(o[x]=X(C))}),u.value&&u.value.length>0&&(o.selections=u.value.join(",")),q(b,m,W(o))}else return r.createMessage.warn("没有传递 exportConfig.url 参数"),Promise.reject()})}function d(i){var g;let{url:n,success:w}=(g=e==null?void 0:e.importConfig)!=null?g:{},m=typeof n=="function"?n():n;return m?z(i,m,w||f):(r.createMessage.warn("没有传递 importConfig.url 参数"),Promise.reject())}function S(i,n){return new Promise((w,m)=>{var b;const g=()=>R(this,null,function*(){var o,x;try{a(!0);const C=yield i();((o=n==null?void 0:n.reload)==null||o)&&f(),((x=n==null?void 0:n.clearSelection)==null||x)&&(u.value=[]),w(C)}catch(C){m(C)}finally{a(!1)}});(b=n==null?void 0:n.confirm)==null||b?r.createConfirm({iconType:"warning",title:"删除",content:"确定要删除吗？",onOk:()=>g(),onCancel:()=>m()}):g()})}function c(i){return S(i,{confirm:!1,clearSelection:!1})}return v(y(y({},t),r),{onExportXls:l,onImportXls:d,doRequest:S,doDeleteRecord:c,tableContext:h})}function B(e){var l,d,S;const r={xs:24,sm:12,md:12,lg:8,xl:8,xxl:6},t={rowKey:"id",useSearchForm:!0,formConfig:{compact:!0,autoSubmitOnEnter:!0,rowProps:{gutter:8},baseColProps:y({},r),labelCol:{xs:24,sm:8,md:6,lg:8,xl:6,xxl:6},wrapperCol:{},showAdvancedButton:!0,autoAdvancedCol:3,actionColOptions:v(y({},r),{style:{textAlign:"left"}})},striped:!1,canResize:!0,minHeight:500,clickToRowSelect:!1,bordered:!0,showIndexColumn:!1,showTableSetting:!0,tableSetting:{fullScreen:!1},showActionColumn:!0,actionColumn:{width:120,title:"操作",fixed:!1,dataIndex:"action",slots:{customRender:"action"}}};e&&E(t,e);function h(c){return Object.assign({column:"createTime",order:"desc"},c)}Object.assign(t,{beforeFetch:h}),typeof e.beforeFetch=="function"&&(t.beforeFetch=function(c){return c=h(c),e.beforeFetch(c),c});const s=j([]),f=j([]),a=(l=e==null?void 0:e.rowSelection)!=null?l:{},u=k(v(y({},a),{type:(d=a.type)!=null?d:"checkbox",columnWidth:(S=a.columnWidth)!=null?S:50,selectedRows:f,selectedRowKeys:s,onChange(...c){s.value=c[0],f.value=c[1],typeof a.onChange=="function"&&a.onChange(...c)}}));return delete t.rowSelection,[...K(t),{selectedRows:f,selectedRowKeys:s,rowSelection:u}]}export{Q as u};
