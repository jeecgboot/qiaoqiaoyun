var U=Object.defineProperty;var _=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var v=(t,e,o)=>e in t?U(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,w=(t,e)=>{for(var o in e||(e={}))V.call(e,o)&&v(t,o,e[o]);if(_)for(var o of _(e))T.call(e,o)&&v(t,o,e[o]);return t};var f=(t,e,o)=>new Promise((u,s)=>{var p=r=>{try{a(o.next(r))}catch(l){s(l)}},m=r=>{try{a(o.throw(r))}catch(l){s(l)}},a=r=>r.done?u(r.value):Promise.resolve(r.value).then(p,m);a((o=o.apply(t,e)).next())});import{d as R,e as $,u as y,f as q,V as B,a6 as A,af as E,ai as c,k as C,E as h}from"./vue-vendor-24c7dc61.js";import{B as L}from"./BasicModal-58413bab.js";import"./index-52c8c841.js";import"./index-1c3affea.js";import{a as I,d as N}from"./screen.data-747c5235.js";import{q as P,s as j,t as G}from"./screen.api-1b93c7a9.js";import{B as O,u as z}from"./useForm-14b2bc77.js";import{j as H,l as J}from"./index-831af9dd.js";import"./antd-vue-vendor-0d72f01e.js";import"./useWindowSizeFn-8f085f6f.js";import"./componentMap-c857637c.js";import"./useFormItem-86503382.js";import"./download-1ac6acce.js";import"./index-f99b266a.js";import"./JSelectUser-a44af43a.js";import"./useSelectBiz-2f560b0b.js";import"./props-8a7ac45b.js";import"./JSelectBiz-55a9591f.js";import"./JImageUpload-d644253a.js";import"./JDictSelectTag-54dc3bdb.js";import"./JSelectDept-a90caee3.js";import"./index-f2fd5a28.js";import"./useContextMenu-810f9346.js";import"./areaDataUtil-cdeee717.js";import"./china-area-data-vendor-556d14ee.js";import"./JPopup-2a779923.js";import"./useMethods-f689b480.js";import"./JCheckbox-0b89d32a.js";import"./vxe-table-vendor-8813019a.js";import"./JSelectUserByDept-bd619076.js";import"./UserSelectByDepModal-db060ece.js";import"./depart.api-339f4da6.js";import"./JUpload-76e119c7.js";import"./index-d508f1f4.js";import"./index-6507b9cd.js";import"./index-4d0525a5.js";import"./UserSelectModal-d78c1490.js";import"./JAreaLinkage-173780c9.js";import"./JCodeEditor-66bd225e.js";import"./codemirror-17b6f671.js";import"./codemirror-26b29690.js";import"./active-line-512fef49.js";import"./EasyCronInput-b2123242.js";import"./JEditor-249b2194.js";import"./index-b845562c.js";import"./helper-22dafba0.js";const K=R({name:"ScreenDataSourceModal",components:{BasicModal:L,BasicForm:O},setup(t,{emit:e}){const o=$(()=>y(d)?"编辑数据源":"新增数据源"),[u,{resetFields:s,setFieldsValue:p,validate:m,updateSchema:a,clearValidate:r,getFieldsValue:l}]=z({schemas:I,showActionButtonGroup:!1,labelCol:{span:24},wrapperCol:{span:24}}),d=q(!0),[D,{setModalProps:g,closeModal:b}]=H(i=>f(this,null,function*(){if(yield s(),g({confirmLoading:!1}),d.value=!!(i!=null&&i.isUpdate),y(d)){let n=yield P({id:i.record.id});n!=null&&(yield p(w({},n)))}a([{field:"dbType",required:!0,componentProps:{onChange:n=>F(n)}}])}));function F(i){let n=N[i-1];n&&(p({dbDriver:n.dbDriver,dbUrl:n.dbUrl}),r(["dbDriver","dbUrl"]))}function M(){return f(this,null,function*(){try{const i=yield m();g({confirmLoading:!0}),yield j(i,d.value),b(),e("success")}finally{g({confirmLoading:!1})}})}function S(){return f(this,null,function*(){let i=yield l();yield G(i)})}function k(){b()}return{registerModal:D,registerForm:u,handleSubmit:M,getTitle:o,testConnection:S,handleCancel:k}}});function Q(t,e,o,u,s,p){const m=B("BasicForm"),a=B("a-button"),r=B("BasicModal");return A(),E(r,{onRegister:t.registerModal,width:600,title:t.getTitle},{footer:c(()=>[C(a,{onClick:t.testConnection},{default:c(()=>[h("测试连接")]),_:1},8,["onClick"]),C(a,{onClick:t.handleSubmit,type:"primary"},{default:c(()=>[h("确定")]),_:1},8,["onClick"]),C(a,{onClick:t.handleCancel},{default:c(()=>[h("取消")]),_:1},8,["onClick"])]),default:c(()=>[C(m,{onRegister:t.registerForm},null,8,["onRegister"])]),_:1},8,["onRegister","title"])}const Oo=J(K,[["render",Q]]);export{Oo as default};
