var Ye=Object.defineProperty,Je=Object.defineProperties;var Ue=Object.getOwnPropertyDescriptors;var Te=Object.getOwnPropertySymbols;var Ge=Object.prototype.hasOwnProperty,Xe=Object.prototype.propertyIsEnumerable;var Pe=(e,a,r)=>a in e?Ye(e,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[a]=r,C=(e,a)=>{for(var r in a||(a={}))Ge.call(a,r)&&Pe(e,r,a[r]);if(Te)for(var r of Te(a))Xe.call(a,r)&&Pe(e,r,a[r]);return e},Se=(e,a)=>Je(e,Ue(a));var I=(e,a,r)=>new Promise((i,w)=>{var b=f=>{try{s(r.next(f))}catch(m){w(m)}},t=f=>{try{s(r.throw(f))}catch(m){w(m)}},s=f=>f.done?i(f.value):Promise.resolve(f.value).then(b,t);s((r=r.apply(e,a)).next())});import{e as $,u as n,d as Be,H as Qe,q as Ze,A as et,k,i as tt,E as ie,ag as X,V as H,a6 as G,af as ee,ap as ce,ai as q,a5 as nt,ae as ot,O as K,ak as pe,W as le,w as oe,I as Ie,h as st,n as Ce,r as Ve,f as U,o as at,at as rt,aq as he,a7 as lt,F as it,am as be,ao as Re,b as ct}from"./vue-vendor-24c7dc61.js";import{aa as de,h as Ae,u as ut,_ as dt,a8 as Oe,i as ve,s as ft,aN as mt,a9 as pt}from"./antd-vue-vendor-0d72f01e.js";import{j as De}from"./componentMap-c857637c.js";import{ac as Ne,z as E,W as ne,as as ht,o as $e,at as bt,au as yt,an as Me,v as gt,x as At,av as vt,aw as wt,H as V,l as Ee,ax as Y,ay as se,P as fe,O as ue,az as Ft,aA as Bt,D as xe,K as we,C as We,aB as _e,Q as Fe,h as Ct,I as Le,J as Ot}from"./index-831af9dd.js";import{c as ke,s as jt,h as Tt,a as Pt,d as qe}from"./helper-22dafba0.js";import"./index-1c3affea.js";import{u as St}from"./BasicModal-58413bab.js";function It(e,a){return $(()=>{const r=n(e),{labelCol:i={},wrapperCol:w={}}=r.itemProps||{},{labelWidth:b,disabledLabelWidth:t}=r,{labelWidth:s,labelCol:f,wrapperCol:m,layout:T}=n(a);if(t)return{labelCol:i,wrapperCol:w};if(!s&&!b&&!f)return i.style={textAlign:"left"},{labelCol:i,wrapperCol:w};let A=b||s;const j=C(C({},f),i),x=C(C({},m),w);return A&&(A=Ne(A)?`${A}px`:A),{labelCol:C({style:{width:A||"100%"}},j),wrapperCol:C({style:{width:T==="vertical"?"100%":`calc(100% - ${A})`}},x)}})}function ye(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!tt(e)}const Vt=Be({name:"BasicFormItem",inheritAttrs:!1,props:{schema:{type:Object,default:()=>({})},formProps:{type:Object,default:()=>({})},allDefaultValues:{type:Object,default:()=>({})},formModel:{type:Object,default:()=>({})},setFormModel:{type:Function,default:null},validateFields:{type:Function,default:null},tableAction:{type:Object},formActionType:{type:Object}},setup(e,{slots:a}){const{t:r}=$e(),{schema:i,formProps:w}=Qe(e),b=It(i,w),t=$(()=>{const{allDefaultValues:d,formModel:c,schema:F}=e,{mergeDynamicData:g}=e.formProps;return{field:F.field,model:c,values:C(C(C({},g),d),c),schema:F}}),s=$(()=>{var v;const{schema:d,tableAction:c,formModel:F,formActionType:g}=e;let{componentProps:p={}}=d;return E(p)&&(p=(v=p({schema:d,tableAction:c,formModel:F,formActionType:g}))!=null?v:{}),d.component==="Divider"&&(p=Object.assign({type:"horizontal",orientation:"left",plain:!0},p)),p}),f=$(()=>{const{disabled:d}=e.formProps,{dynamicDisabled:c}=e.schema,{disabled:F=!1}=n(s);let g=!!d||F;return ne(c)&&(g=c),E(c)&&(g=c(n(t))),g}),m=$(()=>{const{dynamicPropsVal:d,dynamicPropskey:c}=e.schema;if(c==null)return null;{const{[c]:F}=n(s);let g=F;if(E(d))return g=d(n(t)),g}});function T(){const{show:d,ifShow:c}=e.schema,{showAdvancedButton:F}=e.formProps,g=F&&ne(e.schema.isAdvanced)?e.schema.isAdvanced:!0;let p=!0,v=!0;return ne(d)&&(p=d),ne(c)&&(v=c),E(d)&&(p=d(n(t))),E(c)&&(v=c(n(t))),p=p&&g,{isShow:p,isIfShow:v}}function A(){var N;const{rules:d=[],component:c,rulesMessageJoinLabel:F,label:g,dynamicRules:p,required:v}=e.schema;if(E(p))return p(n(t));let O=Ae(d);const{rulesMessageJoinLabel:o}=e.formProps,l=Reflect.has(e.schema,"rulesMessageJoinLabel")?F:o,h=ke(c)+`${l?g:""}`;function u(B,M){const W=B.message||h;return M===void 0||bt(M)||Array.isArray(M)&&M.length===0||typeof M=="string"&&M.trim()===""||typeof M=="object"&&Reflect.has(M,"checked")&&Reflect.has(M,"halfChecked")&&Array.isArray(M.checked)&&Array.isArray(M.halfChecked)&&M.checked.length===0&&M.halfChecked.length===0?Promise.reject(W):Promise.resolve()}const P=E(v)?v(n(t)):v;(!O||O.length===0)&&P&&(O=[{required:P,validator:u}]);const S=O.findIndex(B=>Reflect.has(B,"required")&&!Reflect.has(B,"validator"));if(S!==-1){const B=O[S],{isShow:M}=T();if(M||(B.required=!1),c){B.message=B.message||h,(c.includes("Input")||c.includes("Textarea"))&&(B.whitespace=!0);const W=(N=n(s))==null?void 0:N.valueFormat;jt(B,c,W)}}const D=O.findIndex(B=>B.max);return D!==-1&&!O[D].validator&&(O[D].message=O[D].message||r("component.form.maxTip",[O[D].max])),O.forEach(B=>{if(typeof B.pattern=="string")try{const M=new Function("item",`return ${B.pattern}`)(B);Object.prototype.toString.call(M)==="[object RegExp]"?B.pattern=M:B.pattern=new RegExp(B.pattern)}catch(M){B.pattern=new RegExp(B.pattern)}}),O}function j(){var ae;const{renderComponentContent:d,component:c,field:F,changeEvent:g="change",valueField:p,componentProps:v}=e.schema,O=c&&["Switch","Checkbox"].includes(c);let o=!1;c==="Input"&&v&&v.trim&&(o=!0);const l=`on${ut(g)}`,h={[l]:(...z)=>{const[J]=z;D[l]&&D[l](...z);const y=J?J.target:null;let L;y?O?L=y.checked:L=o?y.value.trim():y.value:L=J,e.setFormModel(F,L)}},u=De.get(c),{autoSetPlaceHolder:P,size:S}=e.formProps,D=Se(C({allowClear:!0,getPopupContainer:z=>z==null?void 0:z.parentNode,size:S},n(s)),{disabled:n(f)}),N=e.schema.dynamicPropskey;N&&(D[N]=n(m)),!D.disabled&&P&&c!=="RangePicker"&&c&&(D.placeholder=((ae=n(s))==null?void 0:ae.placeholder)||ke(c)+e.schema.label),D.codeField=F,D.formValues=n(t);const M={[p||(O?"checked":"value")]:e.formModel[F]},W=C(C(C({},D),h),M);if(!d)return k(u,W,null);const te=E(d)?C({},d(n(t))):{default:()=>d};return k(u,W,ye(te)?te:{default:()=>[te]})}function x(){const{label:d,helpMessage:c,helpComponentProps:F,subLabel:g,labelLength:p}=e.schema;let v=d+"";p&&v.length>4&&(v=v.substr(0,p));const o=g?k("span",null,[d,ie(" "),k("span",{class:"text-secondary"},[g])]):p?k("label",{title:d},[v]):d,l=E(c)?c(n(t)):c;return!l||Array.isArray(l)&&l.length===0?o:k("span",null,[o,k(yt,X({placement:"top",class:"mx-1",text:l},F),null)])}function R(){const{itemProps:d,slot:c,render:F,field:g,suffix:p,component:v}=e.schema,{labelCol:O,wrapperCol:o}=n(b),{colon:l}=e.formProps;if(v==="Divider"){let h;return k(de,{span:24},{default:()=>[k(dt,n(s),ye(h=x())?h:{default:()=>[h]})]})}else{const h=()=>c?Me(a,c,n(t)):F?F(n(t)):j(),u=!!p,P=E(p)?p(n(t)):p;return k(Oe.Item,X({name:g,colon:l,class:{"suffix-item":u}},d,{label:x(),rules:A(),labelCol:O,wrapperCol:o}),{default:()=>[k("div",{style:"display:flex"},[k("div",{style:"flex:1; width: 100%;"},[h()]),u&&k("span",{class:"suffix"},[P])])]})}}return()=>{let d;const{colProps:c={},colSlot:F,renderColContent:g,component:p}=e.schema;if(!De.has(p))return null;const{baseColProps:v={}}=e.formProps,{getIsMobile:O}=ht();let o;o=C(C({},v),c),c.span&&!n(O)&&["xs","sm","md","lg","xl","xxl"].forEach(S=>delete o[S]);const{isIfShow:l,isShow:h}=T(),u=n(t);return l&&Ze(k(de,o,ye(d=(()=>F?Me(a,F,u):g?g(u):R())())?d:{default:()=>[d]}),[[et,h]])}}}),ze=Symbol();function Rt(e){return gt(e,ze)}function Dt(){return At(ze)}const Mt=Be({name:"BasicFormAction",components:{FormItem:Oe.Item,Button:vt,BasicArrow:wt,[de.name]:de},props:{showActionButtonGroup:V.bool.def(!0),showResetButton:V.bool.def(!0),showSubmitButton:V.bool.def(!0),showAdvancedButton:V.bool.def(!0),resetButtonOptions:{type:Object,default:()=>({})},submitButtonOptions:{type:Object,default:()=>({})},actionColOptions:{type:Object,default:()=>({})},actionSpan:V.number.def(6),isAdvanced:V.bool,hideAdvanceBtn:V.bool,layout:V.oneOf(["horizontal","vertical","inline"]).def("horizontal")},emits:["toggle-advanced"],setup(e,{emit:a}){const{t:r}=$e(),i=$(()=>{const{showAdvancedButton:s,actionSpan:f,actionColOptions:m}=e,T=24-f,A=s?{span:T<6?24:T}:{},j=e.layout=="inline"?{}:{span:s?6:4};return C(C(C({style:{textAlign:"right"}},j),A),m)}),w=$(()=>Object.assign({text:r("common.resetText"),preIcon:"ic:baseline-restart-alt"},e.resetButtonOptions)),b=$(()=>Object.assign({},{text:r("common.queryText"),preIcon:"ant-design:search-outlined"},e.submitButtonOptions));function t(){a("toggle-advanced")}return C({t:r,actionColOpt:i,getResetBtnOptions:w,getSubmitBtnOptions:b,toggleAdvanced:t},Dt())}});function Lt(e,a,r,i,w,b){const t=H("Button"),s=H("BasicArrow"),f=H("FormItem"),m=H("a-col");return e.showActionButtonGroup?(G(),ee(m,ce(X({key:0},e.actionColOpt)),{default:q(()=>[nt("div",{style:ot([{width:"100%"},{textAlign:e.actionColOpt.style.textAlign}])},[k(f,null,{default:q(()=>[K(e.$slots,"submitBefore"),e.showSubmitButton?(G(),ee(t,X({key:0,type:"primary",class:"mr-2"},e.getSubmitBtnOptions,{onClick:e.submitAction}),{default:q(()=>[ie(pe(e.getSubmitBtnOptions.text),1)]),_:1},16,["onClick"])):le("",!0),K(e.$slots,"resetBefore"),e.showResetButton?(G(),ee(t,X({key:1,type:"default",class:"mr-2"},e.getResetBtnOptions,{onClick:e.resetAction}),{default:q(()=>[ie(pe(e.getResetBtnOptions.text),1)]),_:1},16,["onClick"])):le("",!0),K(e.$slots,"advanceBefore"),e.showAdvancedButton&&!e.hideAdvanceBtn?(G(),ee(t,{key:2,type:"link",size:"small",onClick:e.toggleAdvanced},{default:q(()=>[ie(pe(e.isAdvanced?e.t("component.form.putAway"):e.t("component.form.unfold"))+" ",1),k(s,{class:"ml-1",expand:!e.isAdvanced,up:""},null,8,["expand"])]),_:1},8,["onClick"])):le("",!0),K(e.$slots,"advanceAfter")]),_:3})],4)]),_:3},16)):le("",!0)}const kt=Ee(Mt,[["render",Lt]]);function He(e,a){var w,b;return((w=n(e))==null?void 0:w.fieldMapToTime)&&(a=Nt(e,a)),((b=n(e))==null?void 0:b.fieldMapToNumber)&&(a=$t(e,a)),a}function Nt(e,a){const r=n(e).fieldMapToTime;if(!r||!Array.isArray(r))return a;for(const[i,[w,b],t="YYYY-MM-DD"]of r){if(!i||!w||!b||!a[i])continue;let s=a[i];Array.isArray(s)||(s=s.split(","));const[f,m]=s;a[w]=Y(f).format(t),a[b]=Y(m).format(t),Reflect.deleteProperty(a,i)}return a}function $t(e,a){const r=n(e).fieldMapToNumber;if(!r||!Array.isArray(r))return a;for(const[i,[w,b]]of r){if(!i||!w||!b||!a[i])continue;let t=a[i];typeof t=="string"&&(t=t.split(","));const[s,f]=t;a[w]=s,a[b]=f,Reflect.deleteProperty(a,i)}return a}function Et({defaultValueRef:e,getSchema:a,formModel:r,getProps:i}){function w(t){if(!se(t))return{};const s={};for(const f of Object.entries(t)){let[,m]=f;const[T]=f;if(!T||fe(m)&&m.length===0||E(m))continue;const A=n(i).transformDateFunc;se(m)&&(m=A==null?void 0:A(m)),fe(m)&&ve.isDayjs(m[0])&&ve.isDayjs(m[1])&&(m=m.map(j=>A==null?void 0:A(j))),ue(m)&&(m=m.trim()),ft(s,T,m)}return He(i,s)}function b(){const t=n(a),s={};t.forEach(f=>{const{defaultValue:m}=f;Ft(m)||(s[f.field]=m,r[f.field]=m)}),e.value=s}return{handleFormValues:w,initDefault:b}}const Z=24;function xt({advanceState:e,emit:a,getProps:r,getSchema:i,formModel:w,defaultValueRef:b}){const{realWidthRef:t,screenEnum:s,screenRef:f}=Bt(),m=$(()=>{if(!e.isAdvanced)return 0;const R=n(r).emptySpan||0;if(Ne(R))return R;if(se(R)){const{span:d=0}=R,c=n(f);return R[c.toLowerCase()]||d||0}return 0}),T=xe(j,30);oe([()=>n(i),()=>e.isAdvanced,()=>n(t)],()=>{const{showAdvancedButton:R}=n(r);R&&T()},{immediate:!0});function A(R,d=0,c=!1,F=0){var h;const g=n(t),p=parseInt(R.md)||parseInt(R.xs)||parseInt(R.sm)||R.span||Z,v=parseInt(R.lg)||p,O=parseInt(R.xl)||v,o=parseInt(R.xxl)||O;g<=s.LG?d+=p:g<s.XL?d+=v:g<s.XXL?d+=O:d+=o;let l=(h=n(r).autoAdvancedCol)!=null?h:3;return c?(e.hideAdvanceBtn=n(i).length<=l,d>Z*2&&d<=Z*(n(r).autoAdvancedLine||3)?e.hideAdvanceBtn=!1:e.isLoad||(e.isLoad=!0,e.isAdvanced=!e.isAdvanced,n(i).length>l&&(e.hideAdvanceBtn=!1,e.isAdvanced=!1)),{isAdvanced:e.isAdvanced,itemColSum:d}):d>Z*(n(r).alwaysShowLines||1)?{isAdvanced:e.isAdvanced,itemColSum:d}:!e.isAdvanced&&F+1>l?{isAdvanced:!1,itemColSum:d}:{isAdvanced:!0,itemColSum:d}}function j(){let R=0,d=0;const{baseColProps:c={}}=n(r),F=n(i);for(let g=0;g<F.length;g++){const p=F[g],{show:v,colProps:O}=p;let o=!0;if(ne(v)&&(o=v),E(v)&&(o=v({schema:p,model:w,field:p.field,values:C(C({},n(b)),w)})),o&&(O||c)){const{itemColSum:l,isAdvanced:h}=A(C(C({},c),O),R,!1,g);R=l||0,h&&(d=R),p.isAdvanced=h}}e.actionSpan=d%Z+n(m),A(n(r).actionColOptions||{span:Z},R,!0),a("advanced-change")}function x(){e.isAdvanced=!e.isAdvanced}return{handleToggleAdvanced:x}}function Wt({emit:e,getProps:a,formModel:r,getSchema:i,defaultValueRef:w,formElRef:b,schemaRef:t,handleFormValues:s}){function f(){return I(this,null,function*(){const{resetFunc:o,submitOnReset:l}=n(a);o&&E(o)&&(yield o()),n(b)&&(Object.keys(r).forEach(u=>{r[u]=w.value[u]}),p(),e("reset",Ie(r)),l&&O())})}function m(o){return I(this,null,function*(){const l=n(i).map(u=>u.field).filter(Boolean),h=[];Object.keys(o).forEach(u=>{const P=n(i).find(N=>N.field===u);let S=o[u];if(!(o instanceof Object))return;const D=Reflect.has(o,u);if(S=Tt(P==null?void 0:P.component,S),S=Pt(P==null?void 0:P.component,S),D&&l.includes(u)){if(c(u))if(Array.isArray(S)){const N=[];for(const B of S)N.push(B?Y(B):null);r[u]=N}else{const{componentProps:N}=P||{};let B=N;typeof N=="function"&&(B=B({formModel:r})),r[u]=S?B!=null&&B.valueFormat?S:Y(S):null}else r[u]=S;h.push(u)}}),F(h).catch(u=>{})})}function T(o){return I(this,null,function*(){const l=Ae(n(i));if(!o)return;let h=ue(o)?[o]:o;ue(o)&&(h=[o]);for(const u of h)A(u,l);t.value=l})}function A(o,l){if(ue(o)){const h=l.findIndex(u=>u.field===o);h!==-1&&(delete r[o],l.splice(h,1))}}function j(o,l,h=!1){return I(this,null,function*(){const u=Ae(n(i)),P=u.findIndex(D=>D.field===l);if(u.some(D=>D.field===l||o.field)){if(!l||P===-1||h){h?u.unshift(o):u.push(o),t.value=u;return}P!==-1&&u.splice(P+1,0,o),t.value=u}})}function x(o){return I(this,null,function*(){let l=[];if(se(o)&&l.push(o),fe(o)&&(l=[...o]),!l.every(u=>u.component==="Divider"||Reflect.has(u,"field")&&u.field)){we("All children of the form Schema array that need to be updated must contain the `field` field");return}t.value=l})}function R(o){return I(this,null,function*(){let l=[];if(se(o)&&l.push(o),fe(o)&&(l=[...o]),!l.every(P=>P.component==="Divider"||Reflect.has(P,"field")&&P.field)){we("All children of the form Schema array that need to be updated must contain the `field` field");return}const u=[];l.forEach(P=>{n(i).forEach(S=>{if(S.field===P.field){const D=We(S,P);u.push(D)}else u.push(S)})}),t.value=mt(u,"field")})}function d(){return n(b)?s(Ie(n(r))):{}}function c(o){return n(i).some(l=>l.field===o?qe.includes(l.component):!1)}function F(o,l){return I(this,null,function*(){var h;return(h=n(b))==null?void 0:h.validateFields(o,l)})}function g(o){return I(this,null,function*(){var l;return yield(l=n(b))==null?void 0:l.validate(o)})}function p(o){return I(this,null,function*(){var l;yield(l=n(b))==null?void 0:l.clearValidate(o)})}function v(o,l){return I(this,null,function*(){var h;yield(h=n(b))==null?void 0:h.scrollToField(o,l)})}function O(o){return I(this,null,function*(){o&&o.preventDefault();const{submitFunc:l}=n(a);if(l&&E(l)){yield l();return}if(n(b))try{const u=yield g();for(let S in u)u[S]instanceof Array&&_e(a,S)==="string"&&(u[S]=u[S].join(","));const P=s(u);e("submit",P)}catch(u){e("submit",{})}})}return{handleSubmit:O,clearValidate:p,validate:g,validateFields:F,getFieldsValue:d,updateSchema:R,resetSchema:x,appendSchemaByField:j,removeSchemaByFiled:T,resetFields:f,setFieldsValue:m,scrollToField:v}}function _t(w){return I(this,arguments,function*({getSchema:e,getProps:a,formElRef:r,isInitedDefault:i}){st(()=>I(this,null,function*(){if(n(i)||!n(a).autoFocusFirstItem)return;yield Ce();const b=n(e),t=n(r),s=t==null?void 0:t.$el;if(!t||!s||!b||b.length===0||!b[0].component.includes("Input"))return;const m=s.querySelector(".ant-row:first-child input");m&&(m==null||m.focus())}))})}const{form:ge}=Fe,qt={model:{type:Object,default:{}},labelWidth:{type:[Number,String],default:0},fieldMapToTime:{type:Array,default:()=>[]},fieldMapToNumber:{type:Array,default:()=>[]},compact:V.bool,schemas:{type:[Array],default:()=>[]},mergeDynamicData:{type:Object,default:null},baseRowStyle:{type:Object},baseColProps:{type:Object},autoSetPlaceHolder:V.bool.def(!0),autoSubmitOnEnter:V.bool.def(!1),submitOnReset:V.bool,size:V.oneOf(["default","small","large"]).def("default"),disabled:V.bool,emptySpan:{type:[Number,Object],default:0},showAdvancedButton:V.bool,transformDateFunc:{type:Function,default:e=>ve.isDayjs(e)?e==null?void 0:e.format("YYYY-MM-DD HH:mm:ss"):e},rulesMessageJoinLabel:V.bool.def(!0),autoAdvancedCol:V.number.def(3),autoAdvancedLine:V.number.def(3),alwaysShowLines:V.number.def(1),showActionButtonGroup:V.bool.def(!0),actionColOptions:Object,showResetButton:V.bool.def(!0),autoFocusFirstItem:V.bool,resetButtonOptions:Object,showSubmitButton:V.bool.def(!0),submitButtonOptions:Object,resetFunc:Function,submitFunc:Function,hideRequiredMark:V.bool,labelCol:{type:Object,default:ge.labelCol},layout:V.oneOf(["horizontal","vertical","inline"]).def("horizontal"),tableAction:{type:Object},wrapperCol:{type:Object,default:ge.wrapperCol},colon:V.bool.def(ge.colon),labelAlign:V.string,rowProps:Object,autoSearch:V.bool.def(!1)},zt=Be({name:"BasicForm",components:{FormItem:Vt,Form:Oe,Row:pt,FormAction:kt},props:qt,emits:["advanced-change","reset","submit","register"],setup(e,{emit:a,attrs:r}){const i=Ve({}),w=St(),b=Ve({isAdvanced:!1,hideAdvanceBtn:!0,isLoad:!1,actionSpan:6}),t=U({}),s=U(!1),f=U({}),m=U(null),T=U(null),{prefixCls:A}=Ct("basic-form"),j=$(()=>{let y=C(C({},e),n(f));return y.labelWidth&&(y.labelCol=void 0),y.layout==="inline"&&(y.labelCol===Fe.form.labelCol&&(y.labelCol=void 0),y.wrapperCol===Fe.form.wrapperCol&&(y.wrapperCol=void 0)),y}),x=$(()=>[A,{[`${A}--compact`]:n(j).compact}]),R=$(()=>{const{baseRowStyle:y={},rowProps:L}=n(j);return C({style:y},L)}),d=$(()=>C(C(C({},r),e),n(j))),c=$(()=>{const y=n(m)||n(j).schemas;for(const L of y){const{defaultValue:_,component:Ke,componentProps:re}=L;if(_&&qe.includes(Ke)){let Q="";if(re&&(Q=re==null?void 0:re.valueFormat),!Array.isArray(_))Q?L.defaultValue=Y(_).format(Q):L.defaultValue=Y(_);else{const me=[];_.forEach(je=>{Q?me.push(Y(je).format(Q)):me.push(Y(je))}),L.defaultValue=me}}}return n(j).showAdvancedButton?y.filter(L=>L.component!=="Divider"):y}),{handleToggleAdvanced:F}=xt({advanceState:b,emit:a,getProps:j,getSchema:c,formModel:i,defaultValueRef:t}),{handleFormValues:g,initDefault:p}=Et({getProps:j,defaultValueRef:t,getSchema:c,formModel:i});_t({getSchema:c,getProps:j,isInitedDefault:s,formElRef:T});const{handleSubmit:v,setFieldsValue:O,clearValidate:o,validate:l,validateFields:h,getFieldsValue:u,updateSchema:P,resetSchema:S,appendSchemaByField:D,removeSchemaByFiled:N,resetFields:B,scrollToField:M}=Wt({emit:a,getProps:j,formModel:i,getSchema:c,defaultValueRef:t,formElRef:T,schemaRef:m,handleFormValues:g});Rt({resetAction:B,submitAction:v}),oe(()=>n(j).model,()=>{const{model:y}=n(j);y&&O(y)},{immediate:!0}),oe(()=>n(j).schemas,y=>{S(y!=null?y:[])}),oe(()=>c.value,y=>{Ce(()=>{var L;(L=w==null?void 0:w.redoModalHeight)==null||L.call(w)}),!n(s)&&y!=null&&y.length&&(p(),s.value=!0)});function W(y){return I(this,null,function*(){f.value=We(n(f)||{},y)})}const te=xe(v,300);function ae(y,L){i[y]=L,e.autoSearch===!0&&te()}function z(y){const{autoSubmitOnEnter:L}=n(j);if(L&&y.key==="Enter"&&y.target&&y.target instanceof HTMLElement){const _=y.target;_&&_.tagName&&_.tagName.toUpperCase()=="INPUT"&&v()}}const J={getFieldsValue:u,setFieldsValue:O,resetFields:B,updateSchema:P,resetSchema:S,setProps:W,getProps:j,removeSchemaByFiled:N,appendSchemaByField:D,clearValidate:o,validateFields:h,validate:l,submit:v,scrollToField:M};return at(()=>{p(),a("register",J)}),C({getBindValue:d,handleToggleAdvanced:F,handleEnterPress:z,formModel:i,defaultValueRef:t,advanceState:b,getRow:R,getProps:j,formElRef:T,getSchema:c,formActionType:J,setFormModel:ae,getFormClass:x,getFormActionBindProps:$(()=>C(C({},j.value),b))},J)}});function Ht(e,a,r,i,w,b){const t=H("FormItem"),s=H("FormAction"),f=H("Row"),m=H("Form");return G(),ee(m,X(e.getBindValue,{class:e.getFormClass,ref:"formElRef",model:e.formModel,onKeypress:rt(e.handleEnterPress,["enter"])}),{default:q(()=>[k(f,ce(he(e.getRow)),{default:q(()=>[K(e.$slots,"formHeader"),(G(!0),lt(it,null,be(e.getSchema,T=>(G(),ee(t,{key:T.field,tableAction:e.tableAction,formActionType:e.formActionType,schema:T,formProps:e.getProps,allDefaultValues:e.defaultValueRef,formModel:e.formModel,setFormModel:e.setFormModel,validateFields:e.validateFields},Re({_:2},[be(Object.keys(e.$slots),A=>({name:A,fn:q(j=>[K(e.$slots,A,ce(he(j||{})))])}))]),1032,["tableAction","formActionType","schema","formProps","allDefaultValues","formModel","setFormModel","validateFields"]))),128)),k(s,X(e.getFormActionBindProps,{onToggleAdvanced:e.handleToggleAdvanced}),Re({_:2},[be(["resetBefore","submitBefore","advanceBefore","advanceAfter"],T=>({name:T,fn:q(A=>[K(e.$slots,T,ce(he(A||{})))])}))]),1040,["onToggleAdvanced"]),K(e.$slots,"formFooter")]),_:3},16)]),_:3},16,["class","model","onKeypress"])}const en=Ee(zt,[["render",Ht]]);function tn(e){const a=U(null),r=U(!1);function i(){return I(this,null,function*(){const t=n(a);return t||we("The form instance has not been obtained, please make sure that the form has been rendered when performing the form operation!"),yield Ce(),t})}function w(t){Le()&&ct(()=>{a.value=null,r.value=null}),!(n(r)&&Le()&&t===n(a))&&(a.value=t,r.value=!0,oe(()=>e,()=>{e&&t.setProps(Ot(e))},{immediate:!0,deep:!0}))}return[w,{scrollToField:(t,s)=>I(this,null,function*(){(yield i()).scrollToField(t,s)}),setProps:t=>I(this,null,function*(){(yield i()).setProps(t)}),updateSchema:t=>I(this,null,function*(){(yield i()).updateSchema(t)}),resetSchema:t=>I(this,null,function*(){(yield i()).resetSchema(t)}),clearValidate:t=>I(this,null,function*(){(yield i()).clearValidate(t)}),resetFields:()=>I(this,null,function*(){i().then(t=>I(this,null,function*(){yield t.resetFields()}))}),removeSchemaByFiled:t=>I(this,null,function*(){var s;(s=n(a))==null||s.removeSchemaByFiled(t)}),getFieldsValue:()=>{var s;let t=(s=n(a))==null?void 0:s.getFieldsValue();return t&&Object.keys(t).map(f=>{t[f]instanceof Array&&(typeof(t[f][0]||"")=="object"||(t[f]=t[f].join(",")))}),t},setFieldsValue:t=>I(this,null,function*(){(yield i()).setFieldsValue(t)}),appendSchemaByField:(t,s,f)=>I(this,null,function*(){(yield i()).appendSchemaByField(t,s,f)}),submit:()=>I(this,null,function*(){return(yield i()).submit()}),validate:t=>I(this,null,function*(){const s=yield i();let f=e||s.getProps;return s.validate(t).then(T=>{for(let A in T)T[A]instanceof Array&&_e(f,A)==="string"&&(T[A]=T[A].join(","));return He(f,T)})}),validateFields:(t,s)=>I(this,null,function*(){return(yield i()).validateFields(t,s)})}]}export{en as B,tn as u};
