var S=(t,v,c)=>new Promise((y,p)=>{var f=s=>{try{r(c.next(s))}catch(u){p(u)}},n=s=>{try{r(c.throw(s))}catch(u){p(u)}},r=s=>s.done?y(s.value):Promise.resolve(s.value).then(f,n);r((c=c.apply(t,v)).next())});import{d as Z,f as h,h as ee,w as te,o as oe,u as ne,a3 as xe,a4 as Pe,V as I,a6 as d,a7 as g,k,ai as U,a5 as w,F as B,am as z,ae as R,af as ae,E as se,W as A}from"./vue-vendor-24c7dc61.js";import{S as le,R as re,ch as ie,H as i,b5 as ce,ci as ue,cj as E,ck as de,o as pe,a as fe,c as N,k as L,ap as ge,l as ve}from"./index-831af9dd.js";import{m as me}from"./antd-vue-vendor-0d72f01e.js";import{c as V}from"./index-b510c86d.js";import{_ as he}from"./JUpload-76e119c7.js";import"./vxe-table-vendor-8813019a.js";import"./index-d508f1f4.js";const ye=me,_e=Z({name:"AppCoverSelector",components:{ScrollContainer:le,Icon:re,SvgIcon:ie,APagination:ye,JUpload:he},props:{value:i.string,width:i.string.def("100%"),pageSize:i.number.def(140),copy:i.bool.def(!1),mode:i.oneOf(["svg","iconify"]).def("iconify"),disabled:i.bool.def(!0),clearSelect:i.bool.def(!1),color:i.string.def("")},emits:["change","update:value"],setup(t,{emit:v}){function c(){var _,C;const e=E,o=(_=e==null?void 0:e.prefix)!=null?_:"";let a=[];return o?a=((C=e==null?void 0:e.icons)!=null?C:[]).map($=>`${o}:${$}`):Array.isArray(E)&&(a=E),a}function y(){return de.map(e=>e.replace("icon-",""))}const p=t.mode==="svg",f=p?y():c(),n=h(""),r=h(f),{t:s}=pe(),{clipboardRef:u,isSuccessRef:l}=ce(t.value),{createMessage:m}=fe(),{getPaginationList:j,getTotal:D,setCurrentPage:T}=ue(r,t.pageSize);ee(()=>{n.value=t.value}),te(()=>n.value,e=>(v("update:value",e),v("change",e)));function J(e){T(e)}function M(e){n.value=e.key}function O(e){n.value=e.url}function H(e){t.clearSelect===!0?n.value===e?n.value="":n.value=e:(n.value=e,t.copy&&(u.value=e,ne(l)&&m.success(s("component.icon.copy"))))}function W(e){const o=e.target.value;if(!o){T(1),r.value=f;return}r.value=f.filter(a=>a.includes(o))}const x=h([]);function q(){let e=[];Object.keys(V).map(o=>{e.push({key:o,img:V[o]})}),x.value=e}q();function G(e){let o=t.color;return e.key==n.value||e.url==n.value?{border:`3px solid ${o}`}:{}}const b=h(),P=h([]);function K(e){return S(this,null,function*(){if(e){let o=JSON.parse(e);if(o.length>0){let a=o[0];yield Q(a)}}})}function Q(e){return S(this,null,function*(){let{fileName:o,filePath:a}=e,_="/online/sysTenantCover/add",C={fileName:o,url:a,tenantId:N()};(yield L.post({url:_,params:C},{isTransformResponse:!1})).success&&(yield F(),b.value&&b.value.scrollBottom())})}function F(){return S(this,null,function*(){const e="/online/sysTenantCover/getList";let o={tenantId:N()};const a=yield L.get({url:e,params:o},{isTransformResponse:!1});a.success&&(P.value=a.result)})}function X(e){return ge(e)}oe(()=>{F()});function Y(e,o){e.preventDefault(),e.stopPropagation();const a="/online/sysTenantCover/delete";L.delete({url:a,data:{id:o.id}},{joinParamsToUrl:!0}).then(()=>{F()})}return{getPaginationList:j,currentSelect:n,handleClick:H,isSvgMode:p,getTotal:D,handlePageChange:J,handleSearchChange:W,coverImageList:x,getSelectedStyle:G,onselect:M,onselectFile:O,onFileChange:K,scrollRef:b,coverFileList:P,getImageUrl:X,onDeleteImg:Y}}});const Ce={key:0,class:"app-icon-selector"},Se={style:{display:"flex","flex-direction":"row","flex-wrap":"wrap"}},Ie=["onClick"],ke=["src"],we=["onClick"],be=["src"],Fe=["onClick"],Ae={key:0,style:{"padding-bottom":"0"},class:"flex py-2 items-center justify-center"};function Ee(t,v,c,y,p,f){const n=I("a-divider"),r=I("Icon"),s=I("ScrollContainer"),u=I("JUpload");return t.getPaginationList.length?(d(),g("div",Ce,[k(s,{class:"border border-solid border-t-0",ref:"scrollRef"},{default:U(()=>[w("div",Se,[k(n,{style:{margin:"5px 0"}}),(d(!0),g(B,null,z(t.coverImageList,l=>(d(),g("div",{style:R([t.getSelectedStyle(l),{margin:"5px",cursor:"pointer"}]),onClick:m=>t.onselect(l)},[w("img",{src:l.img,style:{width:"135px",height:"60px"}},null,8,ke)],12,Ie))),256)),t.coverFileList.length>0?(d(),ae(n,{key:0,style:{margin:"5px 0","font-size":"12px","font-style":"italic"}},{default:U(()=>[se("以下是自定义上传图片")]),_:1})):A("",!0),(d(!0),g(B,null,z(t.coverFileList,l=>(d(),g("div",{class:"custom-image",style:R([t.getSelectedStyle(l),{position:"relative",margin:"5px",cursor:"pointer"}]),onClick:m=>t.onselectFile(l)},[w("img",{src:t.getImageUrl(l.url),style:{width:"135px",height:"60px"}},null,8,be),w("span",{class:"icon-delete",onClick:m=>t.onDeleteImg(m,l)},[k(r,{icon:"ant-design:close-outlined",size:20})],8,Fe)],12,we))),256))])]),_:1},512),t.getTotal>=t.pageSize?(d(),g("div",Ae,[k(u,{text:"上传自定义封面图",showUploadList:!1,bizPath:"lowAppCover",returnUrl:!1,maxCount:1,onChange:t.onFileChange,replaceLastOne:""},null,8,["onChange"])])):A("",!0)])):A("",!0)}const Ve=ve(_e,[["render",Ee],["__scopeId","data-v-c37aaf36"]]);export{Ve as default};
