var p=(c,d,e)=>new Promise((n,t)=>{var i=o=>{try{l(e.next(o))}catch(a){t(a)}},s=o=>{try{l(e.throw(o))}catch(a){t(a)}},l=o=>o.done?n(o.value):Promise.resolve(o.value).then(i,s);l((e=e.apply(c,d)).next())});import{a as b,d as w,k as f}from"./index-831af9dd.js";const{createMessage:u,createWarningModal:g}=b(),y=w(),h="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",x=".xlsx";function L(){function c(e,n,t,i=!1){return p(this,null,function*(){const s=yield f.get({url:n,params:t,responseType:"blob",timeout:6e4},{isTransformResponse:!1});if(!s){u.warning("文件下载失败");return}(!e||typeof e!="string")&&(e="导出文件");let l={type:"application/vnd.ms-excel"},o=".xls";if(i===!0&&(l.type=h,o=x),typeof window.navigator.msSaveBlob!="undefined")window.navigator.msSaveBlob(new Blob([s],l),e+o);else{let a=window.URL.createObjectURL(new Blob([s],l)),r=document.createElement("a");r.style.display="none",r.href=a,r.setAttribute("download",e+o),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(a)}})}function d(e,n,t){return p(this,null,function*(){const i=s=>{try{if(s.code===201){let{message:l,result:{msg:o,fileUrl:a,fileName:r}}=s,m=y.uploadUrl+a;g({title:l,centered:!1,content:`<div>
                                <span>${o}</span><br/> 
                                <span>具体详情请<a href = ${m} download = ${r}> 点击下载 </a> </span> 
                              </div>`})}else s.code===500||s.code===510?u.error(s.message||`${e.file.name} 导入失败`):u.success(s.message||`${e.file.name} 文件上传成功`)}catch(l){}finally{typeof t=="function"&&t(s)}};yield f.uploadFile({url:n},{file:e.file},{success:i})})}return{handleExportXls:(e,n,t)=>c(e,n,t),handleImportXls:(e,n,t)=>d(e,n,t),handleExportXlsx:(e,n,t)=>c(e,n,t,!0)}}export{L as u};
