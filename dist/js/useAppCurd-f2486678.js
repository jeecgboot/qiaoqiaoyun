var Oe=Object.defineProperty,Le=Object.defineProperties;var Se=Object.getOwnPropertyDescriptors;var Z=Object.getOwnPropertySymbols;var ye=Object.prototype.hasOwnProperty,Ie=Object.prototype.propertyIsEnumerable;var _=(c,d,f)=>d in c?Oe(c,d,{enumerable:!0,configurable:!0,writable:!0,value:f}):c[d]=f,g=(c,d)=>{for(var f in d||(d={}))ye.call(d,f)&&_(c,f,d[f]);if(Z)for(var f of Z(d))Ie.call(d,f)&&_(c,f,d[f]);return c},C=(c,d)=>Le(c,Se(d));var l=(c,d,f)=>new Promise((x,R)=>{var B=m=>{try{S(f.next(m))}catch(v){R(v)}},k=m=>{try{S(f.throw(m))}catch(v){R(v)}},S=m=>m.done?x(m.value):Promise.resolve(m.value).then(B,k);S((f=f.apply(c,d)).next())});import{a7 as ee,k as N}from"./index-831af9dd.js";import{f as h,r as $,e as b,w as M}from"./vue-vendor-24c7dc61.js";import{p as H}from"./antd-vue-vendor-0d72f01e.js";import{v as Ce}from"./VipPay.api-469f07f9.js";const G={save:"/online/lowAppGroup/add",update:"/online/lowAppGroup/edit",delete:"/online/lowAppGroup/delete",addAppGroupRelation:"/online/lowAppGroup/addAppGroupRelation",removeAppGroupRelation:"/online/lowAppGroup/removeAppGroupRelation",resetAppGroup:"/online/lowAppGroup/resetAppGroup",queryList:"/online/lowApp/queryList",allStarAppList:"/online/lowApp/allStarAppList",resetGroupOrderNum:"/online/lowAppGroup/resetGroupOrderNum",resetGroupAppOrderNum:"/online/lowAppGroup/resetGroupAppOrderNum",resetAppOrderNum:"/online/lowApp/resetAppOrderNum"};function Re(){const c=ee();function d(o){return l(this,null,function*(){let i=C(g({},o),{tenantId:c.getTenant});(yield N.post({url:G.save,params:i},{isTransformResponse:!1})).success})}function f(o){return l(this,null,function*(){let i=g({},o);(yield N.put({url:G.update,params:i},{isTransformResponse:!1})).success})}function x(o){return l(this,null,function*(){let i={id:o};yield N.delete({url:G.delete,data:i},{joinParamsToUrl:!0})})}function R(o){return l(this,null,function*(){let i=g({},o);(yield N.post({url:G.addAppGroupRelation,params:i},{isTransformResponse:!1})).success})}function B(o){return l(this,null,function*(){let i=g({},o);(yield N.post({url:G.removeAppGroupRelation,params:i},{isTransformResponse:!1})).success})}function k(o){return l(this,null,function*(){let i=g({},o);(yield N.post({url:G.resetAppGroup,params:i},{isTransformResponse:!1})).success})}function S(){return l(this,null,function*(){let o={tenantId:c.getTenant};const i=yield N.get({url:G.queryList,params:o},{isTransformResponse:!1});return i.success?i.result:{}})}function m(){return l(this,null,function*(){const o=yield N.get({url:G.allStarAppList},{isTransformResponse:!1});return o.success?o.result:[]})}function v(o){return l(this,null,function*(){let i=g({},o);(yield N.post({url:G.resetGroupOrderNum,params:i},{isTransformResponse:!1})).success})}function w(o){return l(this,null,function*(){let i=g({},o);(yield N.post({url:G.resetAppOrderNum,params:i},{isTransformResponse:!1})).success})}function O(o){return l(this,null,function*(){let i=g({},o);(yield N.post({url:G.resetGroupAppOrderNum,params:i},{isTransformResponse:!1})).success})}return{saveAppGroup:d,updateAppGroup:f,deleteAppGroup:x,getAppList:S,resetAppGroup:k,addAppGroupRelation:R,queryAllStarAppList:m,removeAppGroupRelation:B,resetGroupOrderNum:v,resetAppOrderNum:w,resetGroupAppOrderNum:O}}const K={id:0,type:"add",appName:""};function Pe(){const{getAppList:c,updateAppGroup:d,deleteAppGroup:f,addAppGroupRelation:x,queryAllStarAppList:R,resetGroupOrderNum:B,resetAppOrderNum:k,resetGroupAppOrderNum:S}=Re(),m=h([]),v=h([]),w=h([]),O=h([]),o=ee(),i=h(""),A=h(""),T=h(""),W=h([]),y=$({app:"current",group:"tag",outer:!0}),j=h(""),U=h("all");let z=[];function te(){m.value=[],O.value=[],v.value=[],w.value=[],z=[],A.value=""}function re(){U.value="",j.value=""}function I(e){return l(this,null,function*(){e||te();let t=yield c();const{appList:r,groupList:a,relationList:s}=t;O.value=s||[],se(a,s);let p=[],n=[];if(r)for(let u of r){let P={id:u.id,appName:u.appName,iconBackColor:u.iconBackColor||"rgb(0, 188, 212)",iconType:u.iconType||"ant-design:schedule-outlined",update:!1,starStatus:u.starStatus||0,orderNum:u.orderNum,starOrderNum:u.starOrderNum,hasAdmin:u.hasAdmin,ownerId:u.ownerId,maintStatus:u.maintStatus||0,maintNote:u.maintNote||"",appCoverImg:u.appCoverImg||""};if(z.indexOf(u.id)>=0){let Y=g({},P);U.value=="star"&&j.value===u.id&&(Y.update=!0),n.push(Y)}U.value=="all"&&j.value===u.id&&(P.update=!0),p.push(P)}L(p,!1),m.value=p,v.value=n,yield Q(),E(),re(),yield Ce()})}function Q(){return l(this,null,function*(){let e=[];if(y.app=="all"){let t=yield R();if(t&&t.length>0)for(let r of t){let a={id:r.id,appName:r.appName,iconBackColor:r.iconBackColor||"rgb(0, 188, 212)",iconType:r.iconType||"ant-design:schedule-outlined",update:!1,starStatus:r.starStatus||0,orderNum:r.orderNum,starOrderNum:r.starOrderNum,hasAdmin:r.hasAdmin,ownerId:r.ownerId,maintStatus:r.maintStatus||0,maintNote:r.maintNote||"",appCoverImg:r.appCoverImg||""};e.push(a)}}else if(y.app=="current"){let t=m.value;if(t&&t.length>0){for(let r of t)if(r.starStatus==1){let a=H(r,"id","appCoverImg","appName","iconBackColor","iconType","starStatus","orderNum","starOrderNum","hasAdmin","maintNote","maintStatus","ownerId");e.push(a)}}}L(e,!0),W.value=e})}const D=h([]);function E(){if(D.value=[],y.group=="list"){let e=w.value,t=[];if(e&&e.length>0){let r=e.filter(a=>a.starStatus==1);if(r.length>0)for(let a of r){let s=H(a,"id","groupName","iconType","starStatus","action","count","groupScope","orderNum","starOrderNum");s.collapsed=!1;let p=de(s.id);s.appList=p,p&&p.length>0&&p[0].id&&t.push(s)}}L(t,!0),D.value=t}}function ae(e){return l(this,null,function*(){let t=D.value;if(t&&t.length>0){let r=t.filter(a=>a.id==e);if(r&&r.length>0){let a=r[0].appList;a&&a.length>0&&(yield F(a,e))}}})}function L(e,t){e.sort(function(r,a){return t===!0&&r.starOrderNum&&a.starOrderNum?r.starOrderNum-a.starOrderNum:r.orderNum-a.orderNum})}function se(e,t){let r=[],a=[];if(e)for(let s of e){let p=H(s,"id","groupName","iconType","starStatus","useScope","orderNum","starOrderNum");if(p.action=!1,p.count=0,t){let n=t.filter(u=>u.groupId==s.id);n&&(p.count=n.length||0)}s.starStatus==1&&ie(a,t,s.id),r.push(p)}L(r,!1),w.value=r,z=a}function pe(){return l(this,null,function*(){let e=w.value;yield V(e,!1)})}function ie(e,t,r){if(t){for(let a of t)if(a.groupId==r){let s=a.appId;e.indexOf(s)<0&&e.push(s)}}}function ue(e,t,r){if(q(e),t=="index")A.value="";else if(r){let a=H(r,"id","groupName","iconType","starStatus");t=="star"?A.value=C(g({},a),{groupScope:"star"}):t=="self"&&(A.value=C(g({},a),{groupScope:"self"}))}}function oe(e,t){let r=A.value;if(r){if(t&&r.id==t&&r.groupScope==e)return"active"}else if(e=="index")return"active";return""}const le=b({get(){let e=[],t=A.value;if(t){let r=m.value;if(r&&r.length>0){let a=O.value,s=t.id,p=[];for(let n of a)n.groupId==s&&p.push({appId:n.appId,orderNum:n.orderNum});for(let n of r){let u=p.filter(P=>P.appId==n.id);u&&u.length>0&&e.push(C(g({},n),{starOrderNum:u[0].orderNum}))}}}if(L(e,!0),i.value){let r=i.value;return e.filter(s=>s.appName.indexOf(r)>=0)}else return e.push(K),e},set(e){let t=A.value;t&&F(e,t.id)}}),ne=b({get(){let e=w.value;if(e&&e.length>0){let t=e.filter(r=>r.starStatus==1);return!T.value&&t.length>0&&(T.value=t[0].id),L(t,!0),t}return[]},set(e){V(e,!0)}});function V(e,t){return l(this,null,function*(){let r=[];for(let s=0;s<e.length;s++){let p=e[s];r.push({id:p.id,orderNum:s+1})}yield B({list:r,star:t}),yield I(!0)})}function de(e){let t=v.value,r=[];if(t&&t.length>0){let a=O.value,s=[];for(let p of a)p.groupId==e&&s.push({appId:p.appId,orderNum:p.orderNum});for(let p of t){let n=s.filter(u=>u.appId==p.id);n&&n.length>0&&r.push(C(g({},p),{starOrderNum:n[0].orderNum}))}}if(L(r,!0),i.value){let a=i.value;return r.filter(p=>p.appName.indexOf(a)>=0)}else return r.push(K),r;return r}const fe=b({get(){let e=v.value,t=[];if(e&&e.length>0){let r=O.value,a=T.value,s=[];for(let p of r)p.groupId==a&&s.push({appId:p.appId,orderNum:p.orderNum});for(let p of e){let n=s.filter(u=>u.appId==p.id);n&&n.length>0&&t.push(C(g({},p),{starOrderNum:n[0].orderNum}))}}if(L(t,!0),i.value){let r=i.value;return t.filter(s=>s.appName.indexOf(r)>=0)}else return t.push(K),t},set(e){F(e,T.value)}});function F(e,t){return l(this,null,function*(){let r=[];for(let s=0;s<e.length;s++){let p=e[s];p.id&&r.push({id:p.id,orderNum:s+1})}yield S({list:r,groupId:t}),yield I(!0)})}const ce=b({get(){let e=m.value;if(i.value){let t=i.value;return e.filter(a=>a.appName.indexOf(t)>=0)}else return e||(e=[]),e.filter(r=>r.id===0).length==0&&e.push(K),e},set(e){X(e,!1)}});function X(e,t){return l(this,null,function*(){let r=[];for(let s=0;s<e.length;s++){let p=e[s];p.id&&r.push({id:p.id,orderNum:s+1})}yield k({list:r,star:t}),yield I(!0)})}const me=b({get(){let e=W.value;if(i.value){let t=i.value;return e.filter(a=>a.appName.indexOf(t)>=0)}else return e},set(e){X(e,!0)}});function Ae(e,t){q(e),T.value=t}function ge(e,t){return l(this,null,function*(){q(e),t.starStatus==1?yield d({id:t.id,starStatus:0}):yield d({id:t.id,starStatus:1}),yield I()})}function ve(e){return l(this,null,function*(){yield f(e),yield I()})}function Ne(e,t){return l(this,null,function*(){yield x({appId:e,groupId:t})})}const J=$({star:!1,all:!1,starApp:!1});function he(e,t){q(e),J[t]=!J[t]}function Ge(e,t){q(e),t.collapsed=!t.collapsed}function we(e){Object.keys(y).map(t=>{y[t]=e[t]})}function q(e){e.preventDefault(),e.stopPropagation()}return M(()=>o.getTenant,e=>l(this,null,function*(){e&&(yield I())}),{immediate:!0}),M(y,e=>l(this,null,function*(){yield Q(),E()})),M(i,()=>{E()}),{reload:I,allAppList:m,appGroupList:w,appGroupRelationList:O,starGroupList:ne,activeStarGroupId:T,starGroupAppList:v,showStarAppList:me,leftSelectedGroup:A,onChangeLeftSelectedGroup:ue,isActiveClass:oe,selectedGroupAppList:le,starGroupAndAppList:D,onChangeListGroupAppOrder:ae,activeStarGroupAppList:fe,changeGroupStar:ge,deleteOneGroup:ve,onChangeActiveStarGroupId:Ae,lastAddAppId:j,lastAddGroup:U,keyword:i,showList:ce,addRelation:Ne,groupCollapsed:J,onChangeGroupCollapsed:he,starAppList:W,pageCustomInfo:y,onChangePageCustomInfo:we,onChangeStarGroupCollapsed:Ge,onChangeSelfGroupOrder:pe}}export{Pe as a,Re as u};
