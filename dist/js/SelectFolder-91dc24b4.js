var pe=Object.defineProperty,_e=Object.defineProperties;var he=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var ke=Object.prototype.hasOwnProperty,ye=Object.prototype.propertyIsEnumerable;var G=(d,n,u)=>n in d?pe(d,n,{enumerable:!0,configurable:!0,writable:!0,value:u}):d[n]=u,J=(d,n)=>{for(var u in n||(n={}))ke.call(n,u)&&G(d,u,n[u]);if(A)for(var u of A(n))ye.call(n,u)&&G(d,u,n[u]);return d},K=(d,n)=>_e(d,he(n));import{d as ee,f as a,V as b,a6 as p,af as me,ai as M,a5 as f,ak as B,ae as U,a7 as _,W as O,am as Q,F as X,k as m,a8 as ge,a3 as je,a4 as qe,u as i,n as xe}from"./vue-vendor-24c7dc61.js";import{a as Y,l as Ce}from"./index-831af9dd.js";import{D as Ne,s as we}from"./FileList.api-9749c044.js";import{h as Z}from"./antd-vue-vendor-0d72f01e.js";import"./vxe-table-vendor-8813019a.js";const Fe={style:{"font-size":"17px"}},Ie={style:{"margin-top":"20px",width:"100%",display:"flex"},class:"flex-row"},Te=["onClick"],Se={key:0,class:"operation"},be={class:"folder-search"},Be={class:"icon-create-folder"},De={class:"folder-content"},Pe={class:"folder-node"},$e={class:"text-list"},ze=["onClick","onDblclick"],Ee={key:0},Re=["onClick"],Ve={key:1,style:{color:"#999","font-size":"14px","text-align":"center","margin-top":"20px"}},He=ee({name:"select-folder"}),Me=ee(K(J({},He),{emits:["register","ok"],setup(d,{expose:n,emit:u}){const w=a(""),le=a(600),D=a(!1),{createMessage:Ue}=Y(),F=a(""),c=a([]),P=a(!1),o=a(""),h=a(""),v=a("我的文档"),r=a(""),I=a(""),g=a(!0),ae=Y(),$=a({width:"0px"}),z=a({"min-width":"0px","margin-left":"0px"}),L=a(),T=a(),Oe=a(""),x=a(!1),S=a(""),k=a(""),C=a([]),E=a("");function N(){P.value=!0,i(o)||(o.value=h.value),i(o)=="all"&&(o.value="");let e={parentId:o.value,searchText:F.value};Ne(e).then(l=>{l.success&&(l.result&&l.result.length>0?c.value=l.result.filter(s=>i(E).indexOf(s.id)==-1):c.value=[])}).finally(()=>{P.value=!1})}function te(e){w.value="上传到",R(e),S.value="add"}function R(e){o.value=e.pid,h.value=e.firstPid,v.value=e.firstTitle,k.value=e.firstTitle,r.value=e.fileName,g.value=!0,N(),D.value=!0,x.value=!0}function se(){if(!i(k)){ae.createMessage.warning("请选择一个文件夹");return}u("ok",{pid:o.value,folderName:i(r),firstTitle:i(v.value)?i(v.value):i(k),firstPid:h.value,folderType:S.value}),W()}function W(){D.value=!1,I.value="",k.value="",E.value=""}function ne(e){if(I.value=e.id,e.id&&e.id!=-1&&(o.value=e.id),!i(v))h.value=e.id,k.value=e.fileName;else{let l=C.value.filter(s=>s.key!=s.id);(!l||l.length==0)&&C.value.push({title:e.fileName,key:e.id})}}function j(e){o.value=e.id,I.value="",i(v)?r.value.push({title:e.fileName,key:e.id}):(v.value=e.fileName,k.value=e.fileName,h.value=e.id),g.value=!0,x.value=!0,N()}function V(e){if(e=="all")r.value=[],C.value=[],v.value="",g.value=!1,o.value="all",N(),x.value=!1,k.value="";else{x.value=!0;const l=a([]);e==="firstPid"?(o.value=h.value,r.value=[],C.value=[]):o.value=e;for(let s=0;s<r.value.length&&e!=r.value[s].key;s++)l.value.push({key:r.value[s].key,title:r.value[s].title});g.value=!0,r.value=l.value,C.value=l.value,N()}}function oe(){$.value.width="150px",z.value["margin-left"]="-60px",L.value.focus()}function ie(){F.value="",$.value={width:"0px"},z.value={"min-width":"0px","margin-left":"0px"}}function ue(){N()}function ce(){xe(()=>{c.value.length>0?c.value[0].id!=-1&&c.value.unshift({id:"-1",fileName:"",showInput:!0}):c.value.unshift({id:"-1",fileName:"",showInput:!0}),setTimeout(()=>{var e;T.value&&((e=T.value)!=null&&e.focus)&&T.value.focus()},100)})}function q(e){if(e.fileName&&e.id==-1){let l={fileName:e.fileName,fileType:"folder",izFolder:"1",storeType:"manage",delFlag:"0"};i(o)?l.parentId=o.value:l.parentId=h.value,we(l).then(s=>{s.success&&(e=s.result,e.showInput=!1,c.value[0]=e)})}else i(c).length>0&&i(c)[0].id==-1&&c.value.shift()}function re(e){let l=Z(e);R(l),w.value="复制到",S.value="copy"}function de(e){let l=Z(e);R(l),w.value="移动到",S.value="move",E.value=l.copyId}return n({add:te,copyFile:re,moveFile:de}),(e,l)=>{const s=b("a-input"),H=b("Icon"),fe=b("a-spin"),ve=b("a-modal");return p(),me(ve,{width:le.value,open:D.value,onCancel:W,cancelText:"关闭",onOk:se,bodyStyle:{height:"400px"},wrapClassName:"dialog"},{title:M(()=>[f("span",Fe,B(w.value),1),f("div",Ie,[f("div",{class:"title-header",style:U(z.value)},[f("span",{class:"file-header",style:U({color:g.value?"#1e88e5":""}),onClick:l[0]||(l[0]=t=>V("all"))},"全部文件",4),v.value?(p(),_("span",{key:0,class:"file-header",style:{color:"#1e88e5"},onClick:l[1]||(l[1]=t=>V("firstPid"))},"/"+B(v.value),1)):O("",!0),(p(!0),_(X,null,Q(r.value,t=>(p(),_("span",{class:"file-header",style:{color:"#1e88e5"},onClick:y=>V(t.key)},"/"+B(t.title),9,Te))),256))],4),x.value?(p(),_("div",Se,[f("span",be,[m(s,{ref_key:"searchRef",ref:L,value:F.value,"onUpdate:value":l[2]||(l[2]=t=>F.value=t),class:"search-folder animated",placeholder:"请输入文件名称并回车",style:U($.value),onBlur:ie,onPressEnter:ue},null,8,["value","style"]),m(H,{icon:"ant-design:search-outlined",class:"icon-search-folder",onClick:oe})]),f("span",Be,[m(H,{icon:"ant-design:folder-add-outlined",class:"icon-search-folder",onClick:ce})])])):O("",!0)])]),default:M(()=>[m(fe,{spinning:P.value},{default:M(()=>[f("div",De,[f("div",Pe,[f("ul",$e,[c.value.length>0?(p(!0),_(X,{key:0},Q(c.value,t=>(p(),_("li",{class:ge(["text-item",t.id===I.value?"text-item-back":""]),onClick:y=>ne(t),onDblclick:y=>j(t)},[m(H,{class:"icon-type",icon:"ant-design:folder-outlined",style:{color:"rgb(253, 202, 7)"}}),t.showInput?(p(),_("span",Ee,[m(s,{placeholder:"请输入文件名称",ref_for:!0,ref_key:"addFolderRef",ref:T,class:"ellipsis add-folder-input",value:t.fileName,"onUpdate:value":y=>t.fileName=y,onPressEnter:y=>q(t),onBlur:y=>q(t)},null,8,["value","onUpdate:value","onPressEnter","onBlur"])])):O("",!0),f("span",{class:"text-name ellipsis",onClick:y=>j(t)},B(t.fileName),9,Re)],42,ze))),256)):(p(),_("li",Ve," 没有子文件夹 "))])])])]),_:1},8,["spinning"])]),_:1},8,["width","open"])}}}));const Qe=Ce(Me,[["__scopeId","data-v-272fd590"]]);export{Qe as default};
