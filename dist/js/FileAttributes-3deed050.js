var ie=Object.defineProperty,ce=Object.defineProperties;var de=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var ue=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var $=(d,u,r)=>u in d?ie(d,u,{enumerable:!0,configurable:!0,writable:!0,value:r}):d[u]=r,G=(d,u)=>{for(var r in u||(u={}))ue.call(u,r)&&$(d,r,u[r]);if(q)for(var r of q(u))re.call(u,r)&&$(d,r,u[r]);return d},K=(d,u)=>ce(d,de(u));import{d as O,f as c,r as W,o as pe,b as fe,V as m,a6 as t,a7 as v,a5 as e,af as p,u as w,ak as _,F as _e,am as ve,a8 as he,q as D,A as L,k as h,ai as C,ae as J,E as x,W as me,a3 as ge,a4 as ye}from"./vue-vendor-24c7dc61.js";import{a as ke,ap as xe,l as be}from"./index-831af9dd.js";import{G as we,n as Ce}from"./FileList.api-9749c044.js";import Ue from"./FileLog-856778d4.js";import{L as Ie}from"./link-d33a2dbc.js";import"./antd-vue-vendor-0d72f01e.js";import"./vxe-table-vendor-8813019a.js";import"./FilePopover-961bdae7.js";import"./header-55b09394.js";const f=d=>(ge("data-v-3ca23c0d"),d=d(),ye(),d),ze={key:0,class:"drawer"},Fe={class:"file-name",style:{display:"flex"}},De=["src"],Le={class:"attribute-name ellipsis"},Se={class:"tabs"},Ve={style:{"padding-bottom":"15px",width:"100%"}},Pe=["onClick"],Be={class:"basic"},Ne={class:"ellipsis flex"},Te=f(()=>e("span",{class:"basic-font"},"创  建  者",-1)),Ae={class:"ellipsis flex"},Ee=["src"],He={class:"ellipsis flex"},Re=f(()=>e("span",{class:"basic-font"},"类        型",-1)),Me={class:"ellipsis flex"},je={class:"ellipsis flex"},qe=f(()=>e("span",{class:"basic-font"},"存储位置",-1)),$e={class:"ellipsis flex"},Ge={class:"ellipsis flex"},Ke=f(()=>e("span",{class:"basic-font"},"创建时间",-1)),We={class:"ellipsis flex"},Je=f(()=>e("span",{class:"basic-font"},"最近修改",-1)),Oe={class:"ellipsis flex"},Qe=f(()=>e("span",{class:"basic-font"},"浏  览  数",-1)),Xe={class:"ellipsis flex"},Ye=f(()=>e("span",{class:"basic-font"},"下  载  数",-1)),Ze={class:"ellipsis flex"},es=f(()=>e("span",{class:"basic-font"},"分享链接",-1)),ss={style:{"margin-top":"10px",height:"60px"}},ls={class:"ellipsis flex"},as=f(()=>e("span",{class:"basic-font"},"允许下载",-1)),ts={key:1},ns={class:"ellipsis flex",style:{"margin-top":"10px","margin-bottom":"10px"}},os=f(()=>e("span",{class:"basic-font"},"允许编辑",-1)),is={key:1},cs={style:{"margin-top":"10px",height:"100px"}},ds=f(()=>e("div",{class:"ellipsis flex"},[e("span",{class:"basic-font"},"分享链接预览权限")],-1)),us={class:"log"},rs={class:"hold"},ps={key:1,class:"drawer",style:{"text-align":"center"}},fs=f(()=>e("div",{style:{position:"relative",top:"50%"}},[x(" 选择一个文件或文件夹 "),e("br"),x(" 可查看其属性和日志 ")],-1)),_s=[fs],vs=O({name:"file-attributes"}),hs=O(K(G({},vs),{emits:["register","expand","refresh","load-table"],setup(d,{expose:u,emit:r}){const g=c(!1),n=c(""),S=c(""),V=c(""),ms=c(""),l=c({}),P=c(),y=c("1"),Q=W([{key:"1",name:"属性"},{key:"2",name:"日志"}]),{createMessage:X}=ke(),B=W({display:"flex",height:"30px",lineHeight:"30px"}),b=c(!1),N=c(),U=c(),I=c(!1),k=c(""),T=c(""),A=c("");function Y(a){y.value="1",n.value=a.ext,P.value=a.izFolder,k.value=a.authority,T.value=a.createBy,A.value=a.username,w(I)?I.value=!1:E(a.id)}function E(a){we({fileId:a}).then(s=>{s.success?(s.result.sharePerms=s.result.sharePerms?s.result.sharePerms:"1",l.value=s.result,S.value=V.value+"/"+s.result.fileName):l.value={}}).finally(()=>{g.value=!0})}function Z(a){return xe(a)}function ee(a){V.value=a}function se(a){y.value=a,a=="1"?E(l.value.fileId):N.value.loadFileLog(l.value.fileId)}function z(a,s){let i={};s=="enableDown"?i={enableDown:a,type:s}:s=="enableUpdat"?i={enableUpdat:a,type:s}:s=="sharePerms"&&(i={sharePerms:a,type:s}),i.fileId=l.value.fileId,Ce(i).then(F=>{F.success&&(X.success("操作成功"),r("load-table"))})}function le(){r("expand",w(b))}function ae(){g.value=!1}function te(a){l.value="",a&&(I.value=!0)}const H=a=>{U.value&&!U.value.contains(a.target)&&(w(b)||(g.value=!1,r("refresh")))};return pe(()=>{document.addEventListener("click",H)}),fe(()=>{document.removeEventListener("click",H)}),u({show:Y,setTitle:ee,hideVisible:ae,clear:te}),(a,s)=>{const i=m("Icon"),F=m("a-input"),R=m("a-divider"),M=m("a-switch"),j=m("a-radio"),ne=m("a-radio-group"),oe=m("a-checkbox");return t(),v("div",{ref_key:"drawerRef",ref:U,style:{height:"100%"}},[g.value&&l.value?(t(),v("div",ze,[e("div",Fe,[n.value==="jpg"||n.value==="png"||n.value==="jpeg"||n.value==="gif"?(t(),p(i,{key:0,class:"file-icon",icon:"ant-design:file-image-outlined",style:{color:"rgb(255, 87, 34)"}})):n.value==="xls"||n.value==="xlsx"?(t(),p(i,{key:1,class:"file-icon",icon:"ant-design:file-excel-outlined",style:{color:"rgb(98, 187, 55)"}})):n.value==="pdf"?(t(),p(i,{key:2,class:"file-icon",icon:"ant-design:file-pdf-outlined",style:{color:"rgb(211, 47, 47)"}})):n.value==="doc"||n.value==="docx"?(t(),p(i,{key:3,class:"file-icon",icon:"ant-design:file-word-outlined",style:{color:"rgb(68, 138, 255)"}})):n.value==="ppt"||n.value==="pptx"?(t(),p(i,{key:4,class:"file-icon",icon:"ant-design:file-ppt-outlined",style:{color:"rgb(245, 124, 0)"}})):n.value==="video"?(t(),p(i,{key:5,class:"file-icon",icon:"ant-design:play-square-outlined",style:{color:"rgb(119, 87, 188)"}})):n.value==="txt"?(t(),p(i,{key:6,class:"file-icon",icon:"ant-design:file-text-outlined",style:{color:"rgb(41, 211, 178)"}})):n.value==="zip"?(t(),p(i,{key:7,class:"file-icon",icon:"ant-design:file-zip-outlined",style:{color:"rgb(253, 202, 7)"}})):P.value==="1"?(t(),p(i,{key:8,icon:"ant-design:folder-open-outlined",class:"file-icon",style:{color:"rgb(253, 202, 7)"}})):n.value==="url"?(t(),v("img",{key:9,src:w(Ie),class:"file-icon"},null,8,De)):(t(),p(i,{key:10,class:"file-icon",icon:"ant-design:file-unknown-outlined"})),e("span",Le,_(l.value.fileName),1)]),e("div",Se,[e("ul",Ve,[(t(!0),v(_e,null,ve(Q,o=>(t(),v("li",{class:he(o.key===y.value?"click-color":""),key:o.key,onClick:gs=>se(o.key)},_(o.name),11,Pe))),128))])]),D(e("div",Be,[e("ul",null,[e("li",Ne,[Te,e("span",Ae,[e("img",{src:Z(l.value.avatar),class:"avatar-box"},null,8,Ee),e("span",null,_(l.value.realname),1)])]),e("li",He,[Re,e("span",Me,_(n.value?n.value:"文件夹"),1)]),e("li",je,[qe,e("span",$e,_(S.value),1)]),e("li",Ge,[Ke,e("span",null,_(l.value.createTime),1)]),e("li",We,[Je,e("span",null,_(l.value.updateTime),1)]),e("li",Oe,[Qe,e("span",null,_(l.value.readCount?l.value.readCount:0),1)]),e("li",Xe,[Ye,e("span",null,_(l.value.downCount?l.value.downCount:0),1)]),e("li",Ze,[es,h(F,{style:{height:"25px !important","margin-top":"5px"},value:l.value.shareUrl,readonly:"",size:"small"},null,8,["value"])])]),h(R),e("div",ss,[e("div",ls,[as,k.value==="owner"||k.value==="admin"||k.value==="editable"&&T.value===A.value?(t(),p(M,{key:0,checked:l.value.enableDown,"onUpdate:checked":s[0]||(s[0]=o=>l.value.enableDown=o),checkedValue:"1",unCheckedValue:"0",onClick:s[1]||(s[1]=o=>z(o,"enableDown")),size:"small"},null,8,["checked"])):(t(),v("span",ts,_(l.value.enableDown==="0"?"不允许":"允许"),1))]),e("div",ns,[os,k.value!=="readonly"?(t(),p(M,{key:0,checked:l.value.enableUpdat,"onUpdate:checked":s[2]||(s[2]=o=>l.value.enableUpdat=o),checkedValue:"1",unCheckedValue:"0",onClick:s[3]||(s[3]=o=>z(o,"enableUpdat")),size:"small"},null,8,["checked"])):(t(),v("span",is,_(l.value.enableUpdat==="0"?"不允许":"允许"),1))])]),h(R),e("div",cs,[ds,e("div",null,[h(ne,{value:l.value.sharePerms,"onUpdate:value":s[4]||(s[4]=o=>l.value.sharePerms=o),onChange:s[5]||(s[5]=o=>z(o.target.value,"sharePerms"))},{default:C(()=>[h(j,{style:J([B,{"font-size":"13px"}]),value:"1"},{default:C(()=>[x("关闭分享")]),_:1},8,["style"]),h(j,{style:J([B,{"font-size":"13px"}]),value:"3"},{default:C(()=>[x("允许任何人查看")]),_:1},8,["style"])]),_:1},8,["value"])])])],512),[[L,y.value=="1"]]),D(e("div",us,[h(Ue,{ref_key:"fileLogRef",ref:N},null,512)],512),[[L,y.value=="2"]]),D(e("div",rs,[h(oe,{onChange:le,checked:b.value,"onUpdate:checked":s[6]||(s[6]=o=>b.value=o),style:{"font-size":"13px","margin-left":"10px"}},{default:C(()=>[x("保持展开")]),_:1},8,["checked"])],512),[[L,g.value]])])):g.value?(t(),v("div",ps,_s)):me("",!0)],512)}}}));const Ds=be(hs,[["__scopeId","data-v-3ca23c0d"]]);export{Ds as default};
