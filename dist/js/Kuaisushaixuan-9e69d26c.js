var G=Object.defineProperty,H=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var U=(e,o,s)=>o in e?G(e,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[o]=s,R=(e,o)=>{for(var s in o||(o={}))X.call(o,s)&&U(e,s,o[s]);if(N)for(var s of N(o))Y.call(o,s)&&U(e,s,o[s]);return e},K=(e,o)=>H(e,J(o));import{d as Z,f as _,e as j,h as ee,a3 as te,a4 as ue,a5 as a,V as m,a6 as c,a7 as y,F as C,k as n,ai as d,ak as Q,z,am as M,E as k,W,af as oe}from"./vue-vendor-24c7dc61.js";import{aC as ie,n as ne,cr as le,a_ as se,a$ as ae,be as re,p as pe}from"./antd-vue-vendor-0d72f01e.js";import{d as de}from"./vuedraggable-vendor-6ef4bc68.js";import me from"./KsShaixuanDrawer-b9f976a2.js";import{u as ce}from"./index-44229d9b.js";import{u as fe}from"./LinkRecordSelect-385d0eae.js";import{d as ye,s as x}from"./type.definition-4eb605ee.js";import{C as he}from"./ComponentIcon-f1bbb90f.js";import{l as Be}from"./index-831af9dd.js";import"./vxe-table-vendor-8813019a.js";import"./useFieldSelect-1dde1da7.js";import"./index-1c3affea.js";import"./BasicModal-58413bab.js";import"./useWindowSizeFn-8f085f6f.js";import"./SelectItem-04dd2229.js";import"./lowAppUtils-56892d30.js";import"./auto.desform.api-839115ed.js";import"./desformUtils-c7daaa89.js";import"./LinkRecordTags-cf4c2463.js";import"./FormSchemaFactory-ec827fa7.js";import"./index-bff0b654.js";import"./JUpload-76e119c7.js";import"./index-d508f1f4.js";import"./componentMap-c857637c.js";import"./useFormItem-86503382.js";import"./download-1ac6acce.js";import"./index-f99b266a.js";import"./JSelectUser-a44af43a.js";import"./useSelectBiz-2f560b0b.js";import"./props-8a7ac45b.js";import"./JSelectBiz-55a9591f.js";import"./JImageUpload-d644253a.js";import"./JDictSelectTag-54dc3bdb.js";import"./JSelectDept-a90caee3.js";import"./index-f2fd5a28.js";import"./useContextMenu-810f9346.js";import"./areaDataUtil-cdeee717.js";import"./china-area-data-vendor-556d14ee.js";import"./JPopup-2a779923.js";import"./useMethods-f689b480.js";import"./JCheckbox-0b89d32a.js";import"./JSelectUserByDept-bd619076.js";import"./UserSelectByDepModal-db060ece.js";import"./depart.api-339f4da6.js";import"./index-6507b9cd.js";import"./index-4d0525a5.js";import"./UserSelectModal-d78c1490.js";import"./lowAppAuth-3d637b7d.js";import"./useFuncSwitch-b7681246.js";import"./DictColors-73058d23.js";import"./TableImage-14ca1f5d.js";import"./SubTableTag-81763fd6.js";import"./CardCellFile-92b3c8c8.js";const Ee="/assets/kuaisushaixuan-9e256f16.png",ve=Z({name:"Kuaisushaixuan",props:{columnList:{type:Array,default:()=>[]},info:{type:Object,require:!1,default:{}}},components:{PlusOutlined:ie,SearchOutlined:ne,OrderedListOutlined:le,EditOutlined:se,DeleteOutlined:ae,draggable:de,KsShaixuanDrawer:me,QuestionCircleFilled:re,ComponentIcon:he},emits:["save"],setup(e,{emit:o}){const s=_([]),{getDefaultRule:T}=fe(),[b,{openDrawer:$}]=ce(),F=_(!1),B=_("");function S(t){let l=B.value;return l?t?t.name.indexOf(l)>=0:!1:!0}function V(t){let l=t.field||t.model,i=s.value,p=T(t.type);i.push({field:l,type:t.type,name:t.name,seq:99,queryType:p}),s.value=i,F.value=!1,u()}const I=()=>{F.value=!0},q=j(()=>{let t=e.columnList;if(!t||t.length==0)return[];let l=t.filter(r=>ye.indexOf(r.type)<0),i=[],p=s.value.map(r=>r.field);for(let r of l)p&&p.indexOf(r.model)>=0||i.push({field:r.model,type:r.type,name:r.name});for(let r of x)p&&p.indexOf(r.field)>=0||i.push({field:r.field,type:r.type,name:r.name});return i});function O(){u()}function D(t){let l=s.value;l.splice(t,1),s.value=l,u()}let E=-1;function L(t,l){E=l,$(!0,{record:t})}function A(t){let l=s.value;if(E<0)return;let i=l[E];t.field?(i.field=t.field,i.queryType=t.queryType,i.type=t.type,i.name=t.name):i.queryType=t.queryType,s.value=l,u()}const f=_(!0),h=_(!1);function P(){o("save",{queryButton:f.value,waitQuery:h.value})}const g=_(!1);function u(){let t=s.value,l=[];if(t&&t.length>0)for(let p=0;p<t.length;p++){let r=pe(t[p],"field","queryType","type");l.push(K(R({},r),{seq:p}))}let i={queryList:l,queryButton:f.value,waitQuery:h.value};!t||t.length<4?g.value=!1:(g.value=!0,f.value=!0,i.queryButton=!0),o("save",i)}function v(t,l){let i=l.filter(r=>r.model==t);if(i&&i.length>0)return i[0].name;let p=x.filter(r=>r.field==t);return p&&p.length>0?p[0].name:""}return ee(()=>{let t=[],l=e.columnList,i=e.info;if(l&&l.length>0&&i&&i.queryList)for(let p of i.queryList){let r=v(p.field,l);t.push({name:r,field:p.field,type:p.type,queryType:p.queryType,seq:1})}s.value=t,i&&(i.hasOwnProperty("queryButton")&&(f.value=i.queryButton),i.hasOwnProperty("waitQuery")&&(h.value=i.waitQuery))}),{queryList:s,noDataImage:Ee,onAdd:I,showPop:F,filterValue:B,isFilterItem:S,onSelectField:V,selectList:q,onDragEnd:O,onRemove:D,onEdit:L,editOk:A,registerDrawer:b,queryButton:f,waitQuery:h,handleChangeStatus:P,queryButtonDisabled:g}}});const w=e=>(te("data-v-3217ecd6"),e=e(),ue(),e),_e={class:"inner-content"},Fe={key:0},ge=w(()=>a("div",{class:"title"},"快速筛选",-1)),Ce=w(()=>a("div",{class:"tip"},"选择字段作为快速筛选器平铺显示在视图中，以帮助用户快速查询记录。",-1)),ke={class:"config-detail",style:{width:"320px","padding-top":"0"}},we={class:"query-field-list"},qe={class:"query-field-item"},Oe={style:{width:"30px","padding-left":"5px"}},De={style:{flex:"1"}},Le={class:"ellipsis"},Ae={class:"right-icon"},Se={style:{width:"100%"}},Ve={class:"field-list"},Ie=["onClick"],Pe=w(()=>a("span",{style:{"margin-left":"10px"}},"选择字段",-1)),Qe=w(()=>a("div",{style:{color:"#333!important","margin-top":"32px!important","font-weight":"700!important"}}," 设置 ",-1)),Te={style:{"margin-top":"13px"}},be={style:{"margin-top":"13px"}},$e=w(()=>a("span",null,[a("h6",null," 快速筛选 "),a("div",{class:"tip"},"选择字段作为快速筛选器平铺显示在视图中，以帮助用户快速查询记录。")],-1)),Ne={class:"field-list"},Ue=["onClick"];function Re(e,o,s,T,b,$){const F=m("OrderedListOutlined"),B=m("component-icon"),S=m("EditOutlined"),V=m("DeleteOutlined"),I=m("draggable"),q=m("SearchOutlined"),O=m("a-input"),D=m("PlusOutlined"),E=m("a-button"),L=m("a-popover"),A=m("a-checkbox"),f=m("QuestionCircleFilled"),h=m("a-tooltip"),P=m("a-empty"),g=m("ks-shaixuan-drawer");return c(),y(C,null,[a("div",_e,[e.queryList.length>0?(c(),y("div",Fe,[ge,Ce,a("div",ke,[a("div",we,[n(I,{"item-key":"name",animation:"300",modelValue:e.queryList,"onUpdate:modelValue":o[0]||(o[0]=u=>e.queryList=u),dragClass:"dragClass",onEnd:e.onDragEnd},{item:d(({element:u,index:v})=>[a("div",qe,[a("div",Oe,[n(F,{title:"调整顺序"})]),a("div",De,[n(B,{type:u.type},null,8,["type"]),a("span",Le,Q(u.name),1)]),a("div",Ae,[n(S,{title:"编辑",onClick:z(t=>e.onEdit(u,v),["prevent"])},null,8,["onClick"]),n(V,{title:"删除",onClick:z(t=>e.onRemove(v),["prevent"])},null,8,["onClick"])])])]),_:1},8,["modelValue","onEnd"])]),a("div",Se,[n(L,{overlayClassName:"view-pop-field-select",open:e.showPop,"onUpdate:open":o[2]||(o[2]=u=>e.showPop=u),trigger:"click"},{content:d(()=>[a("div",Ve,[(c(!0),y(C,null,M(e.selectList,u=>(c(),y(C,null,[e.isFilterItem(u)?(c(),y("div",{key:0,class:"field-item",onClick:v=>e.onSelectField(u)},[a("div",null,[n(B,{type:u.type},null,8,["type"]),k(Q(u.name),1)])],8,Ie)):W("",!0)],64))),256))])]),title:d(()=>[n(O,{placeholder:"搜索字段",class:"my-input",value:e.filterValue,"onUpdate:value":o[1]||(o[1]=u=>e.filterValue=u)},{prefix:d(()=>[n(q,{style:{color:"#c0c0c0"}})]),_:1},8,["value"])]),default:d(()=>[n(E,{block:"",onClick:e.onAdd},{default:d(()=>[n(D),Pe]),_:1},8,["onClick"])]),_:1},8,["open"])]),Qe,a("div",Te,[n(A,{checked:e.queryButton,"onUpdate:checked":o[3]||(o[3]=u=>e.queryButton=u),onChange:e.handleChangeStatus,disabled:e.queryButtonDisabled},{default:d(()=>[k("启用查询按钮")]),_:1},8,["checked","onChange","disabled"]),n(h,{title:"启用按钮后，点击查询按钮执行筛选。当筛选字段超过3个时必须启用。"},{default:d(()=>[n(f,{style:{color:"#9e9e9e"}})]),_:1})]),a("div",be,[n(A,{checked:e.waitQuery,"onUpdate:checked":o[4]||(o[4]=u=>e.waitQuery=u),onChange:e.handleChangeStatus},{default:d(()=>[k("在执行查询后显示数据")]),_:1},8,["checked","onChange"]),n(h,{title:"勾选后，进入视图初始不显示数据，查询后显示符合筛选条件的数据。"},{default:d(()=>[n(f,{style:{color:"#9e9e9e"}})]),_:1})])])])):(c(),oe(P,{key:1,class:"no-data",image:e.noDataImage,"image-style":{height:"222px",marginTop:"50px"}},{description:d(()=>[$e]),default:d(()=>[n(L,{overlayClassName:"view-pop-field-select",open:e.showPop,"onUpdate:open":o[6]||(o[6]=u=>e.showPop=u),trigger:"click"},{content:d(()=>[a("div",Ne,[(c(!0),y(C,null,M(e.selectList,u=>(c(),y(C,null,[e.isFilterItem(u)?(c(),y("div",{key:0,class:"field-item",onClick:v=>e.onSelectField(u)},[a("div",null,[n(B,{type:u.type},null,8,["type"]),k(Q(u.name),1)])],8,Ue)):W("",!0)],64))),256))])]),title:d(()=>[n(O,{placeholder:"搜索字段",class:"my-input",value:e.filterValue,"onUpdate:value":o[5]||(o[5]=u=>e.filterValue=u)},{prefix:d(()=>[n(q,{style:{color:"#c0c0c0"}})]),_:1},8,["value"])]),default:d(()=>[n(E,{onClick:e.onAdd,type:"primary",style:{"border-radius":"15px"}},{default:d(()=>[n(D),k("选择字段 ")]),_:1},8,["onClick"])]),_:1},8,["open"])]),_:1},8,["image"]))]),n(g,{onRegister:e.registerDrawer,onOk:e.editOk,columnList:e.columnList},null,8,["onRegister","onOk","columnList"])],64)}const Kt=Be(ve,[["render",Re],["__scopeId","data-v-3217ecd6"]]);export{Kt as default};
