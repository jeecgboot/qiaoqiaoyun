import Y from"./BasicTable-d435f501.js";import{u as ee}from"./useListPage-62a041ef.js";import{r as te}from"./application.data-33c48cb5.js";import{d as ae,e as m,V as B,a6 as r,af as g,a8 as ne,ai as I,a7 as l,F as b,E as U,ak as w,W as v,a5 as ie,k as O}from"./vue-vendor-24c7dc61.js";import{a as de}from"./useRoleAuth-039fb12a.js";import{bJ as re,cc as se,aZ as oe}from"./antd-vue-vendor-0d72f01e.js";import{l as le}from"./index-831af9dd.js";import"./index-52c8c841.js";import"./useForm-14b2bc77.js";import"./componentMap-c857637c.js";import"./useFormItem-86503382.js";import"./index-1c3affea.js";import"./BasicModal-58413bab.js";import"./useWindowSizeFn-8f085f6f.js";import"./download-1ac6acce.js";import"./index-f99b266a.js";import"./JSelectUser-a44af43a.js";import"./useSelectBiz-2f560b0b.js";import"./props-8a7ac45b.js";import"./JSelectBiz-55a9591f.js";import"./JImageUpload-d644253a.js";import"./JDictSelectTag-54dc3bdb.js";import"./JSelectDept-a90caee3.js";import"./index-f2fd5a28.js";import"./useContextMenu-810f9346.js";import"./areaDataUtil-cdeee717.js";import"./china-area-data-vendor-556d14ee.js";import"./JPopup-2a779923.js";import"./useMethods-f689b480.js";import"./JCheckbox-0b89d32a.js";import"./vxe-table-vendor-8813019a.js";import"./JSelectUserByDept-bd619076.js";import"./UserSelectByDepModal-db060ece.js";import"./depart.api-339f4da6.js";import"./JUpload-76e119c7.js";import"./index-d508f1f4.js";import"./index-6507b9cd.js";import"./index-4d0525a5.js";import"./UserSelectModal-d78c1490.js";import"./helper-22dafba0.js";import"./JAreaLinkage-173780c9.js";import"./JCodeEditor-66bd225e.js";import"./codemirror-17b6f671.js";import"./codemirror-26b29690.js";import"./active-line-512fef49.js";import"./EasyCronInput-b2123242.js";import"./JEditor-249b2194.js";import"./index-b845562c.js";import"./index-621e597c.js";import"./application.api-4e2bde90.js";const he=ae({name:"ViewCurdAuthTable",components:{BasicTable:Y,CalendarOutlined:re,SlidersOutlined:se,TableOutlined:oe},props:{appId:{type:String,default:""},authData:{type:Array,default:()=>[]},menuList:{type:Array,default:()=>[]}},emits:["setting","data-change"],setup(n,{emit:h}){const{authDataList:c,getSaveData:V,authTableColumns:_,titleChecked:E,expandedRowKeys:k,settingAccess:D,childrenCheckCount:F,onRowClick:a,isDesform:u}=de(n),{prefixCls:i,tableContext:s}=ee({designScope:"low-app-auth-list",pagination:!1,tableProps:{}}),[z]=s,K=m({get(){return R("readChecked")},set(t){let e=c.value;x(e,"read",t)}}),P=m(()=>T("read")),H=m({get(){return R("updateChecked")},set(t){let e=c.value;x(e,"update",t)}}),J=m(()=>T("update")),W=m({get(){return R("deleteChecked")},set(t){let e=c.value;x(e,"delete",t)}}),Z=m(()=>T("delete")),j=m({get(){return R("createChecked")},set(t){let e=c.value;x(e,"create",t)}}),q=m(()=>T("create"));function x(t,e,d,o){if(t&&t.length>0)for(let p of t)p[e+"Checked"]=d,p.isForm&&(p[e+"InterChecked"]=!1,p.children&&x(p.children,e,d,!0));o||d===!0&&e!="read"&&(K.value=!0),S()}function R(t){let e=c.value;if(!e||e.length==0)return!1;let d=!0;for(let o of c.value)if(!(t.indexOf("read")<0&&o.type==="drag")&&o[t]===!1){d=!1;break}return d}function T(t){let e=!1,d=0,o=c.value;if(!o||o.length==0)return!1;for(let p of o)t.indexOf("read")<0&&p.type==="drag"||(p[t+"Checked"]===!0&&(d++,e=!0),p[t+"InterChecked"]===!0&&(e=!0));if(d>0){let p=o.filter(f=>u(f.type));t=="read"?d==o.length&&(e=!1):d==p.length&&(e=!1)}return e}function G(t,e,d){let o=t.target.checked;e.isForm?L(e,d,o):o===!0?(N(e,d),d!="read"&&(e.readChecked=!0,N(e,"read"))):M(e,d),S()}function L(t,e,d){if(d===!0&&(t[e+"InterChecked"]=!1,e!="read"&&(t.readChecked=!0,L(t,"read",!0))),t.children&&t.children.length>0)for(let o of t.children)o[e+"Checked"]=d}function N(t,e){let d=t.pid,f=c.value.filter(y=>y.id==d)[0],C=!0;for(let y of f.children)C=C&&y[e+"Checked"];f[e+"Checked"]=C,f[e+"InterChecked"]=!C}function M(t,e){let d=t.pid,f=c.value.filter(A=>A.id==d)[0],C=!0,y=!1;for(let A of f.children){let $=A[e+"Checked"];$===!0&&(y=!0),C=C&&$}f[e+"Checked"]=C,f[e+"InterChecked"]=y}function Q(t){let e={read:!0,update:!0,delete:!0,create:!0};return(t.readChecked===!0||t.readInterChecked===!0)&&(e.read=!1),(t.updateChecked===!0||t.updateInterChecked===!0)&&(e.update=!1),(t.deleteChecked===!0||t.deleteInterChecked===!0)&&(e.delete=!1),(t.createChecked===!0||t.createInterChecked===!0)&&(e.create=!1),e}function X(t,e){t.preventDefault(),t.stopPropagation();let d=Q(e),o={code:e.type==="form"?e.compatibleCode:e.id,title:e.title};h("setting",o,d)}function S(){h("data-change")}return{onRowClick:a,goFormSettings:X,roleColumns:te,authTableColumns:_,registerTable:z,titleChecked:E,authDataList:c,onCheckboxChange:G,expandedRowKeys:k,prefixCls:i,settingAccess:D,childrenCheckCount:F,headerRead:K,headerInterRead:P,headerInterCreate:q,headerCreate2:j,headerInterDelete:Z,headerDelete:W,headerInterUpdate:J,headerUpdate:H,getSaveData:V,onDataChange:S,isDesform:u}}});const pe={key:1},ue={key:0,style:{display:"flex","align-items":"center"}},ce={class:"title-text",style:{"margin-left":"8px"}},ke=["onClick"],fe={key:1},Ce={key:0},me={key:0},ge={key:0,style:{"font-size":"12px","margin-left":"8px"}},ye={key:1,style:{"font-size":"12px","margin-left":"8px"}},Ie={key:1};function be(n,h,c,V,_,E){const k=B("a-checkbox"),D=B("Icon"),F=B("BasicTable");return r(),g(F,{class:ne(n.prefixCls),onRowClick:n.onRowClick,onResiter:n.registerTable,expandedRowKeys:n.expandedRowKeys,"onUpdate:expandedRowKeys":h[4]||(h[4]=a=>n.expandedRowKeys=a),rowKey:"id",columns:n.authTableColumns,showIndexColumn:!1,bordered:!1,pagination:!1,dataSource:n.authDataList,tableLayout:"fixed"},{headerCell:I(({column:a})=>[a.dataIndex=="title"?(r(),l(b,{key:0},[U(" 应用项 ")],64)):a.dataIndex==="action2"?(r(),l("span",pe,"操作")):a.dataIndex==="read"?(r(),g(k,{key:2,checked:n.headerRead,"onUpdate:checked":h[0]||(h[0]=u=>n.headerRead=u),indeterminate:n.headerInterRead},{default:I(()=>[U(w(a.customTitle),1)]),_:2},1032,["checked","indeterminate"])):a.dataIndex==="update"?(r(),g(k,{key:3,checked:n.headerUpdate,"onUpdate:checked":h[1]||(h[1]=u=>n.headerUpdate=u),indeterminate:n.headerInterUpdate},{default:I(()=>[U(w(a.customTitle),1)]),_:2},1032,["checked","indeterminate"])):a.dataIndex==="delete"?(r(),g(k,{key:4,checked:n.headerDelete,"onUpdate:checked":h[2]||(h[2]=u=>n.headerDelete=u),indeterminate:n.headerInterDelete},{default:I(()=>[U(w(a.customTitle),1)]),_:2},1032,["checked","indeterminate"])):a.dataIndex==="create"?(r(),g(k,{key:5,checked:n.headerCreate2,"onUpdate:checked":h[3]||(h[3]=u=>n.headerCreate2=u),indeterminate:n.headerInterCreate},{default:I(()=>[U(w(a.customTitle),1)]),_:2},1032,["checked","indeterminate"])):v("",!0)]),bodyCell:I(({column:a,text:u,record:i})=>[a.dataIndex==="title"?(r(),l("div",ue,[i.isForm?(r(),g(D,{key:0,icon:i.icon},null,8,["icon"])):(r(),g(D,{key:1,icon:i.icon,color:"#aca8a8"},null,8,["icon"])),ie("span",ce,w(u),1)])):a.dataIndex==="action2"?(r(),l(b,{key:1},[i.isForm&&n.isDesform(i.type)?(r(),l(b,{key:0},[n.settingAccess(i)?(r(),l("span",{key:0,class:"table-action",style:{cursor:"pointer"},onClick:s=>n.goFormSettings(s,i)}," 设置 ",8,ke)):(r(),l("span",fe,"-"))],64)):v("",!0)],64)):a.dataIndex==="create"?(r(),l(b,{key:2},[i.isForm&&n.isDesform(i.type)?(r(),l("span",Ce,[O(k,{checked:i.createChecked,"onUpdate:checked":s=>i.createChecked=s,indeterminate:i.createInterChecked,onChange:s=>n.onCheckboxChange(s,i,a.dataIndex)},null,8,["checked","onUpdate:checked","indeterminate","onChange"])])):v("",!0)],64)):(r(),l(b,{key:3},[i.isForm===!0?(r(),l("span",me,[n.isDesform(i.type)?(r(),l(b,{key:0},[O(k,{checked:i[a.dataIndex+"Checked"],"onUpdate:checked":s=>i[a.dataIndex+"Checked"]=s,indeterminate:i[a.dataIndex+"InterChecked"],onChange:s=>n.onCheckboxChange(s,i,a.dataIndex)},null,8,["checked","onUpdate:checked","indeterminate","onChange"]),i[a.dataIndex+"Checked"]?(r(),l("span",ge,"全部")):i[a.dataIndex+"InterChecked"]?(r(),l("span",ye,w(n.childrenCheckCount(i,a.dataIndex))+"个 ",1)):v("",!0)],64)):a.dataIndex==="read"?(r(),l("span",Ie,[O(k,{checked:i[a.dataIndex+"Checked"],"onUpdate:checked":s=>i[a.dataIndex+"Checked"]=s,onChange:s=>n.onCheckboxChange(s,i,a.dataIndex)},null,8,["checked","onUpdate:checked","onChange"])])):v("",!0)])):(r(),g(k,{key:1,checked:i[a.dataIndex+"Checked"],"onUpdate:checked":s=>i[a.dataIndex+"Checked"]=s,onChange:s=>n.onCheckboxChange(s,i,a.dataIndex)},null,8,["checked","onUpdate:checked","onChange"]))],64))]),_:1},8,["class","onRowClick","onResiter","expandedRowKeys","columns","dataSource"])}const gt=le(he,[["render",be]]);export{gt as default};
