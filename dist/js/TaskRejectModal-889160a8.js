var C=(t,n,r)=>new Promise((l,a)=>{var m=o=>{try{s(r.next(o))}catch(c){a(c)}},i=o=>{try{s(r.throw(o))}catch(c){a(c)}},s=o=>o.done?l(o.value):Promise.resolve(o.value).then(m,i);s((r=r.apply(t,n)).next())});import{d as R,f as p,r as w,I as x,a5 as f,V as _,a6 as k,af as N,ai as v,k as y,E as j,a7 as B,F as h,am as F,ak as K,W as I}from"./vue-vendor-24c7dc61.js";import{B as A}from"./index-1c3affea.js";import{j as U,a as D,k as L,l as V}from"./index-831af9dd.js";import"./BasicModal-58413bab.js";import"./antd-vue-vendor-0d72f01e.js";import"./useWindowSizeFn-8f085f6f.js";import"./vxe-table-vendor-8813019a.js";const S=R({name:"TaskRejectModal",components:{BasicModal:A},emits:["register","reject"],setup(t,{emit:n}){const r=p("驳回"),l=p(""),a=p(""),m=p(""),i=p(""),s=p([]),{createMessage:o}=D(),[c,{closeModal:g}]=U(u=>C(this,null,function*(){l.value="";let d=u.histListNode;d&&d.length>0?(s.value=d,a.value=d[0].TASK_DEF_KEY_):(s.value=[],a.value=[]),m.value=u.currentTaskKey,i.value=u.taskId})),e=w({taskId:"",nextnode:"",nextCodeCount:1,reason:"",processModel:3,rejectModelNode:"",nextUserName:"",nextUserId:"",ccUserIds:"",ccUserRealNames:"",fileList:""});function M(){return C(this,null,function*(){if(!l.value){o.warning("请填写审批意见");return}let u=a.value;if(!u||u.length==0){o.warning("请选择驳回节点");return}Object.keys(e).map(T=>{e[T]=""}),e.processModel=3,e.nextCodeCount=1,e.reason=l.value,e.rejectModelNode=a.value,e.taskId=i.value;const d="/act/task/processComplete";let E=x(e);const P=yield L.post({url:d,params:E});n("reject"),g()})}return{registerModal:c,modalTitle:r,taskComment:l,historyList:s,rejectNode:a,doReject:M,currentTaskKey:m}}}),$=f("div",{style:{color:"#757575"}}," 审批意见 ",-1),b={style:{"margin-top":"10px"}},Y=f("div",{style:{color:"#757575","margin-top":"20px"}}," 退回到 ",-1),H={style:{"margin-top":"10px"}};function O(t,n,r,l,a,m){const i=_("a-textarea"),s=_("a-select-option"),o=_("a-select"),c=_("a-button"),g=_("BasicModal");return k(),N(g,{onRegister:t.registerModal,title:t.modalTitle,canFullscreen:!1,minHeight:80,width:560,destroyOnClose:""},{footer:v(()=>[y(c,{danger:"",type:"primary",onClick:t.doReject},{default:v(()=>[j("确定")]),_:1},8,["onClick"])]),default:v(()=>[f("div",null,[$,f("div",b,[y(i,{value:t.taskComment,"onUpdate:value":n[0]||(n[0]=e=>t.taskComment=e),placeholder:"请填写审批意见","auto-size":{minRows:5,maxRows:10}},null,8,["value"])]),Y,f("div",H,[y(o,{value:t.rejectNode,"onUpdate:value":n[1]||(n[1]=e=>t.rejectNode=e),getPopupContainer:e=>e.parentNode,style:{width:"150px"}},{default:v(()=>[(k(!0),B(h,null,F(t.historyList,(e,M)=>(k(),B(h,null,[e.TASK_DEF_KEY_!=t.currentTaskKey?(k(),N(s,{key:0,value:e.TASK_DEF_KEY_},{default:v(()=>[j(K(e.NAME_),1)]),_:2},1032,["value"])):I("",!0)],64))),256))]),_:1},8,["value","getPopupContainer"])])])]),_:1},8,["onRegister","title"])}const ee=V(S,[["render",O]]);export{ee as default};
