var z=Object.defineProperty;var k=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var F=(l,t,e)=>t in l?z(l,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[t]=e,M=(l,t)=>{for(var e in t||(t={}))I.call(t,e)&&F(l,e,t[e]);if(k)for(var e of k(t))K.call(t,e)&&F(l,e,t[e]);return l};var v=(l,t,e)=>new Promise((s,r)=>{var f=o=>{try{m(e.next(o))}catch(n){r(n)}},u=o=>{try{m(e.throw(o))}catch(n){r(n)}},m=o=>o.done?s(o.value):Promise.resolve(o.value).then(f,u);m((e=e.apply(l,t)).next())});import{l as L,a as N,j as E,k as O}from"./index-831af9dd.js";import{B as G}from"./index-1c3affea.js";import{cc as H}from"./antd-vue-vendor-0d72f01e.js";import{f as g,I as j,a5 as p,V as x,a6 as w,af as V,ai as h,k as B,a7 as A,F as D,am as U,ae as q,E as J,ak as P}from"./vue-vendor-24c7dc61.js";import{s as Q}from"./type.definition-4eb605ee.js";import"./vxe-table-vendor-8813019a.js";import"./BasicModal-58413bab.js";import"./useWindowSizeFn-8f085f6f.js";const W={name:"CardFieldSelectModal",components:{BasicModal:G,SlidersOutlined:H},emits:["register","select"],setup(l,{emit:t}){const e=g(""),s=g([]),r=g(""),f=g(""),u=g(""),{createMessage:m}=N(),[o,{closeModal:n}]=E(a=>v(this,null,function*(){e.value=a.code,C(a.columnList),u.value=a.id||""})),y=["radio","select","select-user","table-dict","link-record","switch"];function C(a){let _=j(a),d=_.filter(i=>i.isTitle===!0);d&&d.length>0?f.value=d[0].key:f.value=_[0].key;let c=[];for(let i of _)y.indexOf(i.type)>=0&&(i.multi===!0||i.multiple===!0||c.push(M({},i)));for(let i of Q)y.indexOf(i.type)>=0&&c.push({name:i.name,model:i.field});c.length>0?s.value=c:s.value=[]}const S={display:"flex",height:"35px",lineHeight:"35px"};function T(){return v(this,null,function*(){if(!r.value){m.warn("无分组字段，无法创建该视图！");return}u.value?b():yield R()})}function b(){let a=u.value;const _="/desform/view/updateViewConfig";let d={id:a,type:"card",groupField:r.value,titleField:f.value,filterGroupType:"all"};O.put({url:_,params:d},{isTransformResponse:!1}).then(c=>{c.success&&(t("select",a),n())})}function R(){return v(this,null,function*(){const a="/desform/view/addView";let _={type:"card",code:e.value,groupField:r.value,filterGroupType:"all",titleField:f.value},d=yield O.post({url:a,params:_},{isTransformResponse:!1});if(d.success){let c=d.result;t("select",c),n()}})}return{registerModal:o,designFormCode:e,fieldKey:r,radioStyle:S,selectOptions:s,handleOk:T}}},X={style:{display:"flex","flex-direction":"row",color:"rgb(51, 51, 51)"}},Y={style:{width:"97px",padding:"0px 24px 0px 16px"}},Z={style:{display:"inline-block",width:"100%"}},$=p("div",{style:{flex:"1",display:"flex","flex-direction":"column"}},[p("div",null,"看板视图"),p("div",{style:{"font-size":"14px","margin-top":"10px","font-weight":"normal"}}," 选择一个字段，数据将按照此字段中的字段值分组显示在看板中。支持字段：单选、下拉框、人员、表字典、关联表记录（单条） ")],-1),ee={style:{"margin-left":"10px"}},te=p("div",{style:{"margin-bottom":"12px"}},"选择分组字段",-1);function se(l,t,e,s,r,f){const u=x("sliders-outlined"),m=x("a-radio"),o=x("a-radio-group"),n=x("BasicModal");return w(),V(n,{onRegister:s.registerModal,width:600,canFullscreen:!1,destroyOnClose:"",closable:!1,onOk:s.handleOk},{title:h(()=>[p("div",X,[p("div",Y,[p("span",Z,[B(u,{style:{color:"#4caf50","font-size":"50px"}})])]),$])]),default:h(()=>[p("div",ee,[te,B(o,{value:s.fieldKey,"onUpdate:value":t[0]||(t[0]=y=>s.fieldKey=y)},{default:h(()=>[(w(!0),A(D,null,U(s.selectOptions,y=>(w(),V(m,{style:q(s.radioStyle),value:y.model},{default:h(()=>[J(P(y.name),1)]),_:2},1032,["style","value"]))),256))]),_:1},8,["value"])])]),_:1},8,["onRegister","onOk"])}const fe=L(W,[["render",se]]);export{fe as default};
