var A=(e,f,c)=>new Promise((y,m)=>{var i=n=>{try{u(c.next(n))}catch(o){m(o)}},p=n=>{try{u(c.throw(n))}catch(o){m(o)}},u=n=>n.done?y(n.value):Promise.resolve(n.value).then(i,p);u((c=c.apply(e,f)).next())});import{a7 as T,ap as x,k as V,l as H}from"./index-831af9dd.js";import{d as q,a2 as L,f as g,w as $,a3 as F,a4 as R,a5 as r,V as _,a6 as h,a7 as E,k as a,ai as s,F as z,am as D,af as C,ak as B,E as O}from"./vue-vendor-24c7dc61.js";import{u as W}from"./useAppTheme-3409245c.js";import{u as j}from"./useUndeveloped-598c4bd7.js";import"./antd-vue-vendor-0d72f01e.js";import"./vxe-table-vendor-8813019a.js";const G=q({name:"HeaderUserIcon",setup(){const e=T(),{tipUndeveloped:f}=j(),c=L(),{resetAppIndexTheme:y}=W(),m=g(""),i=g(""),p=g(!1);$(()=>e.getUserInfo,()=>{u()},{deep:!0});function u(){let l=e.getUserInfo;if(p.value=!1,l){let t=l.avatar||"";t&&(p.value=!0),m.value=x(t),i.value=e.getUserInfo.realname}}u();function n(){return i.value?i.value.length>2?i.value.substr(0,2):i.value:""}const o=g(!1);function I(l){let t=l.key;if(t=="logout")k();else if(t=="user")U();else if(t.startsWith("tenant_")){let b=t.replace("tenant_","");w(b)}o.value=!1,(t=="wechat"||t=="app"||t=="gift")&&f()}function k(){return A(this,null,function*(){yield e.logout(!0),y()})}function U(){const l="/myapps/settings/user";c.push({path:l})}function w(l){l&&e.setTenant(Number(l));const t=`/myapps/settings/organization/${l}`;c.push({path:t})}const d=g([]);function S(){return A(this,null,function*(){const l="/sys/tenant/getCurrentUserTenant",t=yield V.get({url:l});let b=[];if(t&&t.list)for(let N of t.list)b.push({value:N.id,label:N.name});d.value=b})}return S(),{realName:i,getRealNameText:n,actionVisible:o,handleActionClick:I,tenantList:d,userAvatar:m,showAvatar:p,tipUndeveloped:f}}});const v=e=>(F("data-v-4fd768e2"),e=e(),R(),e),J={style:{display:"inline-block",position:"relative","margin-bottom":"3px","font-size":"16px"}},K={style:{display:"inline-block","line-height":"36px",height:"36px"}},M=v(()=>r("span",{class:"label"},"个人账户",-1)),P=v(()=>r("span",{class:"label"},"组织管理",-1)),Q={class:"label tenant-label"},X=v(()=>r("a",{href:"http://help.qiaoqiaoyun.com",target:"_blank"},[r("span",{class:"label"},"帮助文档")],-1)),Y=v(()=>r("a",{href:"https://qiaoqiaoyun.com/learnIndex",target:"_blank"},[r("span",{class:"label"},"视频学习")],-1)),Z=v(()=>r("span",{class:"label"},"安全退出",-1));function ee(e,f,c,y,m,i){const p=_("a-avatar"),u=_("a-tooltip"),n=_("Icon"),o=_("a-menu-item"),I=_("a-sub-menu"),k=_("a-menu-divider"),U=_("a-menu"),w=_("a-dropdown");return h(),E("div",J,[a(w,{open:e.actionVisible,"onUpdate:open":f[0]||(f[0]=d=>e.actionVisible=d),trigger:["click"],overlayClassName:"app-item-actions-dropdown user-menu-dropdown"},{overlay:s(()=>[a(U,{onClick:e.handleActionClick},{default:s(()=>[a(o,{key:"user"},{default:s(()=>[r("span",K,[a(n,{icon:"ant-design:idcard-outlined"})]),M]),_:1}),a(I,{key:"sub-menu",class:"has-sub-menu",popupClassName:"low-app-use-tenant-pop-menu"},{title:s(()=>[a(n,{icon:"ant-design:partition-outlined"}),P]),default:s(()=>[(h(!0),E(z,null,D(e.tenantList,d=>(h(),C(o,{key:"tenant_"+d.value},{default:s(()=>[a(u,{title:d.label,placement:"left"},{default:s(()=>[r("span",Q,B(d.label),1)]),_:2},1032,["title"])]),_:2},1024))),128))]),_:1}),a(k),a(o,{key:"help"},{default:s(()=>[a(n,{icon:"ant-design:question-circle-filled"}),X]),_:1}),a(o,{key:"learn"},{default:s(()=>[a(n,{icon:"ant-design:play-circle-filled"}),Y]),_:1}),a(k),a(o,{key:"logout"},{default:s(()=>[a(n,{icon:"ant-design:logout-outlined"}),Z]),_:1})]),_:1},8,["onClick"])]),default:s(()=>[a(u,{title:e.realName},{default:s(()=>[e.showAvatar?(h(),C(p,{key:0,src:e.userAvatar},null,8,["src"])):(h(),C(p,{key:1},{default:s(()=>[O(B(e.getRealNameText()),1)]),_:1}))]),_:1},8,["title"])]),_:1},8,["open"])])}const ue=H(G,[["render",ee],["__scopeId","data-v-4fd768e2"]]);export{ue as default};
