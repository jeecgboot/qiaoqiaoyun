var H=(a,I,p)=>new Promise((w,b)=>{var R=m=>{try{_(p.next(m))}catch(u){b(u)}},k=m=>{try{_(p.throw(m))}catch(u){b(u)}},_=m=>m.done?w(m.value):Promise.resolve(m.value).then(R,k);_((p=p.apply(a,I)).next())});import{d as oe,f as v,u as o,h as be,e as le,a5 as U,V as r,a6 as T,a7 as A,k as e,ag as Ce,ai as t,E as d,ak as Z,W as O,r as V,w as we,at as ke,F as xe,af as Se,a8 as Ie,a3 as Re,a4 as De,I as Me}from"./vue-vendor-24c7dc61.js";import{u as Te}from"./index-621e597c.js";import{B as Ue}from"./index-1c3affea.js";import{g as te,a as $e,_ as Fe,b as Ee,c as Be,s as Le,d as Ae,e as qe}from"./DemoModal-7f7a51bd.js";import{j as je,d as Ke,q as Ve,a as Oe,k as Je,l as se,bZ as ze,e as ae,L as Ne}from"./index-831af9dd.js";import{J as ne}from"./JDictSelectTag-54dc3bdb.js";import{u as Pe}from"./useMethods-f689b480.js";import{T as Ye}from"./componentMap-c857637c.js";import Qe from"./BasicTable-d435f501.js";import"./antd-vue-vendor-0d72f01e.js";import"./BasicModal-58413bab.js";import"./useWindowSizeFn-8f085f6f.js";import"./index-52c8c841.js";import"./useForm-14b2bc77.js";import"./helper-22dafba0.js";import"./JAreaLinkage-173780c9.js";import"./areaDataUtil-cdeee717.js";import"./china-area-data-vendor-556d14ee.js";import"./useFormItem-86503382.js";import"./vxe-table-vendor-8813019a.js";import"./JSelectUser-a44af43a.js";import"./useSelectBiz-2f560b0b.js";import"./props-8a7ac45b.js";import"./JSelectBiz-55a9591f.js";import"./JSelectDept-a90caee3.js";import"./index-f2fd5a28.js";import"./useContextMenu-810f9346.js";import"./JCodeEditor-66bd225e.js";import"./codemirror-17b6f671.js";import"./codemirror-26b29690.js";import"./active-line-512fef49.js";import"./JPopup-2a779923.js";import"./EasyCronInput-b2123242.js";import"./JCheckbox-0b89d32a.js";import"./JSelectUserByDept-bd619076.js";import"./UserSelectByDepModal-db060ece.js";import"./depart.api-339f4da6.js";import"./JEditor-249b2194.js";import"./index-b845562c.js";import"./JImageUpload-d644253a.js";import"./renderUtils-7ad8f436.js";import"./download-1ac6acce.js";import"./index-f99b266a.js";import"./JUpload-76e119c7.js";import"./index-d508f1f4.js";import"./index-6507b9cd.js";import"./index-4d0525a5.js";import"./UserSelectModal-d78c1490.js";const We=oe({name:"JImportModal",components:{BasicModal:Ue},props:{url:{type:String,default:"",required:!1},biz:{type:String,default:"",required:!1},online:{type:Boolean,default:!1,required:!1}},emits:["ok","register"],setup(a,{emit:I,refs:p}){const{createMessage:w,createWarningModal:b}=Oe(),[R,{closeModal:k}]=je(i=>{$(i)}),_=Ke(),m=Ve(),u=v(!1),f=v([]),D=v(""),M=v(""),h=v(0),q=Object.assign({},o(a),o(m));be(()=>{a.url&&(D.value=`${_.uploadUrl}${a.url}`)});const J=le(()=>!(o(f).length>0));function j(){k(),$()}function z(i){h.value=i?1:0}function N(i){const x=o(f).indexOf(i),g=o(f).slice();g.splice(x,1),f.value=g}function P(i){return f.value=[...o(f),i],!1}function Y(){let{biz:i,online:x}=a;const g=new FormData;i&&g.append("isSingleTableImport",i),o(M)&&o(M).length>0&&g.append("foreignKeys",o(M)),x&&g.append("validateStatus",o(h)),o(f).forEach(C=>{g.append("files[]",C)}),u.value=!0;let W={"Content-Type":"multipart/form-data;boundary = "+new Date().getTime()};Je.post({url:a.url,params:g,headers:W},{isTransformResponse:!1}).then(C=>{u.value=!1,C.success?(C.code==201?Q(C.message,C.result):w.success(C.message),j(),$(),I("ok")):w.warning(C.message)}).catch(()=>{u.value=!1})}function Q(i,x){let g=_.uploadUrl+x;b({title:"导入成功,但是有错误数据!",centered:!1,content:`<div>
                        <span>${i}</span><br/>
                        <span>具体详情请<a href = ${g} target="_blank"> 点击下载 </a> </span>
                      </div>`})}function $(i){f.value=[],u.value=!1,M.value=i,h.value=0}return{register:R,getBindValue:q,uploadDisabled:J,fileList:f,uploading:u,validateStatus:h,handleClose:j,handleChangeValidateStatus:z,handleRemove:N,beforeUpload:P,handleImport:Y}}}),Xe={key:0,style:{margin:"0 5px 5px"}},Ge=U("span",{style:{display:"inline-block",height:"32px","line-height":"32px","vertical-align":"middle"}},"是否开启校验:",-1),He={style:{"margin-left":"6px"}};function Ze(a,I,p,w,b,R){const k=r("a-switch"),_=r("a-button"),m=r("a-upload"),u=r("BasicModal");return T(),A("div",null,[e(u,Ce(a.$attrs,{onRegister:a.register,title:"导入EXCEL",width:600,onCancel:a.handleClose,confirmLoading:a.uploading,destroyOnClose:""}),{footer:t(()=>[e(_,{onClick:a.handleClose},{default:t(()=>[d("关闭")]),_:1},8,["onClick"]),e(_,{type:"primary",onClick:a.handleImport,disabled:a.uploadDisabled,loading:a.uploading},{default:t(()=>[d(Z(a.uploading?"上传中...":"开始上传"),1)]),_:1},8,["onClick","disabled","loading"])]),default:t(()=>[a.online?(T(),A("div",Xe,[Ge,U("span",He,[e(k,{checked:a.validateStatus==1,onChange:a.handleChangeValidateStatus,"checked-children":"是","un-checked-children":"否"},null,8,["checked","onChange"])])])):O("",!0),e(m,{name:"file",accept:".xls,.xlsx",multiple:!0,fileList:a.fileList,onRemove:a.handleRemove,beforeUpload:a.beforeUpload},{default:t(()=>[e(_,{preIcon:"ant-design:upload-outlined"},{default:t(()=>[d("选择导入文件")]),_:1})]),_:1},8,["fileList","onRemove","beforeUpload"])]),_:1},16,["onRegister","onCancel","confirmLoading"])])}const et=se(We,[["render",Ze]]),ie=a=>(Re("data-v-a8c1b57f"),a=a(),De(),a),tt=["onKeyup"],at=ie(()=>U("span",null,"~",-1)),nt={style:{float:"left",overflow:"hidden"},class:"table-page-search-submitButtons"},ot=ie(()=>U("span",null,"~",-1)),lt=oe({__name:"index",setup(a){const I=ze(),p=v([]),[w,{openModal:b}]=ae(),[R,{openModal:k}]=ae(),{handleExportXls:_,handleImportXls:m}=Pe(),u=v(),f=v(),D=v(!1),[M,{reload:h,setProps:q}]=Te({title:"单表示例",api:Ee,columns:Be,formConfig:{schemas:Le,fieldMapToTime:[["birthday",["birthday_begin","birthday_end"],"YYYY-MM-DD"]],fieldMapToNumber:[["age",["age_begin","age_end"]]],autoAdvancedCol:2,actionColOptions:{style:{textAlign:"left"}}},defSort:{column:"createTime,sex",order:"desc"},striped:!0,useSearchForm:!0,showTableSetting:!0,clickToRowSelect:!1,bordered:!0,showIndexColumn:!1,tableSetting:{fullScreen:!0},canResize:!1,rowKey:"id",actionColumn:{width:180,title:"操作",dataIndex:"action",slots:{customRender:"action"},fixed:void 0}}),J={type:"checkbox",columnWidth:40,selectedRowKeys:p,onChange:P};function j(){k(!0)}const z=le(()=>{let l={};return p.value&&p.value.length>0&&(l.selections=p.value.join(",")),Ne(l)});function N(l){return[{label:"编辑",onClick:Q.bind(null,l)},{label:"详情",onClick:$.bind(null,l)},{label:"删除",popConfirm:{title:"是否确认删除",confirm:i.bind(null,l)}}]}function P(l){p.value=l}function Y(){D.value=!1,b(!0,{isUpdate:!1})}function Q(l){D.value=!1,b(!0,{record:l,isUpdate:!0})}function $(l){D.value=!0,b(!0,{record:l,isUpdate:!0})}function i(l){return H(this,null,function*(){yield Ae({id:l.id},h)})}function x(){return H(this,null,function*(){yield qe({ids:p.value},h)})}function g(l,n){l[n]=[o(u),o(f)]}function W(){I("/comp/jeecg/basic")}const C=v(),re=V({xs:{span:24},sm:{span:7}}),ue=V({xs:{span:24},sm:{span:16}}),F=v(!1),S=v(!1),c=V({name:"",age_begin:"",age_end:"",sex:"",id:""});we(S,()=>{q({useSearchForm:!o(S)})});function X(){q({searchInfo:Me(c)}),h()}function de(){Object.assign(c,{name:"",age_begin:"",age_end:"",sex:"",id:""}),h()}const pe=V({name:{title:"名称",view:"text",type:"string",order:1},sex:{title:"性别",view:"list",type:"string",dictCode:"sex",order:2}});function ce(l){Object.keys(l).map(n=>{c[n]=l[n]}),X()}return(l,n)=>{const E=r("a-input"),K=r("a-form-item"),B=r("a-col"),y=r("a-button"),G=r("Icon"),me=r("a-row"),fe=r("a-form"),ge=r("a-upload"),_e=r("super-query"),ve=r("a-menu-item"),he=r("a-menu"),ye=r("a-dropdown");return T(),A("div",null,[S.value?(T(),A("div",{key:0,class:"jeecg-basic-table-form-container",onKeyup:ke(X,["enter"])},[e(fe,{ref:"formRef",model:c,"label-col":re,"wrapper-col":ue},{default:t(()=>[e(me,{gutter:24},{default:t(()=>[e(B,{lg:8},{default:t(()=>[e(K,{label:"用户名"},{default:t(()=>[e(E,{placeholder:"请输入名称模糊查询",value:c.name,"onUpdate:value":n[0]||(n[0]=s=>c.name=s)},null,8,["value"])]),_:1})]),_:1}),e(B,{lg:8},{default:t(()=>[e(K,{label:"年龄"},{default:t(()=>[e(E,{placeholder:"最小年龄",type:"ge",value:c.age_begin,"onUpdate:value":n[1]||(n[1]=s=>c.age_begin=s),style:{width:"calc(50% - 15px)"}},null,8,["value"]),at,e(E,{placeholder:"最大年龄",type:"le",value:c.age_end,"onUpdate:value":n[2]||(n[2]=s=>c.age_end=s),style:{width:"calc(50% - 15px)"}},null,8,["value"])]),_:1})]),_:1}),F.value?(T(),A(xe,{key:0},[e(B,{lg:8},{default:t(()=>[e(K,{label:"性别"},{default:t(()=>[e(ne,{value:c.sex,"onUpdate:value":n[3]||(n[3]=s=>c.sex=s),placeholder:"请选择性别",dictCode:"sex"},null,8,["value"])]),_:1})]),_:1}),e(B,{lg:8},{default:t(()=>[e(K,{label:"选择用户"},{default:t(()=>[e(ne,{value:c.id,"onUpdate:value":n[4]||(n[4]=s=>c.id=s),placeholder:"请选择用户",dictCode:"demo,name,id"},null,8,["value"])]),_:1})]),_:1})],64)):O("",!0),U("span",nt,[e(B,{lg:6},{default:t(()=>[e(y,{type:"primary",preIcon:"ant-design:search-outlined",onClick:X},{default:t(()=>[d("查询")]),_:1}),e(y,{type:"primary",preIcon:"ant-design:reload-outlined",onClick:de,style:{"margin-left":"8px"}},{default:t(()=>[d("重置")]),_:1}),U("a",{onClick:n[5]||(n[5]=s=>F.value=!F.value),style:{"margin-left":"8px"}},[d(Z(F.value?"收起":"展开")+" ",1),e(G,{icon:F.value?"ant-design:up-outlined":"ant-design:down-outlined"},null,8,["icon"])])]),_:1})])]),_:1})]),_:1},8,["model","label-col","wrapper-col"])],40,tt)):O("",!0),e(o(Qe),{onRegister:o(M),rowSelection:J,class:Ie({"p-4":S.value})},{"form-age":t(({model:s,field:ee})=>[e(E,{placeholder:"最小年龄",type:"ge",value:u.value,"onUpdate:value":n[6]||(n[6]=L=>u.value=L),style:{width:"calc(50% - 15px)"},onChange:L=>g(s,ee)},null,8,["value","onChange"]),ot,e(E,{placeholder:"最大年龄",type:"le",value:f.value,"onUpdate:value":n[7]||(n[7]=L=>f.value=L),style:{width:"calc(50% - 15px)"},onChange:L=>g(s,ee)},null,8,["value","onChange"])]),tableTitle:t(()=>[e(y,{preIcon:"ant-design:plus-outlined",type:"primary",onClick:Y},{default:t(()=>[d("新增")]),_:1}),e(ge,{name:"file",showUploadList:!1,customRequest:s=>o(m)(s,o(te),o(h))},{default:t(()=>[e(y,{preIcon:"ant-design:import-outlined",type:"primary"},{default:t(()=>[d("导入")]),_:1})]),_:1},8,["customRequest"]),e(y,{preIcon:"ant-design:export-outlined",type:"primary",onClick:n[8]||(n[8]=s=>o(_)("单表示例",o($e),z.value))},{default:t(()=>[d("导出")]),_:1}),e(y,{preIcon:"ant-design:filter",type:"primary",onClick:n[9]||(n[9]=()=>{})},{default:t(()=>[d("高级查询")]),_:1}),e(y,{preIcon:"ant-design:plus-outlined",type:"primary",onClick:W},{default:t(()=>[d("打开Tab页")]),_:1}),e(y,{preIcon:"ant-design:retweet-outlined",type:"primary",onClick:n[10]||(n[10]=s=>S.value=!S.value)},{default:t(()=>[d(Z(S.value?"表单配置查询":"自定义查询"),1)]),_:1}),e(y,{preIcon:"ant-design:import-outlined",type:"primary",onClick:j},{default:t(()=>[d("弹窗导入")]),_:1}),e(_e,{config:pe,onSearch:ce},null,8,["config"]),p.value.length>0?(T(),Se(ye,{key:0},{overlay:t(()=>[e(he,null,{default:t(()=>[e(ve,{key:"1",onClick:x},{default:t(()=>[e(G,{icon:"ant-design:delete-outlined"}),d(" 删除 ")]),_:1})]),_:1})]),default:t(()=>[e(y,null,{default:t(()=>[d("批量操作 "),e(G,{style:{fontsize:"12px"},icon:"ant-design:down-outlined"})]),_:1})]),_:1})):O("",!0)]),action:t(({record:s})=>[e(o(Ye),{actions:N(s)},null,8,["actions"])]),_:1},8,["onRegister","class"]),e(Fe,{onRegister:o(w),onSuccess:o(h),isDisabled:D.value},null,8,["onRegister","onSuccess","isDisabled"]),e(et,{onRegister:o(R),url:o(te),online:""},null,8,["onRegister","url"])])}}});const ta=se(lt,[["__scopeId","data-v-a8c1b57f"]]);export{ta as default};
