var f=(e,u,l)=>new Promise((g,r)=>{var h=i=>{try{p(l.next(i))}catch(c){r(c)}},_=i=>{try{p(l.throw(i))}catch(c){r(c)}},p=i=>i.done?g(i.value):Promise.resolve(i.value).then(h,_);p((l=l.apply(e,u)).next())});import{d as D,f as A,c as x,r as T,w as S,l as v,a3 as M,a4 as $,a5 as t,V as m,a6 as q,a7 as j,F as z,k as n,ai as d,E as y,ak as L}from"./vue-vendor-24c7dc61.js";import{g as U,s as V}from"./OrganAppThird.api-f164f206.js";import"./index-1c3affea.js";import K from"./ThirdAppConfigModal-6a290156.js";import{M as I}from"./antd-vue-vendor-0d72f01e.js";import{e as N,a as O,l as H}from"./index-831af9dd.js";import"./BasicModal-58413bab.js";import"./useWindowSizeFn-8f085f6f.js";import"./index-52c8c841.js";import"./useForm-14b2bc77.js";import"./componentMap-c857637c.js";import"./useFormItem-86503382.js";import"./download-1ac6acce.js";import"./index-f99b266a.js";import"./JSelectUser-a44af43a.js";import"./useSelectBiz-2f560b0b.js";import"./props-8a7ac45b.js";import"./JSelectBiz-55a9591f.js";import"./JImageUpload-d644253a.js";import"./JDictSelectTag-54dc3bdb.js";import"./JSelectDept-a90caee3.js";import"./index-f2fd5a28.js";import"./useContextMenu-810f9346.js";import"./areaDataUtil-cdeee717.js";import"./china-area-data-vendor-556d14ee.js";import"./JPopup-2a779923.js";import"./useMethods-f689b480.js";import"./JCheckbox-0b89d32a.js";import"./vxe-table-vendor-8813019a.js";import"./JSelectUserByDept-bd619076.js";import"./UserSelectByDepModal-db060ece.js";import"./depart.api-339f4da6.js";import"./JUpload-76e119c7.js";import"./index-d508f1f4.js";import"./index-6507b9cd.js";import"./index-4d0525a5.js";import"./UserSelectModal-d78c1490.js";import"./helper-22dafba0.js";import"./JAreaLinkage-173780c9.js";import"./JCodeEditor-66bd225e.js";import"./codemirror-17b6f671.js";import"./codemirror-26b29690.js";import"./active-line-512fef49.js";import"./EasyCronInput-b2123242.js";import"./JEditor-249b2194.js";import"./index-b845562c.js";import"./organization.data-23f4609c.js";import"./renderUtils-7ad8f436.js";const R=D({name:"OrganDingConfigForm",components:{ThirdAppConfigModal:K},setup(){const{createMessage:e}=O(),u=A(""),l=A(!1),g=A({agentId:void 0,clientId:"",clientSecret:""}),r=x("myTenantInfo",T({})),[h,{openModal:_}]=N();function p(){return f(this,null,function*(){_(!0,{tenantId:r.id,thirdType:"dingtalk"})})}function i(o){return f(this,null,function*(){let a=yield U(o);a&&(g.value=a)})}S(r,o=>f(this,null,function*(){o&&o.id&&(g.value={agentId:void 0,clientId:"",clientSecret:""},yield i({tenantId:o.id,thirdType:"dingtalk"}))}),{immediate:!0,deep:!0});function c(){i({tenantId:r.id,thirdType:"dingtalk"})}function E(){return f(this,null,function*(){l.value=!0,yield V().then(o=>{let a={};o.result&&(a={width:600,title:o.message,content:()=>{let b,w=["成功信息如下：",C(v,o.result.successInfo.map((B,k)=>`${k+1}. ${B}`).join(`
`))];return o.success?b=[...w,v("br"),"无失败信息！"]:b=["失败信息如下：",C(v,o.result.failInfo.map((B,k)=>`${k+1}. ${B}`).join(`
`)),v("br"),...w],b}}),o.success?a!=null?I.success(a):e.warning(o.message):a&&a.title?I.warning(a):e.warning({content:"同步失败，请检查对接信息录入中是否填写正确，并确认是否已开启钉钉配置！",duration:5})}).finally(()=>{l.value=!1})})}function C(o,a){return o("div",{id:"box",style:{minHeight:"100px",border:"1px solid #d9d9d9",fontSize:"14px",maxHeight:"250px",whiteSpace:"pre",overflow:"auto",padding:"10px"}},a)}function F(){window.open("https://help.qiaoqiaoyun.com/expand/dingdingsyn.html","_target")}return{appConfigData:g,collapseActiveKey:u,registerAppConfigModal:h,dingEditClick:p,handleSuccess:c,syncDingTalk:E,btnLoading:l,handleIconClick:F}}});const s=e=>(M("data-v-b87bc4a3"),e=e(),$(),e),G={class:"base-collapse"},J=s(()=>t("div",{class:"header"}," 钉钉集成 ",-1)),P=s(()=>t("div",{style:{"font-size":"16px"}}," 1.获取对接信息",-1)),Q=s(()=>t("div",{class:"base-desc"},"从钉钉开放平台获取对接信息，即可开始集成以及同步通讯录",-1)),W=s(()=>t("div",{style:{"margin-top":"5px"}},[t("a",{href:"https://help.qiaoqiaoyun.com/expand/dingding.html",target:"_blank"},"如何获取对接信息?")],-1)),X=s(()=>t("div",{style:{width:"100%","justify-content":"space-between",display:"flex"}},[t("div",{style:{"font-size":"16px"}}," 2.对接信息录入")],-1)),Y=s(()=>t("div",{class:"base-desc"},"完成步骤1后，填入Agentld、 AppKey、AppSecret后 可对接应用与同步通讯录",-1)),Z={class:"flex-flow"},tt=s(()=>t("div",{class:"base-title"},"Agentld",-1)),et={class:"base-message"},ot={class:"flex-flow"},it=s(()=>t("div",{class:"base-title"},"AppKey",-1)),nt={class:"base-message"},at={class:"flex-flow"},st=s(()=>t("div",{class:"base-title"},"AppSecret",-1)),ut={class:"base-message"},lt={style:{"margin-top":"20px",width:"100%","text-align":"right"}},dt={class:"sync-padding"},pt=s(()=>t("div",{style:{"font-size":"16px",width:"100%"}}," 3.数据同步",-1)),ct={style:{"margin-top":"20px"},class:"base-desc"},rt={style:{"list-style-type":"disc","margin-left":"20px"}},mt=s(()=>t("li",null,"同步部门到本地",-1)),gt={style:{float:"right","padding-bottom":"20px"}};function _t(e,u,l,g,r,h){const _=m("a-collapse-panel"),p=m("a-collapse"),i=m("a-input-password"),c=m("a-button"),E=m("a-icon"),C=m("a-tooltip"),F=m("ThirdAppConfigModal");return q(),j(z,null,[t("div",G,[J,n(p,{"expand-icon-position":"right",bordered:!1},{default:d(()=>[n(_,{key:"1"},{header:d(()=>[P]),default:d(()=>[Q,W]),_:1})]),_:1}),t("div",null,[n(p,{"expand-icon-position":"right",bordered:!1},{default:d(()=>[n(_,{key:"2"},{header:d(()=>[X]),default:d(()=>[Y,t("div",Z,[tt,t("div",et,[n(i,{value:e.appConfigData.agentId,"onUpdate:value":u[0]||(u[0]=o=>e.appConfigData.agentId=o),readonly:""},null,8,["value"])])]),t("div",ot,[it,t("div",nt,[n(i,{value:e.appConfigData.clientId,"onUpdate:value":u[1]||(u[1]=o=>e.appConfigData.clientId=o),readonly:""},null,8,["value"])])]),t("div",at,[st,t("div",ut,[n(i,{value:e.appConfigData.clientSecret,"onUpdate:value":u[2]||(u[2]=o=>e.appConfigData.clientSecret=o),readonly:""},null,8,["value"])])]),t("div",lt,[n(c,{onClick:e.dingEditClick},{default:d(()=>[y("编辑")]),_:1},8,["onClick"])])]),_:1})]),_:1}),t("div",dt,[pt,t("div",ct,[y(" 从钉钉同步到敲敲云 "),t("ul",rt,[mt,t("li",null,[y(" 同步部门下的用户到本地 "),n(C,{title:"同步用户与部门文档"},{default:d(()=>[n(E,{onClick:e.handleIconClick,type:"question-circle",class:"sync-text"},null,8,["onClick"])]),_:1})])]),t("div",gt,[n(c,{loading:e.btnLoading,onClick:e.syncDingTalk},{default:d(()=>[y(L(e.btnLoading?"同步中":"同步"),1)]),_:1},8,["loading","onClick"])])])])])]),n(F,{onRegister:e.registerAppConfigModal,onSuccess:e.handleSuccess},null,8,["onRegister","onSuccess"])],64)}const ce=H(R,[["render",_t],["__scopeId","data-v-b87bc4a3"]]);export{ce as default};
