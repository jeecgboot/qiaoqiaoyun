import{bJ as V,aC as W,a$ as I,p as z}from"./antd-vue-vendor-0d72f01e.js";import{d as J,f as S,e as M,w as q,I as R,a5 as u,V as g,a6 as i,a7 as p,ae as k,F as O,am as x,k as d,ai as f,z as L,ak as A,af as j,W as N,E as G}from"./vue-vendor-24c7dc61.js";import{s as H}from"./type.definition-4eb605ee.js";import{l as K}from"./index-831af9dd.js";import"./vxe-table-vendor-8813019a.js";const Q=J({name:"CalendarFieldSelect",components:{CalendarOutlined:V,PlusOutlined:W,DeleteOutlined:I},props:{columnList:{type:Array,default:()=>[]},selectedList:{type:Array,default:()=>[]},inner:{type:Boolean,default:!1}},emits:["change"],setup(n,{emit:c}){const D=S([{}]),$=M(()=>n.inner===!0?140:220);function T(e){let t=R(e),s=[],w=t.filter(o=>o.type=="date"||o.type=="datetime");for(let o of w)s.push({value:o.model,label:o.name,type:o.type});let E=H.filter(o=>o.type=="date"||o.type=="datetime");for(let o of E)s.push({value:o.field,label:o.name,type:o.type});s.push({value:""}),D.value=s}const r=S();function m(e){return e.endDateField?1:0}function B(e,t){e.target.value||(t.showTag=!1),l()}function v(){alert("暂不支持")}function h(e){let t=r.value;t==null||t.splice(e,1),r.value=t,l()}const y=S(!1);function C(e){let t=r.value;t==null||t.push({beginDateField:e.value,endDateField:"",tag:"",showTag:!1,seq:b(t),type:e.type}),r.value=t,y.value=!1,l()}q(()=>n.columnList,e=>{T(e)},{immediate:!0,deep:!0}),q(()=>n.selectedList,e=>{if(e&&e.length>0){let t=[];for(let s of e){let{beginDateField:w,endDateField:E,tag:o,seq:U,type:P}=s;t.push({beginDateField:w,endDateField:E,tag:o,showTag:!1,seq:U,type:P})}r.value=t}else r.value=[{beginDateField:"",endDateField:"",tag:"",showTag:!1,seq:0,type:""}]},{immediate:!0,deep:!0});function _(){let e=r.value,t=[];for(let s of e)t.push(z(s,"beginDateField","endDateField","tag","seq","type"));return t}function b(e){let t=0;if(e&&e.length>0)for(let s of e)s.seq>t&&(t=s.seq);return++t}function a(e,t,s){e.beginDateField=t,e.type=s,l()}function F(e,t){e.endDateField=t,l()}function l(){let e=_();c("change",e)}return{selectOptions:D,calendarSelectFieldList:r,getFieldStatus:m,handleClickAdd:v,onTagInputBlur:B,onDelete:h,showPop:y,onSelectField:C,getData:_,selectWidth:$,onChange:l,onBeginDateChange:a,onEndDateChange:F}}});const X={style:{width:"100%"}},Y={style:{display:"flex","margin-bottom":"20px"}},Z={style:{display:"flex","flex-direction":"column","margin-left":"10px"}},ee=u("span",{style:{"margin-left":"10px"}},"添加日期字段",-1),te=["onClick"],ne=u("span",{style:{"margin-left":"10px"}},"添加日期字段",-1),le=["onClick"],ae={class:"tag-button"},oe={key:0},se=u("span",{style:{"margin-left":"5px"}},"标签",-1),ie={key:2,class:"delete-icon"},de={class:"field-list"},ue=["onClick"],pe=u("span",{style:{"margin-left":"8px"}},"添加一组日期字段",-1);function re(n,c,D,$,T,r){const m=g("a-step"),B=g("a-steps"),v=g("PlusOutlined"),h=g("a-select"),y=g("a-input"),C=g("a-button"),_=g("DeleteOutlined"),b=g("a-popover");return i(),p("div",X,[u("div",{class:"calendar-field-list",style:k({marginLeft:n.inner?"2px":"36px"})},[(i(!0),p(O,null,x(n.calendarSelectFieldList,(a,F)=>(i(),p("div",Y,[u("div",null,[d(B,{"progress-dot":"",current:n.getFieldStatus(a),direction:"vertical"},{default:f(()=>[d(m,{title:"开始",description:""}),d(m,{title:"结束",description:""})]),_:2},1032,["current"])]),u("div",Z,[d(h,{"option-label-prop":"label",value:a.beginDateField,"onUpdate:value":l=>a.beginDateField=l,options:n.selectOptions,allowClear:"",placeholder:"请选择",style:k({width:n.selectWidth+"px",margin:"0 0 10px 0"}),popupClassName:"calendar-field-select",onChange:n.onChange},{option:f(l=>[l.value?(i(),p("div",{key:1,style:{padding:"5px 12px"},onClick:L(e=>n.onBeginDateChange(a,l.value,l.type),["prevent"])},[u("span",null,A(l.label),1)],8,te)):(i(),p("div",{key:0,class:"opt-add",onClick:c[0]||(c[0]=(...e)=>n.handleClickAdd&&n.handleClickAdd(...e))},[d(v),ee]))]),_:2},1032,["value","onUpdate:value","options","style","onChange"]),d(h,{value:a.endDateField,"onUpdate:value":l=>a.endDateField=l,options:n.selectOptions,allowClear:"",placeholder:"请选择",style:k({width:n.selectWidth+"px",margin:"10px 0"}),popupClassName:"calendar-field-select",onChange:n.onChange},{option:f(l=>[l.value?(i(),p("div",{key:1,style:{padding:"5px 12px"},onClick:L(e=>n.onEndDateChange(a,l.value),["prevent"])},[u("span",null,A(l.label),1)],8,le)):(i(),p("div",{key:0,class:"opt-add",onClick:c[1]||(c[1]=(...e)=>n.handleClickAdd&&n.handleClickAdd(...e))},[d(v),ne]))]),_:2},1032,["value","onUpdate:value","options","style","onChange"])]),u("div",ae,[a.tag||a.showTag==!0?(i(),p("div",oe,[d(y,{value:a.tag,"onUpdate:value":l=>a.tag=l,style:{width:"90px"},onBlur:l=>n.onTagInputBlur(l,a)},null,8,["value","onUpdate:value","onBlur"])])):(i(),j(C,{key:1,type:"text",onClick:l=>a.showTag=!0},{default:f(()=>[d(v),se]),_:2},1032,["onClick"])),n.calendarSelectFieldList.length>1?(i(),p("span",ie,[d(_,{title:"删除",onClick:L(l=>n.onDelete(F),["prevent"])},null,8,["onClick"])])):N("",!0)])]))),256))],4),u("div",{class:"bottom-button",style:k({marginLeft:n.inner?"-12px":"16px"})},[d(b,{overlayClassName:"view-pop-field-select calendar-field-select",open:n.showPop,"onUpdate:open":c[2]||(c[2]=a=>n.showPop=a),trigger:"click"},{content:f(()=>[u("div",de,[(i(!0),p(O,null,x(n.selectOptions,a=>(i(),p(O,null,[a.value?(i(),p("div",{key:0,class:"field-item",onClick:F=>n.onSelectField(a)},[u("div",null,A(a.label),1)],8,ue)):N("",!0)],64))),256))])]),title:f(()=>[]),default:f(()=>[d(C,{type:"text"},{default:f(()=>[d(v),G(),pe]),_:1})]),_:1},8,["open"])],4)])}const he=K(Q,[["render",re]]);export{he as default};
