import{B as D}from"./index-1c3affea.js";import{f as g,e as P,u as j,o as R,j as V,V as A,a6 as E,af as O,ag as G,ai as N,k as q,a5 as z}from"./vue-vendor-24c7dc61.js";import{l as J,j as K,b as Q,c as W}from"./index-831af9dd.js";import{a as X}from"./lowAppStore-499fb8f9.js";import"./BasicModal-58413bab.js";import"./antd-vue-vendor-0d72f01e.js";import"./useWindowSizeFn-8f085f6f.js";import"./vxe-table-vendor-8813019a.js";import"./index-a964241b.js";import"./low.app.api-97fc250a.js";const Y={name:"MiniDesFlowModal",components:{BasicModal:D},emits:["success","register"],props:{isLowApp:{type:Boolean,default:!0}},setup(r,{emit:i}){const u={padding:"0",height:window.innerHeight+"px"},o=g(!1),a=g(!1),t=g(""),c=window.innerHeight+"px",p=X(),l=P(()=>p.appId);let w="";l&&(w=j(l));const[B,{closeModal:k}]=K(e=>{o.value=!0,x(e,w)});function S(){o.value=!1}function x(e,n){a.value=!1;let y=Q(),d=e.id,H=e.dataId||"",U=e.flowCode||"",I=e.startType||"",v=e.processId||"",L=e.customProcessId||"",M=e.processName||"",h=e.formName||"",f=e.formCode||"",T=e.preview||"false",b="index";T=="true"&&(b="preview",a.value=!0);const F=window._CONFIG.domianURL+"/act/designer/miniDesFlow/"+b;let m="";n&&(m="&lowAppId="+n);let s="";I&&(s="&startType="+I),v&&(s+="&processId="+v),L&&(s+="&customProcessId="+L),M&&(s+="&processName="+M),h&&(s+="&formName="+h),f&&(s+="&formCode="+f),f&&(s+="&titleField="+e.titleField||""),e.toHistory&&(s+="&toHistory="+e.toHistory);let C="&tenantId="+W();d!=null&&d!=null&&d!=""?t.value=F+"?id="+d+"&isLowApp="+r.isLowApp+"&token="+y+s+C+m:t.value=F+"?token="+y+"&isLowApp="+r.isLowApp+"&dataId="+H+"&flowCode="+U+C+s+m}R(()=>{window.addEventListener("message",_)}),V(()=>{window.removeEventListener("message",_)});function _(e){const n=e.data;n.cmd=="close"&&(t.value="",k(),i("success",n))}return{registerModal:B,bodyStyle:u,closable:a,spinningLoading:o,iframeSrc:t,iframeHeight:c,iframeLoaded:S}}},Z=["src","height"];function $(r,i,u,o,a,t){const c=A("a-spin"),p=A("BasicModal");return E(),O(p,G(r.$attrs,{onRegister:o.registerModal,wrapClassName:"jee-process-modal no-bottom-scroll",width:"100%",style:{top:"0",padding:"0"},bodyStyle:o.bodyStyle,footer:null,canFullscreen:!1,closable:o.closable,keyboard:"",defaultFullscreen:"",destroyOnClose:""}),{default:N(()=>[q(c,{spinning:o.spinningLoading},{default:N(()=>[z("iframe",{id:"processDesign",src:o.iframeSrc,height:o.iframeHeight,onLoad:i[0]||(i[0]=(...l)=>o.iframeLoaded&&o.iframeLoaded(...l)),frameborder:"0",width:"100%",scrolling:"no"}," ",40,Z)]),_:1},8,["spinning"])]),_:1},16,["onRegister","bodyStyle","closable"])}const ce=J(Y,[["render",$]]);export{ce as default};
