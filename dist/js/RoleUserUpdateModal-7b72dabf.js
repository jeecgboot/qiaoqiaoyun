var B=Object.defineProperty,b=Object.defineProperties;var A=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var C=(e,t,o)=>t in e?B(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,E=(e,t)=>{for(var o in t||(t={}))O.call(t,o)&&C(e,o,t[o]);if(L)for(var o of L(t))V.call(t,o)&&C(e,o,t[o]);return e},M=(e,t)=>b(e,A(t));var k=(e,t,o)=>new Promise((p,c)=>{var i=s=>{try{a(o.next(s))}catch(u){c(u)}},r=s=>{try{a(o.throw(s))}catch(u){c(u)}},a=s=>s.done?p(s.value):Promise.resolve(s.value).then(i,r);a((o=o.apply(e,t)).next())});import{d as N,f as m,h as S,I as F,a5 as y,V as g,a6 as f,af as $,ai as h,k as v,E as U,ak as x,a7 as I,W as D}from"./vue-vendor-24c7dc61.js";import{B as z}from"./index-1c3affea.js";import{j as T,a as j,l as H}from"./index-831af9dd.js";import{i as P}from"./application.api-4e2bde90.js";import W from"./UserNameCell-fcd4cd60.js";import"./BasicModal-58413bab.js";import"./antd-vue-vendor-0d72f01e.js";import"./useWindowSizeFn-8f085f6f.js";import"./vxe-table-vendor-8813019a.js";const q=N({name:"RoleUserUpdateModal",components:{BasicModal:z,UserNameCell:W},props:{title:{type:String,default:""},roleList:{type:Array,default:()=>[]},typeOptions:{type:Array,default:()=>[]}},emits:["success","register"],setup(e,{emit:t}){const{createMessage:o}=j(),p=m(0),c=m(""),i=m([]),r=m(""),a={appId:"",authRoleId:"",relationUserList:[]},s=m([]),[u,{closeModal:_}]=T(l=>k(this,null,function*(){let d=l.rows;if(d&&d.length>0){p.value=d.length,c.value=d[0];let R=d.map(n=>({id:n.relationId,type:n.type}));a.relationUserList=R}else o.error("请选择用户!"),p.value=0;i.value=[],a.authRoleId=l.authRoleId||"",a.appId=l.appId||"",r.value=l.authRoleId||""}));function w(){return k(this,null,function*(){if(i.value.length==0){o.info("请选择角色!");return}let l=M(E({},a),{authRoleIdList:F(i.value)});yield P(l),t("success"),_()})}return S(()=>{let l=e.roleList,d=r.value;if(l&&l.length>0){let R=l.filter(n=>n.code!="admin"&&n.id!=d).map(n=>({value:n.id,label:n.name}));s.value=R}}),{registerModal:u,closeModal:_,authRoleIdList:i,onSubmit:w,authRoleOptions:s,roleUserInfo:c,selectedLines:p,selectedAuthRoleId:r}}}),G={style:{padding:"0"}},J={key:0,style:{color:"#757575","font-size":"13px",margin:"0"}},K={key:0},Q={key:1},X={key:1},Y={class:"inputVerify",style:{margin:"10px 0 20px 0"}},Z=y("div",{style:{color:"rgba(0, 0, 0, 0.85)","font-size":"15px",height:"32px","line-height":"32px","margin-bottom":"5px","font-weight":"700"}}," 选择角色 ",-1),ee={style:{"font-size":"17px","font-weight":"700"}};function te(e,t,o,p,c,i){const r=g("user-name-cell"),a=g("a-select"),s=g("a-button"),u=g("BasicModal");return f(),$(u,{minHeight:120,bodyStyle:{height:"160px"},onRegister:e.registerModal,width:"580px",destroyOnClose:"",canFullscreen:!1},{footer:h(()=>[v(s,{onClick:e.closeModal},{default:h(()=>[U("取消")]),_:1},8,["onClick"]),v(s,{type:"primary",onClick:e.onSubmit},{default:h(()=>[U("保存")]),_:1},8,["onClick"])]),title:h(()=>[y("div",ee,x(e.title),1)]),default:h(()=>[y("div",G,[e.selectedLines>1?(f(),I("div",J,[e.selectedAuthRoleId?(f(),I("span",K,"将选中的2个用户移到其他角色")):(f(),I("span",Q,"将修改选中的2个用户"))])):D("",!0),e.selectedLines==1?(f(),I("div",X,[v(r,{info:e.roleUserInfo,typeOptions:e.typeOptions,typeTrans:""},null,8,["info","typeOptions"])])):D("",!0),y("div",Y,[Z,y("div",null,[v(a,{value:e.authRoleIdList,"onUpdate:value":t[0]||(t[0]=_=>e.authRoleIdList=_),mode:"multiple",style:{width:"100%"},placeholder:"选择角色",options:e.authRoleOptions},null,8,["value","options"])])])])]),_:1},8,["onRegister"])}const ce=H(q,[["render",te]]);export{ce as default};
