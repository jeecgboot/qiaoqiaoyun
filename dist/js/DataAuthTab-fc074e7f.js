var S=(t,u,a)=>new Promise((f,c)=>{var s=e=>{try{i(a.next(e))}catch(r){c(r)}},d=e=>{try{i(a.throw(e))}catch(r){c(r)}},i=e=>e.done?f(e.value):Promise.resolve(e.value).then(s,d);i((a=a.apply(t,u)).next())});import"./index-621e597c.js";import{d as k,w as x,V as l,a6 as y,a7 as B,F as U,k as p,ai as g,E as $}from"./vue-vendor-24c7dc61.js";import{H as R,e as T,l as E}from"./index-831af9dd.js";import"./index-1c3affea.js";import{u as F}from"./useListPage-62a041ef.js";import{dataAuth as C}from"./auth.data-0f6cd267.js";import{d as h}from"./auth.api-15f2ddd8.js";import{u as I}from"./useDesformAuth-fbf3ee83.js";import P from"./DataAuthModal-e287ce29.js";import V from"./SettingAuthModal-8ccbd5e1.js";import z from"./BasicTable-d435f501.js";import{T as N}from"./componentMap-c857637c.js";import"./antd-vue-vendor-0d72f01e.js";import"./vxe-table-vendor-8813019a.js";import"./BasicModal-58413bab.js";import"./useWindowSizeFn-8f085f6f.js";import"./useMethods-f689b480.js";import"./desformUtils-c7daaa89.js";import"./index-52c8c841.js";import"./useForm-14b2bc77.js";import"./helper-22dafba0.js";import"./JAreaLinkage-173780c9.js";import"./areaDataUtil-cdeee717.js";import"./china-area-data-vendor-556d14ee.js";import"./useFormItem-86503382.js";import"./JSelectUser-a44af43a.js";import"./useSelectBiz-2f560b0b.js";import"./props-8a7ac45b.js";import"./JSelectBiz-55a9591f.js";import"./JSelectDept-a90caee3.js";import"./index-f2fd5a28.js";import"./useContextMenu-810f9346.js";import"./JCodeEditor-66bd225e.js";import"./codemirror-17b6f671.js";import"./codemirror-26b29690.js";import"./active-line-512fef49.js";import"./JPopup-2a779923.js";import"./EasyCronInput-b2123242.js";import"./JCheckbox-0b89d32a.js";import"./JDictSelectTag-54dc3bdb.js";import"./JSelectUserByDept-bd619076.js";import"./UserSelectByDepModal-db060ece.js";import"./depart.api-339f4da6.js";import"./JEditor-249b2194.js";import"./index-b845562c.js";import"./JImageUpload-d644253a.js";import"./download-1ac6acce.js";import"./index-f99b266a.js";import"./JUpload-76e119c7.js";import"./index-d508f1f4.js";import"./index-6507b9cd.js";import"./index-4d0525a5.js";import"./UserSelectModal-d78c1490.js";const O=k({name:"DesformIndex",components:{BasicTable:z,TableAction:N,DataAuthModal:P,SettingAuthModal:V},props:{visible:R.bool.def(!1),desformRecord:R.any.isRequired},setup(t){const u=F({tableProps:{immediate:!1,api:o=>{var m;return h.list(o,(m=t.desformRecord)==null?void 0:m.desformCode)},columns:C.columns,showTableSetting:!1,tableSetting:{setting:!1,size:!1},formConfig:{schemas:C.searchFormSchemas,baseColProps:{xs:24,sm:9,md:9,lg:9,xl:9,xxl:9},actionColOptions:{xs:24,sm:6,md:6,lg:6,xl:6,xxl:6}},actionColumn:{width:120}}}),{tableContext:a,doDeleteRecord:f}=u,[c,{reload:s},{}]=a,[d,{openModal:i}]=T(),[e,r]=T(),{doUpdateStatus:b}=I(t);x(()=>t.visible,()=>{t.visible&&t.desformRecord&&s()},{immediate:!0});function A(){i(!0,{isUpdate:!1})}function n(o){i(!0,{isUpdate:!0,record:o})}function _(o){f(()=>h.delete(o.id))}function D(o){b(m=>h.updateStatus(m),o)}function M(Gt){return S(this,arguments,function*({formData:o,resolve:m}){m(yield h.saveOrUpdate(o,!0)),s()})}function v(o){return[{label:"编辑",onClick:()=>n(o)}]}function w(o){return[{label:"授权",onClick:()=>r.openModal(!0,{record:o})},{label:"删除",popConfirm:{title:"确定要删除吗？",placement:"left",confirm:()=>_(o)}}]}return{registerTable:c,registerModal:d,registerSettingAuthModal:e,reload:s,onAuthSave:M,onAddRecord:A,onUpdateStatus:D,getTableAction:v,getDropDownAction:w}}});function q(t,u,a,f,c,s){const d=l("a-button"),i=l("a-switch"),e=l("TableAction"),r=l("BasicTable"),b=l("DataAuthModal"),A=l("SettingAuthModal");return y(),B(U,null,[p(r,{onRegister:t.registerTable},{tableTitle:g(()=>[p(d,{onClick:t.onAddRecord,type:"primary",preIcon:"ant-design:plus"},{default:g(()=>[$("新增")]),_:1},8,["onClick"])]),switch:g(({record:n})=>[p(i,{size:"small",loading:n.loading,checked:n.status===1,onChange:_=>t.onUpdateStatus(n)},null,8,["loading","checked","onChange"])]),action:g(({record:n})=>[p(e,{actions:t.getTableAction(n),dropDownActions:t.getDropDownAction(n)},null,8,["actions","dropDownActions"])]),_:1},8,["onRegister"]),p(b,{onRegister:t.registerModal,desformRecord:t.desformRecord,onSuccess:t.reload},null,8,["onRegister","desformRecord","onSuccess"]),p(A,{onRegister:t.registerSettingAuthModal,onSave:t.onAuthSave},null,8,["onRegister","onSave"])],64)}const Ht=E(O,[["render",q],["__scopeId","data-v-fb664e48"]]);export{Ht as default};
