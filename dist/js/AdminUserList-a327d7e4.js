var U=(e,r,f)=>new Promise((g,k)=>{var h=l=>{try{u(f.next(l))}catch(m){k(m)}},o=l=>{try{u(f.throw(l))}catch(m){k(m)}},u=l=>l.done?g(l.value):Promise.resolve(l.value).then(h,o);u((f=f.apply(e,r)).next())});import{d as P,f as A,r as j,e as O,a3 as R,a4 as x,a5 as t,V as p,a6 as _,a7 as y,F as L,k as d,ak as w,ai as c,E as K,a8 as V,am as E,W as C,af as W}from"./vue-vendor-24c7dc61.js";import{D as q,E as G,F as H}from"./organization.api-98a6e46c.js";import{U as J}from"./UserAvatar-1a3df675.js";import"./index-1c3affea.js";import{a7 as Q,e as X,a as Y,l as Z}from"./index-831af9dd.js";import{U as ee}from"./UserSelectModal-d78c1490.js";import"./BasicModal-58413bab.js";import"./antd-vue-vendor-0d72f01e.js";import"./useWindowSizeFn-8f085f6f.js";import"./vxe-table-vendor-8813019a.js";const te=P({name:"AdminUserList",components:{UserAvatar:J,UserSelectModal:ee},props:{tenantId:{type:Number,default:0},visible:{type:Boolean,default:!1},createBy:{type:String,default:""},superAdmin:{type:Boolean,default:!1}},emits:["back","change"],setup(e,{emit:r}){const f=Q(),{createConfirmSync:g}=Y(),k=A(""),h=A([]),o=j({packName:"",packId:"",packCode:""});function u(a){o.packCode=a.code,l()}function l(){return U(this,null,function*(){let a={tenantId:e.tenantId,packCode:o.packCode};const i=yield q(a);h.value=i.userList||[],o.packId=i.packId,o.packName=i.packName})}function m(){r("back")}const b=A("list"),[I,{openModal:B,closeModal:S}]=X();function s(){B(!0,{list:[]})}function v(a){return!(e.superAdmin===!1||a.username==e.createBy&&o.packCode==="superAdmin")}function $(a){return U(this,null,function*(){if(a&&a.length>0){let i=[],n=[];for(let D of a)i.push(D.realname),n.push(D.id);let N={packId:o.packId,packName:o.packName,tenantId:e.tenantId,userId:n.join(","),realname:i.join(",")};yield G(N),yield l(),r("change")}S()})}function T(a){return U(this,null,function*(){const i=f.getUserInfo.id===a.id;if(i&&!(yield g({title:"警告",content:"你即将移除自己，移除后你将失去该权限，你确定吗？"})))return;let n={packId:o.packId,packName:o.packName,tenantId:e.tenantId,userId:a.id,realname:a.realname};yield H(n),yield l(),r("change"),i&&window.location.reload()})}const z=O(()=>{let a=k.value,i=h.value;return a?i.filter(n=>!!(n.realname.indexOf(a)>=0||n.departNames&&n.departNames.length>0&&M(n.departNames,a)===!0||n.positionNames&&n.positionNames.length>0&&M(n.positionNames,a)===!0)):i});function M(a,i){let n=!1;for(let N of a)if(N.indexOf(i)>=0){n=!0;break}return n}return{userList:h,searchValue:k,addUser:s,back:m,packInfo:o,activeKey:b,show:u,showDeleteButton:v,registerUserModal:I,onSelected:$,deleteUser:T,showUserList:z}}});const F=e=>(R("data-v-e9866f28"),e=e(),x(),e),ae={key:0,class:"admin-role-user-list"},se={class:"role-auth-header"},ne={class:"detail-title"},oe={style:{"font-size":"17px","font-weight":"700"}},ie={class:"role-container"},le={style:{width:"100%"}},re={style:{"padding-top":"20px","padding-bottom":"20px",float:"left"}},de={style:{float:"right",width:"192px","padding-top":"20px"}},ce={class:"my-content"},ue=F(()=>t("div",{class:"user-list-row header"},[t("div",{class:"left"}),t("div",{class:"item"},"人员"),t("div",{class:"item"},"部门"),t("div",{class:"item"},"职位"),t("div",{class:"action"},"操作")],-1)),pe={class:"user-list-row body"},fe=F(()=>t("div",{class:"left",style:{width:"40px"}},null,-1)),me={class:"item"},_e={class:"item nams"},ke={class:"item nams"},he={class:"action"},ve={class:"my-content",style:{"padding-top":"20px"}};function ye(e,r,f,g,k,h){const o=p("Icon"),u=p("a-button"),l=p("a-input-search"),m=p("UserAvatar"),b=p("a-list"),I=p("a-tab-pane"),B=p("a-tabs"),S=p("user-select-modal");return _(),y(L,null,[e.visible?(_(),y("div",ae,[t("div",se,[t("div",ne,[d(o,{style:{"font-size":"24px","margin-right":"24px"},class:"pointer",icon:"ant-design:arrow-left-outlined",onClick:e.back},null,8,["onClick"]),t("span",oe,w(e.packInfo.packName),1)])]),t("div",ie,[t("div",le,[t("div",re,[d(u,{disabled:!e.superAdmin,type:"primary",onClick:e.addUser},{default:c(()=>[K("添加成员")]),_:1},8,["disabled","onClick"])]),t("div",de,[d(l,{value:e.searchValue,"onUpdate:value":r[0]||(r[0]=s=>e.searchValue=s),placeholder:"搜索"},null,8,["value"])])]),d(B,{activeKey:e.activeKey,"onUpdate:activeKey":r[1]||(r[1]=s=>e.activeKey=s),class:"pack-user-and-auth-tab"},{default:c(()=>[d(I,{key:"list"},{tab:c(()=>[t("span",{class:V(e.activeKey=="list"?"my-title active":"my-title")},"成员列表",2)]),default:c(()=>[t("div",ce,[d(b,{"data-source":e.showUserList,pagination:!1},{header:c(()=>[ue]),renderItem:c(({item:s})=>[t("div",pe,[fe,t("div",me,[d(m,{detail:s},null,8,["detail"])]),t("div",_e,[s.departNames&&s.departNames.length>0?(_(!0),y(L,{key:0},E(s.departNames,v=>(_(),y("span",null,w(v),1))),256)):C("",!0)]),t("div",ke,[s.positionNames&&s.positionNames.length>0?(_(!0),y(L,{key:0},E(s.positionNames,v=>(_(),y("span",null,w(v),1))),256)):C("",!0)]),t("div",he,[e.showDeleteButton(s)?(_(),W(u,{key:0,type:"link",onClick:v=>e.deleteUser(s)},{default:c(()=>[K(" 移 除 ")]),_:2},1032,["onClick"])):C("",!0)])])]),_:1},8,["data-source"])])]),_:1}),d(I,{key:"detail","force-render":""},{tab:c(()=>[t("span",{class:V(e.activeKey=="detail"?"my-title active":"my-title")},"权限详情",2)]),default:c(()=>[t("div",ve," . "+w(e.packInfo.packName),1)]),_:1})]),_:1},8,["activeKey"])])])):C("",!0),d(S,{multi:!0,onRegister:e.registerUserModal,onSelected:e.onSelected},null,8,["onRegister","onSelected"])],64)}const Me=Z(te,[["render",ye],["__scopeId","data-v-e9866f28"]]);export{Me as default};
