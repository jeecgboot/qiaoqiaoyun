var ne=Object.defineProperty;var x=Object.getOwnPropertySymbols;var ue=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var H=(e,o,n)=>o in e?ne(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n,E=(e,o)=>{for(var n in o||(o={}))ue.call(o,n)&&H(e,n,o[n]);if(x)for(var n of x(o))se.call(o,n)&&H(e,n,o[n]);return e};var D=(e,o,n)=>new Promise((S,C)=>{var A=l=>{try{f(n.next(l))}catch(c){C(c)}},h=l=>{try{f(n.throw(l))}catch(c){C(c)}},f=l=>l.done?S(l.value):Promise.resolve(l.value).then(A,h);f((n=n.apply(e,o)).next())});import{d as ae,f as m,h as le,e as re,a3 as de,a4 as pe,a5 as u,V as r,a6 as _,a7 as q,F as M,k as s,ai as d,af as Z,W as G,ak as T,z as J,am as me,E as N,ae as K}from"./vue-vendor-24c7dc61.js";import{aC as ce,a$ as fe,a_ as ve,cr as ye}from"./antd-vue-vendor-0d72f01e.js";import _e from"./ZdyanDrawer-58ee121b.js";import{R as ge,a8 as Ee,ch as we,l as Ce}from"./index-831af9dd.js";import{u as he}from"./useCustomButton-fa741dda.js";import{d as Fe}from"./vuedraggable-vendor-6ef4bc68.js";import{f as Be}from"./LinkRecordSelect-385d0eae.js";import"./ButtonColorSelector-58fbd93b.js";import"./vxe-table-vendor-8813019a.js";import"./ButtonConditions-9a9a88d5.js";import"./type.definition-4eb605ee.js";import"./FilterFiledListNew-bbda127c.js";import"./ComponentIcon-f1bbb90f.js";import"./SuperQueryValComponent-97f284a9.js";import"./componentMap-c857637c.js";import"./useFormItem-86503382.js";import"./index-1c3affea.js";import"./BasicModal-58413bab.js";import"./useWindowSizeFn-8f085f6f.js";import"./download-1ac6acce.js";import"./index-f99b266a.js";import"./JSelectUser-a44af43a.js";import"./useSelectBiz-2f560b0b.js";import"./props-8a7ac45b.js";import"./JSelectBiz-55a9591f.js";import"./JImageUpload-d644253a.js";import"./JDictSelectTag-54dc3bdb.js";import"./JSelectDept-a90caee3.js";import"./index-f2fd5a28.js";import"./useContextMenu-810f9346.js";import"./areaDataUtil-cdeee717.js";import"./china-area-data-vendor-556d14ee.js";import"./JPopup-2a779923.js";import"./useMethods-f689b480.js";import"./JCheckbox-0b89d32a.js";import"./JSelectUserByDept-bd619076.js";import"./UserSelectByDepModal-db060ece.js";import"./depart.api-339f4da6.js";import"./JUpload-76e119c7.js";import"./index-d508f1f4.js";import"./index-6507b9cd.js";import"./index-4d0525a5.js";import"./UserSelectModal-d78c1490.js";import"./helper-22dafba0.js";import"./SelectItem-04dd2229.js";import"./lowAppUtils-56892d30.js";import"./auto.desform.api-839115ed.js";import"./desformUtils-c7daaa89.js";import"./LinkRecordTags-cf4c2463.js";import"./FormSchemaFactory-ec827fa7.js";import"./index-bff0b654.js";import"./lowAppAuth-3d637b7d.js";import"./useFuncSwitch-b7681246.js";import"./DictColors-73058d23.js";import"./TableImage-14ca1f5d.js";import"./SubTableTag-81763fd6.js";import"./CardCellFile-92b3c8c8.js";import"./ButtonConfirmText-527dd2f0.js";import"./FilterFiledList-8a929f88.js";import"./ButtonFormConfig-7880f3ed.js";import"./FormFieldSelect-9cf3f019.js";const be=ae({name:"Zidingyianniu",components:{PlusOutlined:ce,ZdyanDrawer:_e,Icon:ge,IconPicker:Ee,SvgIcon:we,DeleteOutlined:fe,draggable:Fe,EditOutlined:ve,OrderedListOutlined:ye},emits:["refresh"],props:{info:{type:Object||String,require:!1,default:{}},code:{type:String,require:!1,default:""},viewId:{type:String,require:!1,default:""},designFormName:{type:String,require:!1,default:""},isLowApp:{type:Boolean,default:!1}},setup(e,{emit:o}){const{queryDesignButtonList:n,removeButton:S,removeRelation:C,addRelation:A,resetSequence:h}=he(e),{allColumns:f}=Be(e,!1),l=m([]),c=m([]),F=m(!1),k=m("");le(()=>{let t=e.viewId,a=e.info.buttonList||[];B(t,a),k.value=e.info.designFormTitleField});function B(t,a){return D(this,null,function*(){const p=yield n();v(p,t,a)})}function v(t,a,p){let R=[],j=[];if(t&&t.length>0)for(let y of t)p&&p.indexOf(y.id)>=0?R.push(E({},y)):y.allView===!0?R.push(E({},y)):j.push(E({},y));R.sort(function(y,ie){return y.seq-ie.seq}),l.value=R,c.value=j}function $(t){return D(this,null,function*(){yield A(t.id),yield i()})}const P={showStatus:"always",clickThen:"execute",flowStatus:!0,color:"rgb(33, 150, 243)"};function g(t){t.preventDefault(),t.stopPropagation()}const V=m();function I(t){V.value.show(t)}function i(){return D(this,null,function*(){o("refresh");const t=yield n();let a=e.viewId,p=e.info.buttonList||[];v(t,a,p)})}function U(t){t&&g(t),F.value=!1,I({title:"添加按钮",button:E({},P),isUpdate:!1})}function b(t,a){t&&g(t),F.value=!1,I({title:"编辑按钮",button:E({},a),isUpdate:!0})}function Q(){X()}function X(){let t=l.value,a=[];if(t&&t.length>0)for(let p=0;p<t.length;p++)a.push({id:t[p].id,seq:p});h(a)}const z=m(!1),O=m("1"),L=m(""),W=m(!1);function Y(t,a){t&&g(t),z.value=!0,L.value=a.id,W.value=a.allView===!0,W.value?O.value="2":O.value="1"}function ee(){return D(this,null,function*(){O.value==="1"?yield C(L.value):yield S(L.value),yield i(),z.value=!1,L.value=""})}const te={display:"flex",height:"30px",lineHeight:"30px"},oe=re(()=>e.isLowApp==!0?{top:"50px"}:{top:"100px"});return{buttonList:l,showPop:F,otherViewButtons:c,innerDrawerRef:V,onSelect:$,onSuccess:i,onAdd:U,onEdit:b,onRemove:Y,onDragEnd:Q,radioStyle:te,modalVisible:z,removeStatus:O,disabledRCView:W,doRemove:ee,allColumns:f,contentWrapperStyle:oe,titleField:k}}});const w=e=>(de("data-v-67cb4c23"),e=e(),pe(),e),De={class:"inner-content"},Se=w(()=>u("div",{class:"title"},"自定义按钮",-1)),Ae=w(()=>u("div",{class:"tip"},"在当前视图下的记录中添加自定义按钮，当用户点击按钮后填写预设的内容或执行一个工作流",-1)),ke={key:0,class:"config-detail",style:{width:"360px","padding-top":"0"}},Ve={class:"query-field-list"},Ie={class:"query-field-item"},Oe={style:{width:"30px","padding-left":"5px"}},Le={style:{flex:"1"}},Re={style:{"margin-right":"8px"}},qe={class:"ellipsis"},Ne={class:"right-icon"},$e={class:"field-list"},Pe=w(()=>u("div",{style:{color:"#9e9e9e !important","padding-left":"15px"}},"选择已有按钮",-1)),Ue=["onClick"],ze=w(()=>u("span",{style:{"margin-left":"10px"}},"创建新按钮",-1)),We=w(()=>u("span",{style:{"margin-left":"10px"}},"添加按钮",-1)),Ze=w(()=>u("span",{style:{"margin-left":"10px"}},"添加按钮",-1)),Te={style:{padding:"15px 20px"}};function je(e,o,n,S,C,A){const h=r("OrderedListOutlined"),f=r("Icon"),l=r("EditOutlined"),c=r("DeleteOutlined"),F=r("draggable"),k=r("a-divider"),B=r("PlusOutlined"),v=r("a-button"),$=r("a-popover"),P=r("zdyan-drawer"),g=r("a-radio"),V=r("a-radio-group"),I=r("a-modal");return _(),q(M,null,[u("div",De,[Se,Ae,e.buttonList.length>0?(_(),q("div",ke,[u("div",Ve,[s(F,{"item-key":"name",animation:"300",modelValue:e.buttonList,"onUpdate:modelValue":o[0]||(o[0]=i=>e.buttonList=i),dragClass:"dragClass",onEnd:e.onDragEnd},{item:d(({element:i,index:U})=>[u("div",Ie,[u("div",Oe,[s(h,{title:"调整顺序"})]),u("div",Le,[u("span",Re,[i.icon?(_(),Z(f,{key:0,icon:i.icon,color:i.color,size:16},null,8,["icon","color"])):G("",!0)]),u("span",qe,T(i.label),1)]),u("div",Ne,[s(l,{title:"编辑",onClick:J(b=>e.onEdit(b,i),["prevent"])},null,8,["onClick"]),s(c,{title:"删除",onClick:J(b=>e.onRemove(b,i),["prevent"])},null,8,["onClick"])])])]),_:1},8,["modelValue","onEnd"])])])):G("",!0),e.otherViewButtons.length>0?(_(),Z($,{key:1,overlayClassName:"view-pop-field-select",placement:"bottom",overlayStyle:{width:"360px"},open:e.showPop,"onUpdate:open":o[2]||(o[2]=i=>e.showPop=i),trigger:"click"},{content:d(()=>[u("div",$e,[Pe,(_(!0),q(M,null,me(e.otherViewButtons,i=>(_(),q("div",{class:"field-item",onClick:U=>e.onSelect(i)},[u("div",null,T(i.label),1)],8,Ue))),256)),s(k,{style:{margin:"2px 0 5px 0"}}),u("div",{class:"field-item",onClick:o[1]||(o[1]=(...i)=>e.onAdd&&e.onAdd(...i))},[s(B),ze])])]),title:d(()=>[]),default:d(()=>[s(v,{block:"",style:{"margin-top":"15px"}},{default:d(()=>[s(B),We]),_:1})]),_:1},8,["open"])):(_(),Z(v,{key:2,block:"",style:{"margin-top":"15px"},onClick:e.onAdd},{default:d(()=>[s(B),Ze]),_:1},8,["onClick"]))]),s(P,{ref:"innerDrawerRef",onSuccess:e.onSuccess,code:e.code,designFormName:e.designFormName,viewId:e.viewId,titleField:e.titleField,contentWrapperStyle:e.contentWrapperStyle,allColumns:e.allColumns},null,8,["onSuccess","code","designFormName","viewId","titleField","contentWrapperStyle","allColumns"]),s(I,{centered:"",open:e.modalVisible,"onUpdate:open":o[6]||(o[6]=i=>e.modalVisible=i),wrapClassName:"remove-confirm-mdoal",title:"删除按钮",width:"480px",destroyOnClose:""},{footer:d(()=>[s(v,{onClick:o[4]||(o[4]=i=>e.modalVisible=!1)},{default:d(()=>[N("取消")]),_:1}),s(v,{type:"primary",danger:"",onClick:o[5]||(o[5]=i=>e.doRemove())},{default:d(()=>[N("删除")]),_:1})]),default:d(()=>[u("div",Te,[s(V,{value:e.removeStatus,"onUpdate:value":o[3]||(o[3]=i=>e.removeStatus=i)},{default:d(()=>[s(g,{style:K(e.radioStyle),value:"1",disabled:e.disabledRCView},{default:d(()=>[N(T(e.disabledRCView?"全局按钮无法单独从当前视图中删除":"仅从当前视图中移除"),1)]),_:1},8,["style","disabled"]),s(g,{style:K(e.radioStyle),value:"2"},{default:d(()=>[N("彻底删除按钮，与之对应触发的工作流也将被删除")]),_:1},8,["style"])]),_:1},8,["value"])])]),_:1},8,["open"])],64)}const Yt=Ce(be,[["render",je],["__scopeId","data-v-67cb4c23"]]);export{Yt as default};
