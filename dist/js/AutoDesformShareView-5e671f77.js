var x=(u,p,n)=>new Promise((v,a)=>{var l=t=>{try{d(n.next(t))}catch(c){a(c)}},g=t=>{try{d(n.throw(t))}catch(c){a(c)}},d=t=>t.done?v(t.value):Promise.resolve(t.value).then(l,g);d((n=n.apply(u,p)).next())});import{d as U,a2 as z,e as s,f as C,c as W,V as L,a6 as _,a7 as M,af as G,u as r,a5 as V,k as j,W as q,a8 as Y,ae as J,n as K}from"./vue-vendor-24c7dc61.js";import"./index-1c3affea.js";import{a7 as Q,h as X,e as Z,cr as ee}from"./index-831af9dd.js";import{u as oe}from"./useFuncSwitch-b7681246.js";import{a as te}from"./useAuth-d62eecf0.js";import"./BasicModal-58413bab.js";import"./antd-vue-vendor-0d72f01e.js";import"./useWindowSizeFn-8f085f6f.js";import"./vxe-table-vendor-8813019a.js";import"./lowAppAuth-3d637b7d.js";import"./lowAppUtils-56892d30.js";const se={key:1,class:"no-view-auth"},ae={class:"icon"},ne=V("div",{class:"tip"},"数据无法访问",-1),ge=U({__name:"AutoDesformShareView",props:{currentViewId:{type:String,default:""},viewConfigList:{type:Array,default:()=>[]}},setup(u){const p=u,n=Q(),v=z(),a=s(()=>v.currentRoute.value),l=C(),{prefixCls:g}=X("auto-desform-data-view"),[d,{openModal:t}]=Z(),{hasUpdateAuth:c}=te(),h=s(()=>a.value.params.appId),w=s(()=>a.value.params.viewId),O=s(()=>a.value.params.dataId),R=s(()=>a.value.params.code),m=C(""),k=(e,o)=>x(this,null,function*(){d(e,o),m.value=yield ee(R.value),yield K(),I()}),A=s(()=>{let e=20,o=100;return window.innerWidth<1200&&(e=0,o=0),{padding:`${e}px ${o}px`}}),S=s(()=>p.viewConfigList?p.viewConfigList.find(e=>e.id===w.value):null),F=s(()=>{var e,o;return((o=(e=l.value)==null?void 0:e.offsetHeight)!=null?o:window.innerHeight)-130+"px"}),{getHasFunc:f}=oe(),b=f("RECORD_COMMENT"),E=f("FILES_DOWNLOAD"),$=f("RECORD_LOGS"),H=f("RECORD_SHARE"),B=f("RECORD_SYS_PRINT"),N=W("leftMenuList",C([]));function D(){if(h.value){const e=[R.value,m.value],o=N.value.find(y=>e.includes(y.menuUrl));let i;o?i=`/myapp/${h.value}/${o.type}/${o.menuUrl}`:i=`/myapp/${h.value}/desform/${m.value}`,v.push(i)}}function T(){I()}function I(){t(!0,{mode:"detail",desformCode:m.value,dataId:O.value,isOnline:!1,viewId:w.value,lowAppId:h.value,setMode({record:e}){let o=e!=null&&e.desformData?e.desformData:e;return c(m.value,w.value,[o])?"edit":"detail"}})}function P(){return n.hasShareTenantId?(D(),!1):!0}return(e,o)=>{const i=L("DesformViewModal"),y=L("Icon");return _(),M("div",{ref_key:"boxRef",ref:l,class:Y([`${r(g)}-box`]),style:J(A.value)},[S.value!=null?(_(),G(i,{key:0,"inline-mode":"",bodyHeight:F.value,getContainer:()=>l.value,showComment:r(b),showFiles:r(E),showDataLog:r($),showRecordShare:r(H),showRecordSysPrint:r(B),showDesignFormBtn:!1,dynamicConfig:S.value,closeFunc:P,onRegister:k,onSuccess:o[0]||(o[0]=()=>{}),onClose:D,onGotoRecord:T},null,8,["bodyHeight","getContainer","showComment","showFiles","showDataLog","showRecordShare","showRecordSysPrint","dynamicConfig"])):u.currentViewId&&u.currentViewId!==w.value?(_(),M("div",se,[V("div",ae,[j(y,{icon:"ic:baseline-error",size:80})]),ne])):q("",!0)],6)}}});export{ge as default};
