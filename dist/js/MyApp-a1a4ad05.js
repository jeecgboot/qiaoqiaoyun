var T=(t,h,f)=>new Promise((u,c)=>{var I=n=>{try{d(f.next(n))}catch(r){c(r)}},_=n=>{try{d(f.throw(n))}catch(r){c(r)}},d=n=>n.done?u(n.value):Promise.resolve(n.value).then(I,_);d((f=f.apply(t,h)).next())});import{d as j,a2 as L,f as m,h as V,u as v,a3 as q,a4 as O,a5 as C,V as i,a6 as l,a7 as k,k as b,ai as o,F as E,am as Y,af as z,ak as M,W as w,E as U}from"./vue-vendor-24c7dc61.js";import{r as H,i as Q}from"./antd-vue-vendor-0d72f01e.js";import{a as J,L as R,l as W}from"./index-831af9dd.js";import{q as G,a as X,d as Z}from"./market.api-af34a608.js";import"./vxe-table-vendor-8813019a.js";const K=[{title:"应用名称",align:"center",dataIndex:"title",width:600},{title:"下载次数",align:"center",dataIndex:"downloadNum"},{title:"发布时间",align:"center",dataIndex:"publishTime"},{title:"操作",align:"center",dataIndex:"action"}],N=[{title:"应用名称",align:"center",dataIndex:"title",width:600},{title:"审核通过时间",align:"center",dataIndex:"updateTime"},{title:"操作",align:"center",dataIndex:"action"}],A=[{title:"应用名称",align:"center",dataIndex:"title",width:600},{title:"提交审核时间",align:"center",dataIndex:"createTime"}],B=[{title:"应用名称",align:"center",dataIndex:"title",width:600},{title:"原因",align:"center",dataIndex:"rejectCause"},{title:"操作",align:"center",dataIndex:"action"}],F=[{title:"应用名称",align:"center",dataIndex:"title",width:600},{title:"最后编辑时间",align:"center",dataIndex:"lastUpdate"},{title:"操作",align:"center",dataIndex:"action"}],ee=j({name:"myApp",components:{Popconfirm:H},props:{tabKey:{type:Number,default:6}},setup(t){const{createMessage:h}=J(),f=L(),u=m(t.tabKey),c=m({status:1,izPublish:1}),I=m({column:"createTime",order:"desc"}),_=m(!1),d=m([{label:"已发布",key:6},{label:"审核通过",key:2},{label:"审核中",key:1},{label:"未通过",key:-1},{label:"草稿",key:0}]),n=m([...K]),r=m([]),s=m({current:1,pageSize:10,pageSizeOptions:["10","20","30"],showTotal:(e,a)=>a[0]+"-"+a[1]+" 共"+e+"条",showQuickJumper:!0,showSizeChanger:!0,total:0});V(()=>{n.value=t.tabKey===-1?B:t.tabKey===0?F:t.tabKey===1?A:t.tabKey===2?N:K});function y(e){e===1&&(s.value.current=1),_.value=!0;let a=D();G(a).then(p=>{p.records?(r.value=p.records,p.total?s.value.total=p.total:s.value.total=0):h.warning(p.message)}).finally(()=>{_.value=!1})}function D(){let e=Object.assign({delFlag:0},I.value);return e.status=v(c).status,v(u)==6||v(u)==2?(e.status=2,e.izPublish=v(u)==6?1:0):v(u)==-1&&(e.status=-1),e.pageNo=s.value.current,e.pageSize=s.value.pageSize,R(e)}function x(e){f.push({path:"/myapps/templatePublish",query:{id:e}})}function S(e){let a=e.izPublish===1?0:1;X({id:e.id,izPublish:a,publishTime:Q(new Date).format("YYYY-MM-DD HH:mm:ss")}).then(p=>{p.success&&y()})}function g(e){e==6?(c.value.status=2,c.value.izPublish=1):c.value.status=e,s.value.current=1,n.value=e===-1?B:e===0?F:e===1?A:e===2?N:K,y()}function P(e){return T(this,null,function*(){(yield Z({id:e}))&&y()})}return y(),{tabList:d,activeKey:u,onChangeTab:g,loading:_,handleEdit:x,handleDelete:P,handlePublish:S,columns:n,dataSource:r,ipagination:s}}});const $=t=>(q("data-v-f7792cac"),t=t(),O(),t),te={class:"template-myapp-page"},ae=$(()=>C("div",{class:"title"},"我的应用",-1)),ne={class:"tab-container"},se={key:0},ie=["onClick"],le={class:"ant-dropdown-link"},oe=$(()=>C("a",null,"删除",-1));function ue(t,h,f,u,c,I){const _=i("a-divider"),d=i("Popconfirm"),n=i("a-icon"),r=i("a-menu-item"),s=i("a-menu"),y=i("a-dropdown"),D=i("a-table"),x=i("a-tab-pane"),S=i("a-tabs");return l(),k("div",te,[ae,C("div",ne,[b(S,{activeKey:t.activeKey,"onUpdate:activeKey":h[0]||(h[0]=g=>t.activeKey=g),onChange:t.onChangeTab},{default:o(()=>[(l(!0),k(E,null,Y(t.tabList,g=>(l(),z(x,{key:g.key,tab:g.label,"force-render":""},{default:o(()=>[b(D,{ref_for:!0,ref:"table",size:"middle",scroll:{x:!0},bordered:"",rowKey:"id",class:"j-table-force-nowrap",columns:t.columns,dataSource:t.dataSource,pagination:t.ipagination,loading:t.loading},{bodyCell:o(({column:P,text:e,record:a})=>[P.dataIndex==="lastUpdate"?(l(),k("span",se,M(a.updateTime?a.updateTime:a.createTime),1)):P.dataIndex==="action"?(l(),k(E,{key:1},[a.status!==2||a.izPublish!==1?(l(),k("a",{key:0,onClick:p=>t.handleEdit(a.id)},"编辑",8,ie)):w("",!0),a.status!==2||a.izPublish!==1?(l(),z(_,{key:1,type:"vertical"})):w("",!0),a.status===2?(l(),z(d,{key:2,title:`确定${a.izPublish===0?"发布":"取消发布"}吗?`,onConfirm:()=>t.handlePublish(a)},{default:o(()=>[C("a",null,M(a.izPublish===0?"发布":"取消发布"),1)]),_:2},1032,["title","onConfirm"])):w("",!0),a.status!==2?(l(),z(y,{key:3},{overlay:o(()=>[b(s,{class:"antd-more"},{default:o(()=>[b(r,null,{default:o(()=>[b(d,{title:"确定删除吗?",onConfirm:()=>t.handleDelete(a.id)},{default:o(()=>[oe]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:o(()=>[C("a",le,[U("更多 "),b(n,{type:"down"})])]),_:2},1024)):w("",!0)],64)):w("",!0)]),_:1},8,["columns","dataSource","pagination","loading"])]),_:2},1032,["tab"]))),128))]),_:1},8,["activeKey","onChange"])])])}const _e=W(ee,[["render",ue],["__scopeId","data-v-f7792cac"]]);export{_e as default};
