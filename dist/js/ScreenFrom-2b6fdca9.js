var Z=Object.defineProperty,x=Object.defineProperties;var ee=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var te=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var T=(e,o,s)=>o in e?Z(e,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[o]=s,N=(e,o)=>{for(var s in o||(o={}))te.call(o,s)&&T(e,s,o[s]);if(D)for(var s of D(o))oe.call(o,s)&&T(e,s,o[s]);return e},E=(e,o)=>x(e,ee(o));var I=(e,o,s)=>new Promise((B,g)=>{var S=l=>{try{h(s.next(l))}catch(d){g(d)}},v=l=>{try{h(s.throw(l))}catch(d){g(d)}},h=l=>l.done?B(l.value):Promise.resolve(l.value).then(S,v);h((s=s.apply(e,o)).next())});import{d as ne,f as _,u as P,a3 as ie,a4 as se,a5 as r,V as f,a6 as k,a7 as y,F as M,k as a,ai as m,E as w,am as ae,ak as O,af as le}from"./vue-vendor-24c7dc61.js";import{v as re,b as ce,c as ue,e as de,f as pe}from"./screen.api-1b93c7a9.js";import{m as me,M as ge}from"./antd-vue-vendor-0d72f01e.js";import{b5 as he,a7 as fe,d as ke,c as A,a as ve,b as $,l as _e}from"./index-831af9dd.js";import"./index-52c8c841.js";import{b as ye}from"./screen.data-747c5235.js";import{B as be,u as we}from"./useForm-14b2bc77.js";import"./vxe-table-vendor-8813019a.js";import"./componentMap-c857637c.js";import"./useFormItem-86503382.js";import"./index-1c3affea.js";import"./BasicModal-58413bab.js";import"./useWindowSizeFn-8f085f6f.js";import"./download-1ac6acce.js";import"./index-f99b266a.js";import"./JSelectUser-a44af43a.js";import"./useSelectBiz-2f560b0b.js";import"./props-8a7ac45b.js";import"./JSelectBiz-55a9591f.js";import"./JImageUpload-d644253a.js";import"./JDictSelectTag-54dc3bdb.js";import"./JSelectDept-a90caee3.js";import"./index-f2fd5a28.js";import"./useContextMenu-810f9346.js";import"./areaDataUtil-cdeee717.js";import"./china-area-data-vendor-556d14ee.js";import"./JPopup-2a779923.js";import"./useMethods-f689b480.js";import"./JCheckbox-0b89d32a.js";import"./JSelectUserByDept-bd619076.js";import"./UserSelectByDepModal-db060ece.js";import"./depart.api-339f4da6.js";import"./JUpload-76e119c7.js";import"./index-d508f1f4.js";import"./index-6507b9cd.js";import"./index-4d0525a5.js";import"./UserSelectModal-d78c1490.js";import"./JAreaLinkage-173780c9.js";import"./JCodeEditor-66bd225e.js";import"./codemirror-17b6f671.js";import"./codemirror-26b29690.js";import"./active-line-512fef49.js";import"./EasyCronInput-b2123242.js";import"./JEditor-249b2194.js";import"./index-b845562c.js";import"./helper-22dafba0.js";const Se=ne({name:"ScreenFrom",components:{BasicForm:be,Pagination:me},setup(){const{clipboardRef:e,copiedRef:o}=he(),s=_(""),B=fe(),{createMessage:g}=ve(),S=_([]),v=ke(),h=_(!1),[l,{setFieldsValue:d,validate:V}]=we({schemas:ye,showActionButtonGroup:!1,labelCol:{span:24},wrapperCol:{span:24}}),C=_("新增大屏"),F=_({}),b=_({current:1,total:0,pageSize:10}),W=A(),U=_(!1),n=_("");function z(){u(1)}u(1);function u(t){b.value.current=t;let i=B.getUserInfo.username,p={current:t,size:b.value.pageSize,createBy:i,screenName:P(s),category:"3"};re(p).then(c=>{c.success?(S.value=c.result.records,c.result.records.length>0&&(b.value.total=c.result.total)):g.warning(c.message)})}function R(t){C.value="编辑大屏",h.value=!0,ce({id:t.id}).then(i=>{if(i.success){let p=i.result;d(p),F.value=i.result}else g.warning("获取数据失败")})}function J(t){return I(this,null,function*(){ge.confirm({title:"提示",content:"此操作将删除该大屏, 是否继续?",okText:"确认",cancelText:"取消",onOk:()=>{ue({ids:t}).then(i=>{i.success?(g.success(i.message),u(1)):g.warning(i.message)})}})})}function L(t){let i=$();n.value=`${v.domainUrl}/bigscreen/#/view/${t}?token=${i}`,U.value=!0}function j(){const t=P(n);e.value=t,P(o)&&g.success("复制成功！")}function G(t){let p=v.domainUrl+"/bigscreen/#/view/"+t.id+"?token="+$();window.open(p,"_blank")}function q(t){return I(this,null,function*(){yield de({id:t},u)})}function H(t){localStorage.setItem("type","3");let p=v.domainUrl+"/bigscreen/#/build/"+t.id+"?token="+$();window.open(p,"_blank")}function K(){C.value="新增大屏",h.value=!0;let t=window.screen.height*window.devicePixelRatio,i=window.screen.width*window.devicePixelRatio;setTimeout(()=>{d({width:i,height:t})},300)}function Q(){return I(this,null,function*(){let t=yield V(),i=!1,p={};if(t.id){i=!0;let c=F.value.desScreenMainJson?JSON.parse(F.value.desScreenMainJson):{};c.width=t.width,c.height=t.height,c.protectionCode=t.protectionCode,c.name=t.screenName,p=N({},c)}else p=E(N({},t),{backgroundImage:"./img/bg/bg1.png"}),t.status="0",t.type="3",t.delFlag=0,t.tenantId=A();t.desScreenMainJson=JSON.stringify(p),yield pe(t,i).then(c=>{if(c.success){if(u(1),!i){localStorage.setItem("type","1");let Y=v.domainUrl+"/bigscreen/#/build/"+c.result.id+"?token="+$();window.open(Y,"_blank")}h.value=!1}else g.error(c.message)})})}function X(t,i){b.value.pageSize=i,u(t)}return{registerAddForm:l,enterSearchClick:z,screenList:S,loadScreen:u,editWork:R,delWork:J,viewWork:G,copyWork:q,screenWork:H,addScreenClick:K,screenTitle:C,addVisible:h,screenName:s,handleAddScreenOk:Q,pagination:b,screenPageChange:X,publishScreen:L,publishUrl:n,publishVisible:U,copyPublishUrl:j}}});const Ce=e=>(ie("data-v-fa2d5c5d"),e=e(),se(),e),Fe={class:"search-item"},Ue={style:{display:"flex"}},Be={class:"search-screen"},Ie={class:"add-screen"},$e={class:"show-box"},Ve={key:0,class:"show-list"},ze={style:{display:"flex",float:"left"}},Ne=Ce(()=>r("em",{class:"aui-tag"},[r("i",{class:"aui-tag-re"}),r("i",{class:"aui-tag-ye"}),r("i",{class:"aui-tag-bl"})],-1)),Pe={class:"down-position"},We={key:0,class:"aui-mould-name"},De={key:1,class:"aui-mould-name"},Te=["onClick"],Ee=["src"],Me={key:1,class:"thumb-size2",src:"https://static.jeecg.com/upload/test/jimu1_1597227851808.png",alt:"封面图"},Oe={class:"screen-page"},Ae={class:"publish_div"},Re={class:"urlDiv flex ellipsis"};function Je(e,o,s,B,g,S){const v=f("a-input-search"),h=f("a-button"),l=f("Icon"),d=f("a-menu-item"),V=f("a-menu"),C=f("a-dropdown"),F=f("a-empty"),b=f("Pagination"),W=f("BasicForm"),U=f("a-modal");return k(),y(M,null,[r("div",Fe,[r("div",Ue,[r("div",Be,[a(v,{placeholder:"请填写名称",value:e.screenName,"onUpdate:value":o[0]||(o[0]=n=>e.screenName=n),onSearch:e.enterSearchClick},null,8,["value","onSearch"])]),r("div",Ie,[a(h,{type:"primary",preIcon:"ant-design:plus-outlined",onClick:e.addScreenClick},{default:m(()=>[w("新增大屏")]),_:1},8,["onClick"])])]),r("div",$e,[e.screenList.length>0?(k(),y("ul",Ve,[(k(!0),y(M,null,ae(e.screenList,(n,z)=>(k(),y("li",{key:z},[r("div",ze,[Ne,r("div",Pe,[a(C,null,{overlay:m(()=>[a(V,null,{default:m(()=>[a(d,{key:"0",onClick:u=>e.editWork(n)},{default:m(()=>[a(l,{icon:"ant-design:edit-outlined",style:{"margin-right":"5px"}}),w("编辑 ")]),_:2},1032,["onClick"]),a(d,{key:"1",onClick:u=>e.delWork(n.id)},{default:m(()=>[a(l,{icon:"ant-design:delete-outlined",style:{"margin-right":"5px"}}),w("删除 ")]),_:2},1032,["onClick"]),a(d,{key:"3",onClick:u=>e.viewWork(n)},{default:m(()=>[a(l,{icon:"ant-design:eye-outlined",style:{"margin-right":"5px"}}),w("预览 ")]),_:2},1032,["onClick"]),a(d,{key:"4",onClick:u=>e.copyWork(n.id)},{default:m(()=>[a(l,{icon:"ant-design:copy-outlined",style:{"margin-right":"5px"}}),w("复制 ")]),_:2},1032,["onClick"]),a(d,{key:"5",onClick:u=>e.publishScreen(n.id)},{default:m(()=>[a(l,{icon:"ant-design:send-outlined",style:{"margin-right":"5px"}}),w("发布 ")]),_:2},1032,["onClick"])]),_:2},1024)]),default:m(()=>[a(l,{icon:"ant-design:setting-outlined"})]),_:2},1024)])]),n.title?(k(),y("p",We,O(n.title),1)):(k(),y("p",De," ")),r("div",{class:"aui-mould-img",onClick:u=>e.screenWork(n)},[n.thumbnail?(k(),y("img",{key:0,src:n.thumbnail},null,8,Ee)):(k(),y("img",Me))],8,Te)]))),128))])):(k(),le(F,{key:1,description:"暂无数据"}))]),r("div",Oe,[a(b,{current:e.pagination.current,"onUpdate:current":o[1]||(o[1]=n=>e.pagination.current=n),total:e.pagination.total,"onUpdate:total":o[2]||(o[2]=n=>e.pagination.total=n),pageSize:e.pagination.pageSize,"onUpdate:pageSize":o[3]||(o[3]=n=>e.pagination.pageSize=n),"show-quick-jumper":"",onChange:e.screenPageChange},null,8,["current","total","pageSize","onChange"])])]),a(U,{title:e.screenTitle,open:e.addVisible,"onUpdate:open":o[4]||(o[4]=n=>e.addVisible=n),onOk:e.handleAddScreenOk,"destroy-on-close":""},{default:m(()=>[a(W,{onRegister:e.registerAddForm,style:{padding:"20px"}},null,8,["onRegister"])]),_:1},8,["title","open","onOk"]),a(U,{title:"发布",style:{width:"40%"},open:e.publishVisible,"onUpdate:open":o[6]||(o[6]=n=>e.publishVisible=n),footer:null,"destroy-on-close":""},{default:m(()=>[r("div",Ae,[r("div",Re,O(e.publishUrl),1),r("div",{class:"copyBtn",onClick:o[5]||(o[5]=(...n)=>e.copyPublishUrl&&e.copyPublishUrl(...n))},"复制")])]),_:1},8,["open"])],64)}const Et=_e(Se,[["render",Je],["__scopeId","data-v-fa2d5c5d"]]);export{Et as default};
