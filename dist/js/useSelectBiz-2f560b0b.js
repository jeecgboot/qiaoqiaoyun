var h=(v,e,o)=>new Promise((u,f)=>{var w=c=>{try{t(o.next(c))}catch(i){f(i)}},l=c=>{try{t(o.throw(c))}catch(i){f(i)}},t=c=>c.done?u(c.value):Promise.resolve(c.value).then(w,l);t((o=o.apply(v,e)).next())});import{c as y,f as d,r as M,w as k,u as g}from"./vue-vendor-24c7dc61.js";import{a as D,a6 as O}from"./index-831af9dd.js";function F(v,e){const o=y("selectOptions",d([])),u=y("selectValues",M({value:[],change:!1})),f=y("loadingEcho",d(!1)),w=d([]),l=d([]),t=d([]),c=D();let i=!0;k(u,()=>{if(u.change==!1&&!O(u.value)){let a={isMultiTranslate:"true"};a[e.rowKey]=u.value.join(","),f.value=i,i=!1,m(a,!0).then().finally(()=>{f.value=i})}l.value=u.value},{immediate:!0});function S(a,n){return h(this,null,function*(){if(l.value=a,e.showSelected&&g(l).length!==g(n).length){let{records:s}=yield v({code:g(l).join(","),pageSize:g(l).length});t.value=s}else t.value=n})}const x={type:e.isRadioSelection?"radio":"checkbox",columnWidth:20,selectedRowKeys:l,onChange:S,preserveSelectedRowKeys:!0},C={dataIndex:"index",width:50};function m(a,n){return h(this,null,function*(){let{records:s}=yield v(a);if(w.value=s,n){let r=[];s.forEach(K=>{r.push({label:K[e.labelKey],value:K[e.rowKey]})}),o.value=r}})}function E(){return h(this,null,function*(){let{records:a}=yield v({code:u.value.join(","),pageSize:u.value.length});l.value=u.value,t.value=a})}function b(a){return h(this,null,function*(){a&&e.showSelected&&E()})}function R(a){let n=[],s=[];if(t.value.forEach(r=>{n.push({label:r[e.labelKey],value:r[e.rowKey]})}),l.value.forEach(r=>{s.push(r)}),o.value=n,e.maxSelectCount&&s.length>e.maxSelectCount)return c.createMessage.warning(`最多只能选择${e.maxSelectCount}条数据`),!1;a&&a(n,s)}function j(a){l.value=l.value.filter(n=>n!=a[e.rowKey]),t.value=t.value.filter(n=>n[e.rowKey]!==a[e.rowKey])}function z(){l.value=[],t.value=[]}return[{onSelectChange:S,getDataSource:m,visibleChange:b,selectOptions:o,selectValues:u,rowSelection:x,indexColumnProps:C,checkedKeys:l,selectRows:t,dataSource:w,getSelectResult:R,handleDeleteSelected:j,reset:z}]}export{F as u};
