var y=(n,p,c)=>new Promise((i,v)=>{var _=u=>{try{s(c.next(u))}catch(f){v(f)}},h=u=>{try{s(c.throw(u))}catch(f){v(f)}},s=u=>u.done?i(u.value):Promise.resolve(u.value).then(_,h);s((c=c.apply(n,p)).next())});import{d as R,r as U,f as I,e as G,w as j,a5 as l,V as d,a6 as w,af as A,ai as m,ak as x,k,a7 as L,F as N,am as O,E as S}from"./vue-vendor-24c7dc61.js";import{B as q}from"./index-1c3affea.js";import{a7 as z,j as H,k as F,a as P,l as J}from"./index-831af9dd.js";import{v as K}from"./VipPay.api-469f07f9.js";import"./BasicModal-58413bab.js";import"./antd-vue-vendor-0d72f01e.js";import"./useWindowSizeFn-8f085f6f.js";import"./vxe-table-vendor-8813019a.js";import"./lowAppAuth-3d637b7d.js";import"./lowAppUtils-56892d30.js";const Q=R({name:"MoveGroupSelectModal",components:{BasicModal:q},emits:["register","ok"],setup(n,{emit:p}){const{createMessage:c}=P(),i=U({menuName:"",id:"",appId:"",type:""});function v(){return`移动${i.type==="drag"?"自定义页面":"工作表"}“${i.menuName}”到其他应用`}const _=I(""),h=I(""),s=I([]),u=I([]),f=z(),[M,{closeModal:C}]=H(e=>y(this,null,function*(){Object.keys(i).map(o=>{i[o]=e.menu[o]}),_.value=[],T()})),E=G(()=>{let e=u.value,o=i.appId,t=[];return e&&e.length>0&&(t=e.filter(a=>a.id!=o).map(a=>({label:a.appName,value:a.id}))),t});j(()=>f.getTenant,e=>{e&&B(e)},{immediate:!0});function B(e){return y(this,null,function*(){const o="/online/lowApp/queryList";u.value=[];const t=yield F.get({url:o,params:{tenantId:e}},{isTransformResponse:!1});t.success&&(u.value=t.result.appList),yield K()})}function r(e){return y(this,null,function*(){const o="/online/lowAppMenu/queryMenus",t=yield F.get({url:o,params:{appId:e}});let a=[];t&&t.menuList&&(a=t.menuList.filter(g=>g.type==="group").map(g=>({groupId:g.id,name:g.menuName,checked:!1}))),a.length>0&&(a[0].checked=!0,s.value=a)})}function T(){s.value=[{groupId:"-1",name:"未命名分组",checked:!0}]}function b(e){let o=s.value;for(let t of o)t.checked=!1,t.groupId==e.key&&(t.checked=!0);s.value=o}const D=G(()=>{let e=h.value;return s.value.filter(t=>t.name.indexOf(e)>=0)});function $(){return y(this,null,function*(){let e=_.value;if(!e||e.length==0){c.warning("请选择应用！");return}let o=s.value.filter(V=>V.checked===!0);if(!o||o.length==0){c.warning("请选择分组！");return}let t=o[0].groupId;t==="-1"&&(t="");let a={id:i.id,appId:e,parentId:t};const g="/online/lowAppMenu/moveMenu2App";yield F.put({url:g,params:a}),p("ok",i.id),C()})}return{registerModal:M,getTitle:v,closeModal:C,handleSubmit:$,filterOption:(e,o)=>{var a;return((a=o.children()[0])==null?void 0:a.children.toLowerCase().indexOf(e.toLowerCase()))>=0},selectedAppId:_,appSelectOptions:E,searchGroupName:h,onChangeGroup:b,onChangeApp:r,menuGroupList:s,showGroupList:D}}});const W={style:{"font-size":"17px","font-weight":"700"}},X={style:{padding:"0px 20px 15px 20px"}},Y=l("div",{style:{color:"#757575","font-size":"14px",margin:"16px 0 24px"}}," 工作表下所有视图、记录和工作流都会移动至目标应用下 ",-1),Z={class:""},ee=l("div",null," 选择应用 ",-1),te=l("div",{style:{"margin-top":"18px"}}," 选择分组 ",-1),oe={class:"group-select-div"},ne={style:{height:"300px","overflow-y":"auto"}};function ae(n,p,c,i,v,_){const h=d("a-select-option"),s=d("a-select"),u=d("Icon"),f=d("a-input"),M=d("a-radio"),C=d("a-menu-item"),E=d("a-menu"),B=d("BasicModal");return w(),A(B,{wrapClassName:"low-app-maintain-set-modal",okText:"确认",onOk:n.handleSubmit,onRegister:n.registerModal,width:"600px",destroyOnClose:"",canFullscreen:!1},{title:m(()=>[l("div",W,[l("span",null,x(n.getTitle()),1)])]),default:m(()=>[l("div",X,[Y,l("div",Z,[ee,l("div",null,[k(s,{optionFilterProp:"text","show-search":"","filter-option":n.filterOption,placeholder:"请选择应用",value:n.selectedAppId,"onUpdate:value":p[0]||(p[0]=r=>n.selectedAppId=r),style:{width:"100%"},onChange:n.onChangeApp},{default:m(()=>[(w(!0),L(N,null,O(n.appSelectOptions,r=>(w(),A(h,{value:r.value},{default:m(()=>[S(x(r.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["filter-option","value","onChange"])]),te,l("div",oe,[l("div",null,[k(f,{style:{width:"100%"},placeholder:"搜索",allowClear:"",value:n.searchGroupName,"onUpdate:value":p[1]||(p[1]=r=>n.searchGroupName=r),class:"my-input"},{prefix:m(()=>[k(u,{style:{color:"#9d9d9d"},icon:"ant-design:search-outlined"})]),_:1},8,["value"])]),l("div",ne,[k(E,{onClick:n.onChangeGroup},{default:m(()=>[(w(!0),L(N,null,O(n.showGroupList,r=>(w(),A(C,{key:r.groupId},{default:m(()=>[k(M,{checked:r.checked},{default:m(()=>[S(x(r.name),1)]),_:2},1032,["checked"])]),_:2},1024))),128))]),_:1},8,["onClick"])])])])])]),_:1},8,["onOk","onRegister"])}const ge=J(Q,[["render",ae]]);export{ge as default};
