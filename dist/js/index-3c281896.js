var T=Object.defineProperty,H=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var R=(e,o,n)=>o in e?T(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n,_=(e,o)=>{for(var n in o||(o={}))O.call(o,n)&&R(e,n,o[n]);if(F)for(var n of F(o))U.call(o,n)&&R(e,n,o[n]);return e},V=(e,o)=>H(e,N(o));var P=(e,o,n)=>new Promise((c,r)=>{var u=a=>{try{p(n.next(a))}catch(d){r(d)}},t=a=>{try{p(n.throw(a))}catch(d){r(d)}},p=a=>a.done?c(a.value):Promise.resolve(a.value).then(u,t);p((n=n.apply(e,o)).next())});import{d as z,f as y,e as k,u as J,o as G,n as q,V as m,a6 as K,af as j,ai as C,k as g,ap as x,aq as D,a5 as S,J as $}from"./vue-vendor-24c7dc61.js";import{bF as Q,l as W,K as X}from"./index-831af9dd.js";import"./index-52c8c841.js";import{M as Y,y as Z,l as ee,w as ne}from"./antd-vue-vendor-0d72f01e.js";import{B as oe,u as te}from"./useForm-14b2bc77.js";const ae=z({name:"JPrompt",components:{Modal:Y,Spin:Z,Input:ee,BasicForm:oe,ConfigProvider:ne},emits:["register"],setup(e,{emit:o}){const n=y(),{getAntdLocale:c}=Q(),r=y(!1),u=y(!1),t=y({}),p=k(()=>{var l;return(l=t.value.placeholder)!=null?l:"请输入内容"}),[a,{clearValidate:d,setFieldsValue:s,validate:i,updateSchema:v}]=te({compact:!0,wrapperCol:{span:24},schemas:[{label:"",field:"input",component:"Input",slot:"customInput"}],showActionButtonGroup:!1}),w=k(()=>{var L,B;let l=t.value,f={width:(L=l.width)!=null?L:500,title:(B=l.title)!=null?B:"prompt",open:J(r),confirmLoading:J(u)};return V(_(_(_({},f),e),l),{onOk:I,onCancel(){typeof t.value.onCancel=="function"&&t.value.onCancel(),M()}})});G(()=>{o("register",{openModal:A,setLoading:b,getVisible:r})});function A(l){return P(this,null,function*(){var f,h;document.body.focus(),t.value=l,r.value=!0,yield q(),yield v({field:"input",required:t.value.required,rules:t.value.rules,dynamicRules:t.value.dynamicRules}),yield s({input:(f=t.value.defaultValue)!=null?f:""}),yield d(),(h=n.value)==null||h.focus()})}function M(){r.value=!1}function E(){i()}function I(){return P(this,null,function*(){try{const{onOk:l}=t.value;let f=yield i();b(!0),typeof l=="function"?(yield l(f.input))!==!1&&M():M()}finally{b(!1)}})}function b(l){u.value=l}return{inputRef:n,getProps:w,loading:u,options:t,placeholder:p,getAntdLocale:c,onChange:E,onSubmit:I,registerForm:a}}}),se={style:{padding:"20px"}},le=["innerHTML"];function ie(e,o,n,c,r,u){const t=m("Input"),p=m("BasicForm"),a=m("Spin"),d=m("Modal"),s=m("ConfigProvider");return K(),j(s,{locale:e.getAntdLocale},{default:C(()=>[g(d,x(D(e.getProps)),{default:C(()=>[g(a,{spinning:e.loading},{default:C(()=>[S("div",se,[S("div",{innerHTML:e.options.content,style:{"margin-bottom":"8px"}},null,8,le),g(p,{onRegister:e.registerForm},{customInput:C(({model:i,field:v})=>[g(t,{ref:"inputRef",value:i[v],"onUpdate:value":w=>i[v]=w,placeholder:e.placeholder,onPressEnter:e.onSubmit,onInput:e.onChange},null,8,["value","onUpdate:value","placeholder","onPressEnter","onInput"])]),_:1},8,["onRegister"])])]),_:1},8,["spinning"])]),_:1},16)]),_:1},8,["locale"])}const re=W(ae,[["render",ie]]);function ge(){function e(o){let n=null;const c=document.createElement("div"),r=g(re,{onRegister(s){return P(this,null,function*(){n=s,yield q(),s.openModal(o)})},afterClose(){$(null,c),document.body.removeChild(c)}});$(r,c),document.body.appendChild(c);function u(){return n==null&&X("useJPrompt instance is undefined!"),n}function t(s){var i;(i=u())==null||i.updateModal(s)}function p(){var s;(s=u())==null||s.closeModal()}function a(s){var i;(i=u())==null||i.setLoading(s)}return{closeModal:p,updateModal:t,setLoading:a}}return{createJPrompt:e}}export{ge as u};
