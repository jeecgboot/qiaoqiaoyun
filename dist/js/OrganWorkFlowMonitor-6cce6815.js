var I=Object.defineProperty;var O=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var T=(e,a,n)=>a in e?I(e,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[a]=n,z=(e,a)=>{for(var n in a||(a={}))L.call(a,n)&&T(e,n,a[n]);if(O)for(var n of O(a))G.call(a,n)&&T(e,n,a[n]);return e};var H=(e,a,n)=>new Promise((p,t)=>{var c=s=>{try{f(n.next(s))}catch(i){t(i)}},m=s=>{try{f(n.throw(s))}catch(i){t(i)}},f=s=>s.done?p(s.value):Promise.resolve(s.value).then(c,m);f((n=n.apply(e,a)).next())});import{e as V,f as b,u as $,n as K,w as P,d as N,r as U,h as Q,a6 as A,a7 as B,ae as X,a3 as J,a4 as Z,a5 as o,V as y,ak as x,k as l,ai as u,E as k,W as ee}from"./vue-vendor-24c7dc61.js";import{bG as te,D as oe,ao as ae,aA as ne,p as S,G as se,l as j}from"./index-831af9dd.js";import{v as ie,af as le,aa as ue,a7 as re,$ as ce,a0 as de,am as pe,a3 as me,A as fe,z as _e,C as he,G as Ce,F as ve,x as ge,X as ye,bx as ke,a6 as Fe,ag as De,aj as we,ab as be,a4 as $e,a5 as xe,bv as Y}from"./renderers-81963a7f.js";import{h as Ae,i as q}from"./antd-vue-vendor-0d72f01e.js";import{u as Be}from"./useListPage-62a041ef.js";import{C as Ee,e as Se}from"./organization.api-98a6e46c.js";import{d as Me}from"./organization.data-23f4609c.js";import"./index-621e597c.js";import Re from"./BasicTable-d435f501.js";import"./vxe-table-vendor-8813019a.js";import"./useMethods-f689b480.js";import"./renderUtils-7ad8f436.js";import"./index-b845562c.js";import"./componentMap-c857637c.js";import"./useFormItem-86503382.js";import"./index-1c3affea.js";import"./BasicModal-58413bab.js";import"./useWindowSizeFn-8f085f6f.js";import"./download-1ac6acce.js";import"./index-f99b266a.js";import"./JSelectUser-a44af43a.js";import"./useSelectBiz-2f560b0b.js";import"./props-8a7ac45b.js";import"./JSelectBiz-55a9591f.js";import"./JImageUpload-d644253a.js";import"./JDictSelectTag-54dc3bdb.js";import"./JSelectDept-a90caee3.js";import"./index-f2fd5a28.js";import"./useContextMenu-810f9346.js";import"./areaDataUtil-cdeee717.js";import"./china-area-data-vendor-556d14ee.js";import"./JPopup-2a779923.js";import"./JCheckbox-0b89d32a.js";import"./JSelectUserByDept-bd619076.js";import"./UserSelectByDepModal-db060ece.js";import"./depart.api-339f4da6.js";import"./JUpload-76e119c7.js";import"./index-d508f1f4.js";import"./index-6507b9cd.js";import"./index-4d0525a5.js";import"./UserSelectModal-d78c1490.js";import"./index-52c8c841.js";import"./useForm-14b2bc77.js";import"./helper-22dafba0.js";import"./JAreaLinkage-173780c9.js";import"./JCodeEditor-66bd225e.js";import"./codemirror-17b6f671.js";import"./codemirror-26b29690.js";import"./active-line-512fef49.js";import"./EasyCronInput-b2123242.js";import"./JEditor-249b2194.js";ie([le,ue,re,ce,de,pe,me,fe,_e,he,Ce,ve,ge,ye,ke,Fe,De,we,be,$e,xe]);function Oe(e,a="default"){const{getDarkMode:n}=te(),p=V(()=>a==="default"?n.value:a);let t=null,c=C;const m=b({});let f=()=>{};c=oe(C,200);const s=V(()=>p.value!=="dark"?m.value:z({backgroundColor:"transparent"},m.value));function i(r=a){const d=$(e);if(!d||!$(d))return;t=Y.init(d,r);const{removeEvent:_}=ae({el:window,name:"resize",listener:c});f=_;const{widthRef:h,screenEnum:g}=ne();($(h)<=g.MD||d.offsetHeight===0)&&S(()=>{c()},30)}function F(r,d=!0){var _;if(m.value=r,((_=$(e))==null?void 0:_.offsetHeight)===0){S(()=>{F($(s))},30);return}K(()=>{S(()=>{!t&&(i(p.value),!t)||(d&&(t==null||t.clear()),t==null||t.setOption($(s)))},30)})}function C(){t==null||t.resize()}P(()=>p.value,r=>{t&&(t.dispose(),i(r),F(m.value))}),se(()=>{t&&(f(),t.dispose(),t=null)});function v(){return t||i(p.value),t}return{setOptions:F,resize:C,echarts:Y,getInstance:v}}const Te=N({name:"LineMulti",props:{chartData:{type:Array,default:()=>[],required:!0},option:{type:Object,default:()=>({})},type:{type:String,default:"line"},width:{type:String,default:"100%"},height:{type:String,default:"calc(100vh - 78px)"}},emits:["click"],setup(e,{emit:a}){const n=b(null),{setOptions:p,getInstance:t}=Oe(n),c=U({tooltip:{trigger:"axis",axisPointer:{type:"shadow",label:{show:!0,backgroundColor:"#333"}}},legend:{top:30},grid:{top:60},xAxis:{type:"category",data:[]},yAxis:{type:"value"},series:[]});Q(()=>{e.chartData&&m()});function m(){var C,v;e.option&&Object.assign(c,Ae(e.option));let s=Array.from(new Set(e.chartData.map(r=>r.type))),i=Array.from(new Set(e.chartData.map(r=>r.name))),F=[];s.forEach(r=>{let d={name:r,type:e.type},_=[];i.forEach(h=>{let g=e.chartData.filter(w=>r===w.type&&w.name==h);g&&g.length>0?_.push(g[0].value):_.push(null)}),d.data=_,F.push(d)}),c.series=F,c.xAxis.data=i,p(c),(C=t())==null||C.off("click",f),(v=t())==null||v.on("click",f)}function f(s){a("click",s)}return{chartRef:n}}});function ze(e,a,n,p,t,c){return A(),B("div",{ref:"chartRef",style:X({height:e.height,width:e.width})},null,4)}const He=j(Te,[["render",ze]]),Ve=N({name:"OrganWorkFlowMonitor",components:{LineMulti:He,BasicTable:Re},setup(){const e=b({queuingCount:0,addCount:0,costCount:0}),a=b([{name:"14:40",type:"排队",value:0},{name:"14:40",type:"新增",value:1},{name:"14:40",type:"消费",value:0},{name:"14:45",type:"排队",value:1},{name:"14:45",type:"新增",value:0},{name:"14:45",type:"消费",value:2}]),n=b({}),p=b([{label:"最近1小时",value:"1"},{label:"最近3小时",value:"3"},{label:"最近12小时",value:"12"},{label:"最近24小时",value:"24"}]),{prefixCls:t,tableContext:c}=Be({designScope:"low-app-work-flow",tableProps:{api:Se,bordered:!1,columns:Me,canResize:!1,useSearchForm:!1,showTableSetting:!1,actionColumn:{width:120,fixed:"right"}}}),[m,{reload:f},{rowSelection:s,selectedRowKeys:i,selectedRows:F}]=c,C=b("");function v(E){let R=new Date().getTime(),W=new Date(R-parseInt(E)*60*60*1e3),ft=q(R).format("YYYY-MM-DD HH:mm:ss"),_t=q(W).format("YYYY-MM-DD HH:mm:ss")}function r(){}function d(E){}function _({key:E}){}function h(E){}function g(){}function w(){}M();function M(){return H(this,null,function*(){e.value.queuingCount=yield Ee()})}return{registerTable:m,countData:e,lineMultiData:a,dateClick:v,dateTags:p,searchRangeDate:n,rowSelection:s,toWorkFlowClick:d,nameHandleChange:r,searchNameValue:C,selectedRowKeys:i,suspendClick:_,cancelCostClick:h,requeueClick:g,recoveryClick:w}}});const D=e=>(J("data-v-41eea104"),e=e(),Z(),e),Ye=D(()=>o("div",{class:"real-time"},"实时",-1)),qe={class:"real-time-desc"},Ne={class:"time-box"},je=D(()=>o("div",{class:"box-title"},"当前排队",-1)),We={class:"box-number"},Ie={class:"time-box"},Le=D(()=>o("div",{class:"box-title"},"新增",-1)),Ge={class:"box-number"},Ke=D(()=>o("div",{class:"box-time"},"5分钟内",-1)),Pe={class:"time-box"},Ue=D(()=>o("div",{class:"box-title"},"当前累计排队",-1)),Qe={class:"box-number"},Xe=D(()=>o("div",{class:"box-time"},"5分钟内",-1)),Je={class:"line-multi"},Ze=D(()=>o("div",{class:"history"}," 历史 ",-1)),et={style:{width:"220px"}},tt={style:{"margin-top":"30px"}},ot={class:"history flex-flow"},at={key:0},nt={key:1,style:{"font-size":"14px"}},st=D(()=>o("div",{style:{flex:"1"}},null,-1)),it={style:{width:"220px"},class:"search-name"},lt={style:{"margin-top":"20px"}},ut=["onClick"],rt={class:"icon-name"},ct={class:"flow-name ellipsis"},dt={class:"flow-desc ellipsis"},pt=["onClick"];function mt(e,a,n,p,t,c){const m=y("a-select"),f=y("line-multi"),s=y("a-button"),i=y("a-menu-item"),F=y("a-menu"),C=y("a-dropdown"),v=y("Icon"),r=y("a-tooltip"),d=y("a-input"),_=y("BasicTable");return A(),B("div",null,[Ye,o("div",qe,[o("div",Ne,[je,o("div",We,x(e.countData.queuingCount),1)]),o("div",Ie,[Le,o("div",Ge,x(e.countData.addCount),1),Ke]),o("div",Pe,[Ue,o("div",Qe,x(e.countData.costCount),1),Xe])]),o("div",Je,[Ze,o("div",et,[l(m,{options:e.dateTags,style:{width:"100%"},onChange:e.dateClick},null,8,["options","onChange"])])]),l(f,{chartData:e.lineMultiData,height:"300px",type:"line",option:{legend:{top:"bottom"}}},null,8,["chartData"]),o("div",tt,[o("div",ot,[e.selectedRowKeys.length===0?(A(),B("span",at,"执行详情")):(A(),B("div",nt,[o("span",null,"已选择"+x(e.selectedRowKeys.length)+"条流程",1),l(C,{trigger:["click"]},{overlay:u(()=>[l(F,{onClick:e.suspendClick},{default:u(()=>[l(i,{key:"0"},{default:u(()=>[k("直到手动恢复")]),_:1}),l(i,{key:"1"},{default:u(()=>[k("暂停1小时")]),_:1}),l(i,{key:"2"},{default:u(()=>[k("暂停2小时")]),_:1}),l(i,{key:"3"},{default:u(()=>[k("暂停3小时")]),_:1}),l(i,{key:"4"},{default:u(()=>[k("暂停4小时")]),_:1}),l(i,{key:"5"},{default:u(()=>[k("暂停5小时")]),_:1}),l(i,{key:"6"},{default:u(()=>[k("暂停6小时")]),_:1})]),_:1},8,["onClick"])]),default:u(()=>[l(s,{style:{"margin-left":"16px"}},{default:u(()=>[k("暂停")]),_:1})]),_:1}),l(s,{style:{"margin-left":"16px"},onClick:e.recoveryClick},{default:u(()=>[k("恢复")]),_:1},8,["onClick"]),l(s,{style:{"margin-left":"16px"},onClick:e.requeueClick},{default:u(()=>[k(" 重新排队计数 "),l(r,{title:"将所选流程的排队计数重置为0。长期运行监控时可能偶发计数不准的问题，可通过此操作将计数归0"},{default:u(()=>[l(v,{class:"num-icon",icon:"ant-design:info-circle-outlined"})]),_:1})]),_:1},8,["onClick"])])),st,o("div",it,[l(d,{value:e.searchNameValue,"onUpdate:value":a[0]||(a[0]=h=>e.searchNameValue=h),placeholder:"流程名称",allowClear:"",onChange:e.nameHandleChange},{prefix:u(()=>[l(v,{style:{color:"#9d9d9d"},icon:"ant-design:search-outlined"})]),_:1},8,["value","onChange"])])]),o("div",lt,[l(_,{onRegister:e.registerTable,rowSelection:e.rowSelection},{bodyCell:u(({column:h,text:g,record:w})=>[h.dataIndex==="realname"?(A(),B("div",{key:0,class:"pointer work-flow-name",onClick:M=>e.toWorkFlowClick(w)},[o("div",rt,[l(v,{style:{color:"#FFFFFF"},icon:"ant-design:appstore-outlined"})]),o("div",ct,x(g),1),o("span",dt,x(w.username),1)],8,ut)):ee("",!0)]),action:u(({record:h})=>[o("a",{onClick:g=>e.cancelCostClick(h)},"取消消费",8,pt)]),_:1},8,["onRegister","rowSelection"])])])])}const _o=j(Ve,[["render",mt],["__scopeId","data-v-41eea104"]]);export{_o as default};
