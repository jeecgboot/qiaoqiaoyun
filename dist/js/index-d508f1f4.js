import{d as M,e as p,V as ie,a6 as ce,a7 as ue,a8 as me,k as o,ai as de,O as ge,F as fe,am as ve,af as pe,ap as he,ag as _e,ao as we,r as U,f as D,u as m,h as B,E as V,J as z}from"./vue-vendor-24c7dc61.js";import{ay as P,av as j,aF as H,aG as J}from"./antd-vue-vendor-0d72f01e.js";import{H as q,h as K,O as Q,l as xe,aU as Z}from"./index-831af9dd.js";const Se=M({name:"ImagePreview",components:{Image:P,PreviewGroup:P.PreviewGroup},props:{functional:q.bool,imageList:{type:Array}},setup(n){const{prefixCls:u}=K("image-preview"),c=p(()=>{const{imageList:i}=n;return i?i.map(t=>Q(t)?{src:t,placeholder:!1}:t):[]});return{prefixCls:u,getImageList:c}}});const ee="/assets/resume-6e209205.svg",te="/assets/p-rotate-1d232189.svg",ne="/assets/scale-8d8ebde4.svg",se="/assets/unscale-99ad049c.svg",oe="/assets/unrotate-f9dd5a27.svg";var d=function(n){return n[n.LOADING=0]="LOADING",n[n.DONE=1]="DONE",n[n.FAIL=2]="FAIL",n}(d||{});const ae={show:{type:Boolean,default:!1},imageList:{type:[Array],default:null},index:{type:Number,default:0},scaleStep:{type:Number},defaultWidth:{type:Number},maskClosable:{type:Boolean},rememberState:{type:Boolean}},a="img-preview",le=M({name:"ImagePreview",props:ae,emits:["img-load","img-error"],setup(n,{expose:u,emit:c}){const i=new Map,t=U({currentUrl:"",imgScale:1,imgRotate:0,imgTop:0,imgLeft:0,status:d.LOADING,currentIndex:0,moveX:0,moveY:0,show:n.show}),x=D(null),h=D(null);function N(){R();const{index:e,imageList:s}=n;if(!s||!s.length)throw new Error("imageList is undefined");t.currentIndex=e,C(s[e])}function _(){t.imgScale=1,t.imgRotate=0,t.imgTop=0,t.imgLeft=0}function R(){const e=m(x);e&&(e.onmousewheel=w,document.body.addEventListener("DOMMouseScroll",w),document.ondragstart=function(){return!1})}const f=p(()=>{var s;const e=(s=n==null?void 0:n.scaleStep)!=null?s:0;return(e!=null?e:0>0&&e<100)?e/100:t.imgScale/10});function w(e){e=e||window.event,e.delta=e.wheelDelta||-e.detail,e.preventDefault(),e.delta>0&&v(f.value),e.delta<0&&v(-f.value)}function v(e){t.imgScale<=.2&&e<0||(t.imgScale+=e)}function S(e){t.imgRotate+=e}function A(){const e=m(h);e&&(e.onmousemove=null)}function C(e){t.status=d.LOADING;const s=new Image;s.src=e,s.onload=l=>{if(t.currentUrl!==e){const r=l.composedPath();if(n.rememberState){i.set(t.currentUrl,{scale:t.imgScale,top:t.imgTop,left:t.imgLeft,rotate:t.imgRotate});const g=i.get(e);g?(t.imgScale=g.scale,t.imgTop=g.top,t.imgRotate=g.rotate,t.imgLeft=g.left):(_(),n.defaultWidth&&(t.imgScale=n.defaultWidth/r[0].naturalWidth))}else n.defaultWidth&&(t.imgScale=n.defaultWidth/r[0].naturalWidth);r&&c("img-load",{index:t.currentIndex,dom:r[0],url:e})}t.currentUrl=e,t.status=d.DONE},s.onerror=l=>{const r=l.composedPath();r&&c("img-error",{index:t.currentIndex,dom:r[0],url:e}),t.status=d.FAIL}}function y(e){e&&e.stopPropagation(),$()}function $(){t.show=!1,document.body.removeEventListener("DOMMouseScroll",w),document.ondragstart=null}function k(){_()}u({resume:k,close:$,prev:I.bind(null,"left"),next:I.bind(null,"right"),setScale:e=>{e>0&&e<=10&&(t.imgScale=e)},setRotate:e=>{t.imgRotate=e}});function I(e){const{currentIndex:s}=t,{imageList:l}=n;e==="left"&&(t.currentIndex--,s<=0&&(t.currentIndex=l.length-1)),e==="right"&&(t.currentIndex++,s>=l.length-1&&(t.currentIndex=0)),C(l[t.currentIndex])}function E(e){e=e||window.event,t.moveX=e.clientX,t.moveY=e.clientY;const s=m(h);s&&(s.onmousemove=F)}function F(e){e=e||window.event,e.preventDefault();const s=e.clientX-t.moveX,l=e.clientY-t.moveY;t.imgLeft+=s,t.imgTop+=l,t.moveX=e.clientX,t.moveY=e.clientY}const W=p(()=>{const{imgScale:e,imgRotate:s,imgTop:l,imgLeft:r}=t;return{transform:`scale(${e}) rotate(${s}deg)`,marginTop:`${l}px`,marginLeft:`${r}px`,maxWidth:n.defaultWidth?"unset":"100%"}}),O=p(()=>{const{imageList:e}=n;return e.length>1});B(()=>{n.show&&N(),n.imageList&&_()});const G=e=>{n.maskClosable&&e.target&&e.target.classList.contains(`${a}-content`)&&y(e)},T=()=>o("div",{class:`${a}__close`,onClick:y},[o(j,{class:`${a}__close-icon`},null)]),X=()=>{if(!m(O))return null;const{currentIndex:e}=t,{imageList:s}=n;return o("div",{class:`${a}__index`},[e+1,V(" / "),s.length])},Y=()=>o("div",{class:`${a}__controller`},[o("div",{class:`${a}__controller-item`,onClick:()=>v(-f.value)},[o("img",{src:se},null)]),o("div",{class:`${a}__controller-item`,onClick:()=>v(f.value)},[o("img",{src:ne},null)]),o("div",{class:`${a}__controller-item`,onClick:k},[o("img",{src:ee},null)]),o("div",{class:`${a}__controller-item`,onClick:()=>S(-90)},[o("img",{src:oe},null)]),o("div",{class:`${a}__controller-item`,onClick:()=>S(90)},[o("img",{src:te},null)])]),b=e=>m(O)?o("div",{class:[`${a}__arrow`,e],onClick:()=>I(e)},[e==="left"?o(H,null,null):o(J,null,null)]):null;return()=>t.show&&o("div",{class:a,ref:x,onMouseup:A,onClick:G},[o("div",{class:`${a}-content`},[o("img",{style:m(W),class:[`${a}-image`,t.status===d.DONE?"":"hidden"],ref:h,src:t.currentUrl,onMousedown:E},null),T(),X(),Y(),b("left"),b("right")])])}});let L=null;function Ce(n){var i;if(!Z)return;const u={},c=document.createElement("div");return Object.assign(u,{show:!0,index:0,scaleStep:100},n),L=o(le,u),z(L,c),document.body.appendChild(c),(i=L.component)==null?void 0:i.exposed}export{Ce as c};
