var C=(e,i,r)=>new Promise((d,l)=>{var p=a=>{try{s(r.next(a))}catch(c){l(c)}},t=a=>{try{s(r.throw(a))}catch(c){l(c)}},s=a=>a.done?d(a.value):Promise.resolve(a.value).then(p,t);s((r=r.apply(e,i)).next())});import{Z as w,H as O,h as B,a7 as N,bZ as q,ap as H,a as Z,_ as v,o as W,aZ as z,c9 as G,ca as y,aI as K,r as I,l as Y}from"./index-831af9dd.js";import{D as j,q as M}from"./antd-vue-vendor-0d72f01e.js";import{d as J,e as S,f as A,V as u,a6 as U,a7 as P,F as x,k as o,ai as D,W as Q,a5 as f,a8 as _,ak as X}from"./vue-vendor-24c7dc61.js";import{S as ee}from"./siteSetting-107c927d.js";import{u as oe}from"./useHeaderSetting-7889be2c.js";import{h as $}from"./header-55b09394.js";import{r as te,q as ae}from"./dict.api-46b89253.js";import{u as se}from"./index-5f7e4a11.js";import{i as ne}from"./lowAppStore-499fb8f9.js";import"./vxe-table-vendor-8813019a.js";import"./low.app.api-97fc250a.js";import"./index-a964241b.js";const{createMessage:b}=Z(),re=J({name:"UserDropdown",components:{Dropdown:j,Menu:M,MenuItem:w(()=>v(()=>import("./DropMenuItem-28d740e0.js"),["js/DropMenuItem-28d740e0.js","js/antd-vue-vendor-0d72f01e.js","js/vue-vendor-24c7dc61.js","js/index-831af9dd.js","js/vxe-table-vendor-8813019a.js","assets/index-3d0fbd8d.css"])),MenuDivider:M.Divider,DepartSelect:w(()=>v(()=>import("./DepartSelect-3871e019.js"),["js/DepartSelect-3871e019.js","js/vue-vendor-24c7dc61.js","js/index-1c3affea.js","js/index-831af9dd.js","js/antd-vue-vendor-0d72f01e.js","js/vxe-table-vendor-8813019a.js","assets/index-3d0fbd8d.css","js/BasicModal-58413bab.js","js/useWindowSizeFn-8f085f6f.js","assets/BasicModal-d929f5ce.css","assets/index-ad7edbf1.css","js/depart.api-339f4da6.js","assets/DepartSelect-b535c919.css"])),UpdatePassword:w(()=>v(()=>import("./UpdatePassword-d50ab54c.js"),["js/UpdatePassword-d50ab54c.js","js/vue-vendor-24c7dc61.js","js/validator-bc7dc032.js","js/index-831af9dd.js","js/antd-vue-vendor-0d72f01e.js","js/vxe-table-vendor-8813019a.js","assets/index-3d0fbd8d.css","js/user.api-ffaaa05b.js","js/index-1c3affea.js","js/BasicModal-58413bab.js","js/useWindowSizeFn-8f085f6f.js","assets/BasicModal-d929f5ce.css","assets/index-ad7edbf1.css","js/useForm-14b2bc77.js","js/componentMap-c857637c.js","js/useFormItem-86503382.js","js/download-1ac6acce.js","js/index-f99b266a.js","assets/index-15cc10f8.css","js/JSelectUser-a44af43a.js","js/useSelectBiz-2f560b0b.js","js/props-8a7ac45b.js","js/JSelectBiz-55a9591f.js","assets/JSelectBiz-ba37f0a8.css","assets/JSelectUser-7fda8076.css","js/JImageUpload-d644253a.js","assets/JImageUpload-d7ba7f20.css","js/JDictSelectTag-54dc3bdb.js","assets/JDictSelectTag-72919d86.css","js/JSelectDept-a90caee3.js","js/index-f2fd5a28.js","js/useContextMenu-810f9346.js","assets/useContextMenu-aed8cfe5.css","assets/index-a95e0833.css","assets/JSelectDept-2ce3f5d2.css","js/areaDataUtil-cdeee717.js","js/china-area-data-vendor-556d14ee.js","js/JPopup-2a779923.js","js/useMethods-f689b480.js","assets/JPopup-2f2ed00d.css","js/JCheckbox-0b89d32a.js","assets/JCheckbox-ce9c44dd.css","js/JSelectUserByDept-bd619076.js","js/UserSelectByDepModal-db060ece.js","js/depart.api-339f4da6.js","assets/JSelectUserByDept-f5671717.css","js/JUpload-76e119c7.js","js/index-d508f1f4.js","assets/index-27837f17.css","assets/JUpload-557f03ea.css","js/index-6507b9cd.js","js/index-4d0525a5.js","js/UserSelectModal-d78c1490.js","assets/UserSelectModal-aaef1bbb.css","assets/index-89763e09.css","assets/componentMap-2e742ecf.css","js/helper-22dafba0.js","assets/useForm-9101c3b7.css"]))},props:{theme:O.oneOf(["dark","light"])},setup(){const{devMode:e,lowStore:i}=se(),{prefixCls:r}=B("header-user-dropdown"),{t:d}=W(),{getShowDoc:l,getUseLockPage:p}=oe(),t=N(),s=q(),a=S(()=>{const{realname:n="",avatar:h,desc:V}=t.getUserInfo||{};return{realname:n,avatar:h||$,desc:V}}),c=S(()=>{let{avatar:n}=a.value;return n==$?n:H(n)}),m=A();function g(){t.confirmLoginOut()}function E(){z(ee)}function R(){return C(this,null,function*(){if((yield te()).success){const h=yield ae();G(y),K(y,h.result),b.success("刷新缓存完成！")}else b.error("刷新缓存失败！")})}function F(){m.value.show()}const k=A();function L(){k.value.show(t.getUserInfo.username)}function T(n){switch(n.key){case"logout":g();break;case"doc":E();break;case"cache":R();break;case"depart":F();break;case"password":L();break;case"account":s("/page-demo/account/setting");break;case"toggle-dev-mode":i.setDevMode(!e.value),!e.value&&ne(I.currentRoute.value.name)&&I.replace({name:"low-app-@appId-redirect"});break}}return{prefixCls:r,t:d,getUserInfo:a,getAvatarUrl:c,handleMenuClick:T,getShowDoc:l,getUseLockPage:p,loginSelectRef:m,updatePasswordRef:k,devMode:e}}});const ce=["src"];function ue(e,i,r,d,l,p){const t=u("MenuItem"),s=u("MenuDivider"),a=u("Menu"),c=u("Dropdown"),m=u("DepartSelect"),g=u("UpdatePassword");return U(),P(x,null,[o(c,{placement:"bottomLeft",overlayClassName:`${e.prefixCls}-dropdown-overlay`},{overlay:D(()=>[o(a,{onClick:e.handleMenuClick},{default:D(()=>[e.getShowDoc?(U(),P(x,{key:0},[o(t,{key:"doc",text:e.t("layout.header.dropdownItemDoc"),icon:"ion:document-text-outline"},null,8,["text"]),o(s)],64)):Q("",!0),o(t,{key:"toggle-dev-mode",text:`${e.devMode?"关闭":"开启"}编辑`,icon:"ant-design:form"},null,8,["text"]),o(s),o(t,{key:"depart",text:e.t("layout.header.dropdownItemSwitchDepart"),icon:"ant-design:cluster-outlined"},null,8,["text"]),o(t,{key:"password",text:e.t("layout.header.dropdownItemSwitchPassword"),icon:"ant-design:edit-outlined"},null,8,["text"]),o(t,{key:"cache",text:e.t("layout.header.dropdownItemRefreshCache"),icon:"ion:sync-outline"},null,8,["text"]),o(s),o(t,{key:"logout",text:"退出登录",icon:"ion:power-outline"})]),_:1},8,["onClick"])]),default:D(()=>[f("span",{class:_([[e.prefixCls,`${e.prefixCls}--${e.theme}`],"flex"])},[f("img",{class:_(`${e.prefixCls}__header`),src:e.getAvatarUrl},null,10,ce),f("span",{class:_(`${e.prefixCls}__info hidden md:block`)},[f("span",{class:_([`${e.prefixCls}__name  `,"truncate"])},X(e.getUserInfo.realname),3)],2)],2)]),_:1},8,["overlayClassName"]),o(m,{ref:"loginSelectRef"},null,512),o(g,{ref:"updatePasswordRef"},null,512)],64)}const Ce=Y(re,[["render",ue]]);export{Ce as default};
