var v=(t,n,o)=>new Promise((s,u)=>{var l=e=>{try{a(o.next(e))}catch(c){u(c)}},r=e=>{try{a(o.throw(e))}catch(c){u(c)}},a=e=>e.done?s(e.value):Promise.resolve(e.value).then(l,r);a((o=o.apply(t,n)).next())});import{G as F,o as z,z as k,l as g,h as A,w as S}from"./index-831af9dd.js";import{f,u as d,d as w,e as y,h as I,V as p,a6 as _,af as $,ag as B,ai as m,E as T,ak as N,g as O,r as j,a9 as D,n as C,I as E,ao as P,k as R,am as V,O as q,ap as x,aq as G}from"./vue-vendor-24c7dc61.js";import{B as L,a8 as U,am as H}from"./antd-vue-vendor-0d72f01e.js";function J(t){const n=f(t),o=f(!1);let s;function u(){s&&window.clearInterval(s)}function l(){o.value=!1,u(),s=null}function r(){d(o)||s||(o.value=!0,s=setInterval(()=>{d(n)===1?(l(),n.value=t):n.value-=1},1e3))}function a(){n.value=t,l()}function e(){a(),r()}return F(()=>{a()}),{start:r,reset:a,restart:e,clear:u,stop:l,currentCount:n,isStart:o}}const K={value:{type:[Object,Number,String,Array]},count:{type:Number,default:60},beforeStartFunc:{type:Function,default:null}},M=w({name:"CountButton",components:{Button:L},props:K,setup(t){const n=f(!1),{currentCount:o,isStart:s,start:u,reset:l}=J(t.count),{t:r}=z(),a=y(()=>d(s)?r("component.countdown.sendText",[d(o)]):r("component.countdown.normalText"));I(()=>{t.value===void 0&&l()});function e(){return v(this,null,function*(){const{beforeStartFunc:c}=t;if(c&&k(c)){n.value=!0;try{(yield c())&&u()}finally{n.value=!1}}else u()})}return{handleStart:e,currentCount:o,loading:n,getButtonText:a,isStart:s}}});function Q(t,n,o,s,u,l){const r=p("Button");return _(),$(r,B(t.$attrs,{disabled:t.isStart,onClick:t.handleStart,loading:t.loading}),{default:m(()=>[T(N(t.getButtonText),1)]),_:1},16,["disabled","onClick","loading"])}const h=g(M,[["render",Q]]);function W(t,n="value",o="change",s){const u=O(),l=u==null?void 0:u.emit,r=U.useInjectFormItemContext(),a=j({value:t[n]}),e=D(a),c=i=>{a.value=i};return I(()=>{a.value=t[n]}),[y({get(){return a.value==null?"":a.value},set(i){H(i,e.value)||(a.value=i,C(()=>{l==null||l(o,i,...E(d(s))||[]),C(()=>r.onFieldChange())}))}}),c,e,r]}const X={value:{type:String},size:{type:String,validator:t=>["default","large","small"].includes(t)},count:{type:Number,default:60},sendCodeApi:{type:Function,default:null}},Y=w({name:"CountDownInput",components:{CountButton:h},inheritAttrs:!1,props:X,setup(t){const{prefixCls:n}=A("countdown-input"),[o]=W(t);return{prefixCls:n,state:o}}});function Z(t,n,o,s,u,l){const r=p("CountButton"),a=p("a-input");return _(),$(a,B(t.$attrs,{class:t.prefixCls,size:t.size,value:t.state}),P({addonAfter:m(()=>[R(r,{size:t.size,count:t.count,value:t.state,beforeStartFunc:t.sendCodeApi},null,8,["size","count","value","beforeStartFunc"])]),_:2},[V(Object.keys(t.$slots).filter(e=>e!=="addonAfter"),e=>({name:e,fn:m(c=>[q(t.$slots,e,x(G(c||{})))])}))]),1040,["class","size","value"])}const tt=g(Y,[["render",Z]]),st=S(tt),ut=S(h);export{st as C};
