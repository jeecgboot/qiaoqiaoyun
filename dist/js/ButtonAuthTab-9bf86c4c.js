var R=Object.defineProperty,v=Object.defineProperties;var w=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;var b=(t,e,o)=>e in t?R(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,A=(t,e)=>{for(var o in e||(e={}))M.call(e,o)&&b(t,o,e[o]);if(g)for(var o of g(e))k.call(e,o)&&b(t,o,e[o]);return t},S=(t,e)=>v(t,w(e));var T=(t,e,o)=>new Promise((c,m)=>{var u=i=>{try{r(o.next(i))}catch(n){m(n)}},l=i=>{try{r(o.throw(i))}catch(n){m(n)}},r=i=>i.done?c(i.value):Promise.resolve(i.value).then(u,l);r((o=o.apply(t,e)).next())});import{d as B,w as F,V as d,a6 as U,a7 as V,F as $,k as f,ai as _}from"./vue-vendor-24c7dc61.js";import{p as y}from"./antd-vue-vendor-0d72f01e.js";import{H as C,e as D,l as z}from"./index-831af9dd.js";import"./index-1c3affea.js";import"./index-621e597c.js";import{u as I}from"./useListPage-62a041ef.js";import{buttonAuth as P}from"./auth.data-0f6cd267.js";import{b as h}from"./auth.api-15f2ddd8.js";import{u as q}from"./useDesformAuth-fbf3ee83.js";import x from"./DataAuthModal-e287ce29.js";import E from"./SettingAuthModal-8ccbd5e1.js";import H from"./BasicTable-d435f501.js";import{T as L}from"./componentMap-c857637c.js";import"./vxe-table-vendor-8813019a.js";import"./BasicModal-58413bab.js";import"./useWindowSizeFn-8f085f6f.js";import"./useMethods-f689b480.js";import"./desformUtils-c7daaa89.js";import"./index-52c8c841.js";import"./useForm-14b2bc77.js";import"./helper-22dafba0.js";import"./JAreaLinkage-173780c9.js";import"./areaDataUtil-cdeee717.js";import"./china-area-data-vendor-556d14ee.js";import"./useFormItem-86503382.js";import"./JSelectUser-a44af43a.js";import"./useSelectBiz-2f560b0b.js";import"./props-8a7ac45b.js";import"./JSelectBiz-55a9591f.js";import"./JSelectDept-a90caee3.js";import"./index-f2fd5a28.js";import"./useContextMenu-810f9346.js";import"./JCodeEditor-66bd225e.js";import"./codemirror-17b6f671.js";import"./codemirror-26b29690.js";import"./active-line-512fef49.js";import"./JPopup-2a779923.js";import"./EasyCronInput-b2123242.js";import"./JCheckbox-0b89d32a.js";import"./JDictSelectTag-54dc3bdb.js";import"./JSelectUserByDept-bd619076.js";import"./UserSelectByDepModal-db060ece.js";import"./depart.api-339f4da6.js";import"./JEditor-249b2194.js";import"./index-b845562c.js";import"./JImageUpload-d644253a.js";import"./download-1ac6acce.js";import"./index-f99b266a.js";import"./JUpload-76e119c7.js";import"./index-d508f1f4.js";import"./index-6507b9cd.js";import"./index-4d0525a5.js";import"./UserSelectModal-d78c1490.js";const N=B({name:"ButtonAuthTab",components:{BasicTable:H,TableAction:L,DataAuthModal:x,SettingAuthModal:E},props:{visible:C.bool.def(!1),desformRecord:C.any.isRequired},setup(t){const e=I({tableProps:{immediate:!1,api:a=>{var p;return h.list(a,(p=t.desformRecord)==null?void 0:p.desformCode)},columns:P.columns,showTableSetting:!1,tableSetting:{setting:!1,size:!1},useSearchForm:!1,pagination:!1,actionColumn:{width:80}}}),{tableContext:o}=e,[c,{reload:m},{}]=o,[u,l]=D(),{doUpdateStatus:r}=q(t);F(()=>t.visible,()=>{t.visible&&t.desformRecord&&m()},{immediate:!0});function i(Kt){return T(this,arguments,function*({formData:a,resolve:p}){p(yield h.saveOrUpdate(S(A({},y(a,"id","authField","authScopeIsAll","authScopeDepartsVal","authScopeUsersVal","authScopeRolesVal")),{desformId:t.desformRecord.id,desformCode:t.desformRecord.desformCode}),!0)),m()})}function n(a){r(p=>h.updateStatus(p),a,{authField:a.authField})}function s(a){return[{label:"授权",onClick:()=>l.openModal(!0,{record:a})}]}return{registerTable:c,registerSettingAuthModal:u,getTableAction:s,onAuthSave:i,onUpdateStatus:n}}});function O(t,e,o,c,m,u){const l=d("a-switch"),r=d("TableAction"),i=d("BasicTable"),n=d("SettingAuthModal");return U(),V($,null,[f(i,{onRegister:t.registerTable},{switch:_(({record:s})=>[f(l,{size:"small",loading:s.loading,checked:s.status===1,onChange:a=>t.onUpdateStatus(s)},null,8,["loading","checked","onChange"])]),action:_(({record:s})=>[f(r,{actions:t.getTableAction(s)},null,8,["actions"])]),_:1},8,["onRegister"]),f(n,{onRegister:t.registerSettingAuthModal,onSave:t.onAuthSave},null,8,["onRegister","onSave"])],64)}const jt=z(N,[["render",O]]);export{jt as default};
