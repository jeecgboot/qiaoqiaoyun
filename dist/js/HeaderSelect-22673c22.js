var C=(e,o,c)=>new Promise((d,l)=>{var g=n=>{try{t(c.next(n))}catch(u){l(u)}},r=n=>{try{t(c.throw(n))}catch(u){l(u)}},t=n=>n.done?d(n.value):Promise.resolve(n.value).then(g,r);t((c=c.apply(e,o)).next())});import{d as U,f as h,e as V,w as $,a3 as ae,a4 as te,V as p,a6 as y,a7 as k,F as I,k as _,ai as v,am as j,af as A,a8 as z,a5 as b,ak as L,W as F,z as E}from"./vue-vendor-24c7dc61.js";import{aC as P,bO as W}from"./antd-vue-vendor-0d72f01e.js";import{a7 as q,k as H,c as x,a as G,l as J}from"./index-831af9dd.js";import K from"./AppTenant-d4e148c1.js";import"./vxe-table-vendor-8813019a.js";import"./AppLoginHeader-c75d2fdd.js";const Q=U({name:"HeaderSelect",components:{PlusOutlined:P,DownOutlined:W,AppTenant:K},emits:["loaded"],setup(e,{emit:o}){const c=h(!1),d=h([]),l=h(""),g=q(),r=h(!1),t=h("");function n(){return C(this,null,function*(){const a="/sys/tenant/getCurrentUserTenant",i=yield H.get({url:a});let m=!0,f=[];if(i&&i.list)for(let T of i.list)f.push({value:T.id,label:T.name});let D=x();if(!D&&f.length>0){let T=f[0].value;l.value=T,g.setTenant(T)}else l.value=D;f.length==0&&(m=!1),o("loaded",m),f.push({value:""}),d.value=f})}n();function u(a){}const{createMessage:w}=G();function O(a){return C(this,null,function*(){const i="/sys/user/changeLoginTenantId",m=yield H.put({url:i,params:{loginTenantId:a}});m&&!m.success&&w.warn(m.message)})}function S(){r.value=!0,t.value="create"}function s(){r.value=!0,t.value="join"}function M(a){return a.value===l.value?"active":""}const N=V(()=>{let a=d.value.filter(i=>i.value===l.value);return a&&a.length>0?a[0].label:""});function B(){r.value=!1,t.value==="join"?t.value="":(t.value="",location.reload())}return $(()=>g.getTenant,a=>{a&&setTimeout(()=>{l.value=Number(a)},300)},{immediate:!0}),{visible:c,currentTenantId:l,selectedText:N,selectList:d,handleMenuClick:u,joinDepart:s,createDepart:S,getItemClass:M,createOrganShow:r,tenantType:t,handleTenantSuccess:B}}});const R={class:"label"},X={class:"tenant-label"};function Y(e,o,c,d,l,g){const r=p("DownOutlined"),t=p("a-tooltip"),n=p("a-menu-item"),u=p("a-menu"),w=p("a-dropdown"),O=p("AppTenant"),S=p("a-modal");return y(),k(I,null,[_(w,{open:e.visible,"onUpdate:open":o[1]||(o[1]=s=>e.visible=s),trigger:["click"],overlayClassName:"app-index-header-dropdown"},{overlay:v(()=>[_(u,{onClick:e.handleMenuClick},{default:v(()=>[(y(!0),k(I,null,j(e.selectList,s=>(y(),k(I,null,[s.value?(y(),A(n,{class:z(e.getItemClass(s)),key:s.value},{default:v(()=>[_(t,{title:s.label,placement:"right"},{default:v(()=>[b("span",X,L(s.label),1)]),_:2},1032,["title"])]),_:2},1032,["class"])):F("",!0)],64))),256))]),_:1},8,["onClick"])]),default:v(()=>[b("div",{onClick:o[0]||(o[0]=E(()=>{},["prevent"])),class:"app-index-header"},[b("span",R,L(e.selectedText),1),_(r,{style:{color:"rgb(157, 157, 157)"}})])]),_:1},8,["open"]),_(S,{open:e.createOrganShow,"onUpdate:open":o[2]||(o[2]=s=>e.createOrganShow=s),footer:null,destroyOnClose:""},{default:v(()=>[_(O,{tenantType:e.tenantType,onSuccess:e.handleTenantSuccess},null,8,["tenantType","onSuccess"])]),_:1},8,["open"])],64)}const ce=J(Q,[["render",Y],["__scopeId","data-v-389aa2c9"]]);export{ce as default};
