var O=(t,y,p)=>new Promise((u,S)=>{var o=i=>{try{f(p.next(i))}catch(h){S(h)}},k=i=>{try{f(p.throw(i))}catch(h){S(h)}},f=i=>i.done?u(i.value):Promise.resolve(i.value).then(o,k);f((p=p.apply(t,y)).next())});import{c8 as V,h as K,am as P}from"./antd-vue-vendor-0d72f01e.js";import{d as W,f as w,e as D,a3 as q,a4 as U,a5 as n,V as m,a6 as c,af as M,ai as v,k as B,ak as _,a7 as g,F as I,am as $,a8 as j,ae as L}from"./vue-vendor-24c7dc61.js";import{B as G}from"./index-1c3affea.js";import J from"./HeaderTag-d6c7596f.js";import{j as Q,l as X}from"./index-831af9dd.js";import"./BasicModal-58413bab.js";import"./useWindowSizeFn-8f085f6f.js";import"./vxe-table-vendor-8813019a.js";const Y=W({name:"ImportContentModal",components:{BasicModal:G,CloudUploadOutlined:V,HeaderTag:J},emits:["register","success","next"],setup(t,{emit:y}){const p=w(""),u=w([]),S=w(""),o=w([]),[k,{closeModal:f}]=Q(a=>O(this,null,function*(){p.value=a.fileKey,u.value=a.sheetList,S.value=a.fileName,o.value=[a.sheetList[0].sheetName]})),i=D(()=>o.value[0]),h=D(()=>{let a=o.value[0],l=u.value.filter(e=>e.sheetName==a);if(l&&l.length>0){let e=l[0].titleRow;return e||(e=1),e}return""}),E=D(()=>{let a=o.value[0],l=u.value.filter(e=>e.sheetName==a);if(l&&l.length>0){let e=l[0].sheetData;if(e[0])return`共${e[0].length}列有效`}return""}),N=w(0),F=D(()=>{if(o.value.length==0)return[];const a=o.value.flatMap((l,e)=>{var C;const s=u.value.filter(b=>b.sheetName==l);return s&&s.length>0?Object.values(K((C=s[0].sheetData)!=null?C:{})).filter((b,x)=>{if(e>0){if(x===0)return!1;b.isSub=!0}return!0}):[]});if(a&&a.length>0){let l=[];for(let e=0;e<10;e++){let s=a[e];s||(s=a[e+""]),s&&(N.value=s.length*130+70,l.push(s))}return l}return[]});function r(a,l){if(l)return;let e=o.value[0],s=u.value.filter(C=>C.sheetName==e);s&&s.length>0&&(s[0].titleRow=a+1),o.value=[e]}function d(a){return h.value==a+1?{display:"block !important"}:{}}function T(a){return h.value==a+1?{display:"none !important"}:{}}function z(a){o.value=a}function A(a){var b;const l=u.value.find(x=>i.value==x.sheetName);if(!l)return!1;const e=(b=l.titleRow)!=null?b:1,s=l.sheetData[e-1],C=a.sheetData[e-1];return!P(s,C)}function H(){let a=o.value[0],l=u.value.filter(e=>e.sheetName==a);if(l&&l.length>0){let e=l[0].titleRow;e||(e=1);let s=l[0].sheetData[e-1];y("next",s,o.value.join(":"))}}return{registerModal:k,closeModal:f,next:H,fileKey:p,sheetList:u,fileName:S,activeSheet:i,activeSheets:o,activeSheetTitleRow:h,activeSheetColumn:E,activeSheetData:F,onCheckSheet:z,onChangeActiveTitle:r,isDisableSheet:A,showTagStyle:d,notShowTagStyle:T,tableWidth:N}}});const R=t=>(q("data-v-2fe0de01"),t=t(),U(),t),Z={style:{display:"flex","flex-direction":"column"}},ee={style:{"font-size":"15px","font-weight":"bold"},class:"ellipsis"},te={style:{flex:"1",display:"flex","flex-direction":"column","margin-top":"5px"}},ae=R(()=>n("span",{style:{color:"#9e9e9e","margin-right":"10px"}},"选择表头:",-1)),le=R(()=>n("span",null,"第",-1)),se=R(()=>n("span",null,"行",-1)),ne={style:{color:"#1e88e5","margin-left":"8px"}},oe={class:"excel-data"},ie=R(()=>n("div",null,null,-1)),re={style:{width:"70px !important"}},ue=["onClick"],ce={key:1,style:{"margin-left":"-10px"}},he={class:"content"};function pe(t,y,p,u,S,o){const k=m("a-checkbox"),f=m("a-checkbox-group"),i=m("a-col"),h=m("a-empty"),E=m("HeaderTag"),N=m("a-row"),F=m("BasicModal");return c(),M(F,{height:500,title:"导入数据 - 选择内容（2/3）",onRegister:t.registerModal,width:960,canFullscreen:!1,destroyOnClose:"",closable:"",okText:"下一步",okButtonProps:{disabled:t.activeSheets.length==0},onOk:y[0]||(y[0]=r=>t.next())},{default:v(()=>[B(N,null,{default:v(()=>[B(i,{span:8},{default:v(()=>[n("div",Z,[n("div",ee,_(t.fileName),1),n("div",te,[B(f,{value:t.activeSheets,onChange:t.onCheckSheet,style:{width:"100%"}},{default:v(()=>[(c(!0),g(I,null,$(t.sheetList,r=>(c(),g("div",{class:j(["sheet-name-item",r.sheetName==t.activeSheet?"active":""])},[B(k,{value:r.sheetName,disabled:t.isDisableSheet(r)},{default:v(()=>[n("span",null,_(r.sheetName),1)]),_:2},1032,["value","disabled"])],2))),256))]),_:1},8,["value","onChange"])])])]),_:1}),t.activeSheets.length==0?(c(),M(i,{key:0,span:16},{default:v(()=>[B(h,{description:"请至少选择一个Sheet",style:{"margin-top":"50px"}})]),_:1})):(c(),M(i,{key:1,span:16},{default:v(()=>[n("div",null,[ae,le,n("span",null,_(t.activeSheetTitleRow),1),se,n("span",ne,_(t.activeSheetColumn),1)]),n("div",oe,[ie,n("table",{cellspacing:"0",cellpadding:"0",style:L({"border-collapse":"collapse","margin-top":"5px",width:t.tableWidth+"px"})},[n("tbody",null,[(c(!0),g(I,null,$(t.activeSheetData,(r,d)=>(c(),g("tr",{class:j([{"is-sub":r.isSub}])},[n("td",re,[n("span",{class:"index",style:L(t.notShowTagStyle(d))},_(d+1),5),n("div",{class:"tag",style:L(t.showTagStyle(d)),onClick:T=>t.onChangeActiveTitle(d,r.isSub)},[r.isSub?(c(),g("span",ce,_(d+1),1)):(c(),M(E,{key:0,show:"",active:t.activeSheetTitleRow==d+1},null,8,["active"]))],12,ue)]),(c(!0),g(I,null,$(r,T=>(c(),g("td",null,[n("span",he,_(T),1)]))),256))],2))),256))])],4)])]),_:1}))]),_:1})]),_:1},8,["onRegister","okButtonProps"])}const be=X(Y,[["render",pe],["__scopeId","data-v-2fe0de01"]]);export{be as default};
