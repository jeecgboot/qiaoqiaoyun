var g=(s,l,a)=>new Promise((d,n)=>{var i=e=>{try{t(a.next(e))}catch(u){n(u)}},o=e=>{try{t(a.throw(e))}catch(u){n(u)}},t=e=>e.done?d(e.value):Promise.resolve(e.value).then(i,o);t((a=a.apply(s,l)).next())});import{d as h,f as m,e as C,a5 as p,V as T,a6 as w,af as R,ai as B,ak as A,k as I}from"./vue-vendor-24c7dc61.js";import{B as b}from"./index-1c3affea.js";import{a7 as x,j as F,a as O,k as U,l as $}from"./index-831af9dd.js";import"./BasicModal-58413bab.js";import"./antd-vue-vendor-0d72f01e.js";import"./useWindowSizeFn-8f085f6f.js";import"./vxe-table-vendor-8813019a.js";const j={before:"/act/task/beforeAddSignTask",after:"/act/task/afterAddSignTask"},V=h({name:"TaskAddSignReasonModal",components:{BasicModal:b},props:{getContainer:{type:Function,default:null}},emits:["register","success"],setup(s,{emit:l}){const{createMessage:a}=O(),d=x(),n=m(""),i=m(""),o=m([]),t=m(""),[e]=F(r=>g(this,null,function*(){o.value=r.userList,n.value=r.taskId,t.value=r.addSignType}));function u(){return g(this,null,function*(){let r=i.value;if(!r){a.warning("请填写加签意见！");return}let k=d.getUserInfo.username,c=o.value.map(y=>y.username),f={currentTaskId:n.value,signUserIds:c,userCode:k,reason:r};const _=j[t.value],v=yield U.put({url:_,params:f},{isTransformResponse:!1});v.success?(a.success("操作成功"),l("success")):a.warning(v.message)})}const S=C(()=>t.value==="after"?"通过申请并加签":"加签"),M=C(()=>{let c=o.value.map(f=>f.realname).join(",");return t.value==="after"?c+" 将在你通过申请后进行加签":c+" 将在你审批前加签"});return{registerModal:e,taskComment:i,taskId:n,handleSubmit:u,modalTitle:M,okText:S}}}),E=p("div",{style:{color:"#757575"}}," 加签意见 ",-1),H={style:{"margin-top":"10px"}};function L(s,l,a,d,n,i){const o=T("a-textarea"),t=T("BasicModal");return w(),R(t,{onRegister:s.registerModal,getContainer:s.getContainer,okText:s.okText,canFullscreen:!1,minHeight:80,width:560,destroyOnClose:"",onOk:s.handleSubmit},{title:B(()=>[p("div",null,A(s.modalTitle),1)]),default:B(()=>[p("div",null,[E,p("div",H,[I(o,{value:s.taskComment,"onUpdate:value":l[0]||(l[0]=e=>s.taskComment=e),placeholder:"请填写加签意见","auto-size":{minRows:5,maxRows:10}},null,8,["value"])])])]),_:1},8,["onRegister","getContainer","okText","onOk"])}const Q=$(V,[["render",L]]);export{Q as default};
